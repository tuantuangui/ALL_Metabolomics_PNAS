<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 18 Figure 3 | ALL metabolism analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 18 Figure 3 | ALL metabolism analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 18 Figure 3 | ALL metabolism analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Tuantuan Gui" />


<meta name="date" content="2024-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="figure-2.html"/>
<link rel="next" href="figure-4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ALL Metabolimics PNAS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> the ALL metabolism analysis</a></li>
<li class="chapter" data-level="2" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html"><i class="fa fa-check"></i><b>2</b> serum: 2020 data preprocess</a>
<ul>
<li class="chapter" data-level="2.1" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html#positive"><i class="fa fa-check"></i><b>2.1</b> positive</a></li>
<li class="chapter" data-level="2.2" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html#negative"><i class="fa fa-check"></i><b>2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html"><i class="fa fa-check"></i><b>3</b> serum: 2021 data preprocess</a>
<ul>
<li class="chapter" data-level="3.1" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html#positive-1"><i class="fa fa-check"></i><b>3.1</b> positive</a></li>
<li class="chapter" data-level="3.2" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html#negative-1"><i class="fa fa-check"></i><b>3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html"><i class="fa fa-check"></i><b>4</b> serum: metID data anatation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html#serum-2020"><i class="fa fa-check"></i><b>4.1</b> serum 2020</a></li>
<li class="chapter" data-level="4.2" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html#serum-2021"><i class="fa fa-check"></i><b>4.2</b> serum 2021</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="serum-combine-data-from-ab-metid-and-metdna-of-serum-2020-and-serum-2021.html"><a href="serum-combine-data-from-ab-metid-and-metdna-of-serum-2020-and-serum-2021.html"><i class="fa fa-check"></i><b>5</b> serum: combine data from AB, metID and metDNA of serum 2020 and serum 2021</a></li>
<li class="chapter" data-level="6" data-path="serum-combine-data-from-positive-and-negative.html"><a href="serum-combine-data-from-positive-and-negative.html"><i class="fa fa-check"></i><b>6</b> serum: combine data from positive and negative</a></li>
<li class="chapter" data-level="7" data-path="serum-batch-effection-of-data-from-serum-2020-and-serum-2021-using-sva.html"><a href="serum-batch-effection-of-data-from-serum-2020-and-serum-2021-using-sva.html"><i class="fa fa-check"></i><b>7</b> serum: batch effection of data from serum 2020 and serum 2021 using sva</a></li>
<li class="chapter" data-level="8" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html"><i class="fa fa-check"></i><b>8</b> Cell: AB data process</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-the-metabolites-too-much-na-and-impute-the-na"><i class="fa fa-check"></i><b>8.1</b> filter the metabolites (too much NA) and impute the NA</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-2"><i class="fa fa-check"></i><b>8.1.1</b> positive</a></li>
<li class="chapter" data-level="8.1.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-2"><i class="fa fa-check"></i><b>8.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#transform-the-metabolite-name-to-refmet-name"><i class="fa fa-check"></i><b>8.2</b> transform the metabolite name to refmet name</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-3"><i class="fa fa-check"></i><b>8.2.1</b> positive</a></li>
<li class="chapter" data-level="8.2.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-3"><i class="fa fa-check"></i><b>8.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-the-metabolite-based-on-the-library-hit"><i class="fa fa-check"></i><b>8.3</b> filter the metabolite based on the library hit</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-4"><i class="fa fa-check"></i><b>8.3.1</b> positive</a></li>
<li class="chapter" data-level="8.3.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-4"><i class="fa fa-check"></i><b>8.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-metabolite-by-manual-check"><i class="fa fa-check"></i><b>8.4</b> filter metabolite by manual check</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cell-annotation.html"><a href="cell-annotation.html"><i class="fa fa-check"></i><b>9</b> Cell: annotation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cell-annotation.html"><a href="cell-annotation.html#metid"><i class="fa fa-check"></i><b>9.1</b> metID</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-5"><i class="fa fa-check"></i><b>9.1.1</b> positive</a></li>
<li class="chapter" data-level="9.1.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-5"><i class="fa fa-check"></i><b>9.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cell-annotation.html"><a href="cell-annotation.html#metdna"><i class="fa fa-check"></i><b>9.2</b> metDNA</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-6"><i class="fa fa-check"></i><b>9.2.1</b> positive</a></li>
<li class="chapter" data-level="9.2.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-6"><i class="fa fa-check"></i><b>9.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cell-annotation.html"><a href="cell-annotation.html#combine-the-data-from-metid-and-metdna"><i class="fa fa-check"></i><b>9.3</b> combine the data from metID and metDNA</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-7"><i class="fa fa-check"></i><b>9.3.1</b> positive</a></li>
<li class="chapter" data-level="9.3.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-7"><i class="fa fa-check"></i><b>9.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="cell-annotation.html"><a href="cell-annotation.html#transform-metabolite-name-to-refmet-name"><i class="fa fa-check"></i><b>9.4</b> transform metabolite name to refmet name</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-8"><i class="fa fa-check"></i><b>9.4.1</b> positive</a></li>
<li class="chapter" data-level="9.4.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-8"><i class="fa fa-check"></i><b>9.4.2</b> negative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html"><i class="fa fa-check"></i><b>10</b> Cell: combine the data from AB and xcms</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#combine-the-data-from-ab-and-xcms"><i class="fa fa-check"></i><b>10.1</b> combine the data from AB and xcms</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#positive-9"><i class="fa fa-check"></i><b>10.1.1</b> positive</a></li>
<li class="chapter" data-level="10.1.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#negative-9"><i class="fa fa-check"></i><b>10.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#transform-the-format-to-serrf"><i class="fa fa-check"></i><b>10.2</b> transform the format to serrf</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#positive-10"><i class="fa fa-check"></i><b>10.2.1</b> positive</a></li>
<li class="chapter" data-level="10.2.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#negative-10"><i class="fa fa-check"></i><b>10.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#rsd"><i class="fa fa-check"></i><b>10.3</b> RSD</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cell-combine-positive.html"><a href="cell-combine-positive.html"><i class="fa fa-check"></i><b>11</b> Cell: combine positive</a></li>
<li class="chapter" data-level="12" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html"><i class="fa fa-check"></i><b>12</b> Cell: metabolite info</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#ab"><i class="fa fa-check"></i><b>12.1</b> AB</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-11"><i class="fa fa-check"></i><b>12.1.1</b> positive</a></li>
<li class="chapter" data-level="12.1.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-11"><i class="fa fa-check"></i><b>12.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#metid-1"><i class="fa fa-check"></i><b>12.2</b> metID</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-12"><i class="fa fa-check"></i><b>12.2.1</b> positive</a></li>
<li class="chapter" data-level="12.2.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-12"><i class="fa fa-check"></i><b>12.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#metdna-1"><i class="fa fa-check"></i><b>12.3</b> metDNA</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-13"><i class="fa fa-check"></i><b>12.3.1</b> positive</a></li>
<li class="chapter" data-level="12.3.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-13"><i class="fa fa-check"></i><b>12.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#combine-the-data-from-abmetid-and-metdna"><i class="fa fa-check"></i><b>12.4</b> combine the data from AB,metID and metDNA</a></li>
<li class="chapter" data-level="12.5" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#compare-with-the-local-cas-id"><i class="fa fa-check"></i><b>12.5</b> compare with the local CAS ID</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cell-qc.html"><a href="cell-qc.html"><i class="fa fa-check"></i><b>13</b> Cell: QC</a>
<ul>
<li class="chapter" data-level="13.1" data-path="cell-qc.html"><a href="cell-qc.html#pca"><i class="fa fa-check"></i><b>13.1</b> PCA</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="cell-qc.html"><a href="cell-qc.html#positive-14"><i class="fa fa-check"></i><b>13.1.1</b> positive</a></li>
<li class="chapter" data-level="13.1.2" data-path="cell-qc.html"><a href="cell-qc.html#negative-14"><i class="fa fa-check"></i><b>13.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="cell-qc.html"><a href="cell-qc.html#the-distribution-of-every-metabolite"><i class="fa fa-check"></i><b>13.2</b> the distribution of every metabolite</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="cell-qc.html"><a href="cell-qc.html#positive-15"><i class="fa fa-check"></i><b>13.2.1</b> positive</a></li>
<li class="chapter" data-level="13.2.2" data-path="cell-qc.html"><a href="cell-qc.html#negative-15"><i class="fa fa-check"></i><b>13.2.2</b> negative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html"><i class="fa fa-check"></i><b>14</b> Cell: filter metabolites and samples</a>
<ul>
<li class="chapter" data-level="14.1" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-out-c053"><i class="fa fa-check"></i><b>14.1</b> filter out C053</a></li>
<li class="chapter" data-level="14.2" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-compound"><i class="fa fa-check"></i><b>14.2</b> filter compound</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-compound-in-2023.11.08"><i class="fa fa-check"></i><b>14.2.1</b> filter compound in 2023.11.08</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="cell-rsd.html"><a href="cell-rsd.html"><i class="fa fa-check"></i><b>15</b> Cell: RSD</a>
<ul>
<li class="chapter" data-level="15.1" data-path="cell-rsd.html"><a href="cell-rsd.html#after"><i class="fa fa-check"></i><b>15.1</b> after</a></li>
<li class="chapter" data-level="15.2" data-path="cell-rsd.html"><a href="cell-rsd.html#rsd-1"><i class="fa fa-check"></i><b>15.2</b> RSD</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="figure-1.html"><a href="figure-1.html"><i class="fa fa-check"></i><b>16</b> Figure 1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="figure-1.html"><a href="figure-1.html#b-annotated-metabolites"><i class="fa fa-check"></i><b>16.1</b> (B) Annotated metabolites</a></li>
<li class="chapter" data-level="16.2" data-path="figure-1.html"><a href="figure-1.html#c-comprehensive-metabolome-overview"><i class="fa fa-check"></i><b>16.2</b> (C) Comprehensive metabolome overview</a></li>
<li class="chapter" data-level="16.3" data-path="figure-1.html"><a href="figure-1.html#s1-a-clinical-characteristics"><i class="fa fa-check"></i><b>16.3</b> (S1 A) Clinical characteristics</a></li>
<li class="chapter" data-level="16.4" data-path="figure-1.html"><a href="figure-1.html#s1-b-venn-plot"><i class="fa fa-check"></i><b>16.4</b> (S1 B) Venn plot</a></li>
<li class="chapter" data-level="16.5" data-path="figure-1.html"><a href="figure-1.html#s1-c-waterfall-plot"><i class="fa fa-check"></i><b>16.5</b> (S1 C) Waterfall plot</a></li>
<li class="chapter" data-level="16.6" data-path="figure-1.html"><a href="figure-1.html#s1-d-scatter-plot"><i class="fa fa-check"></i><b>16.6</b> (S1 D) Scatter plot</a></li>
<li class="chapter" data-level="16.7" data-path="figure-1.html"><a href="figure-1.html#s2-a-pca"><i class="fa fa-check"></i><b>16.7</b> (S2 A) PCA</a></li>
<li class="chapter" data-level="16.8" data-path="figure-1.html"><a href="figure-1.html#s2-b-volcano-plot"><i class="fa fa-check"></i><b>16.8</b> (S2 B) Volcano Plot</a></li>
<li class="chapter" data-level="16.9" data-path="figure-1.html"><a href="figure-1.html#s2-c-msea"><i class="fa fa-check"></i><b>16.9</b> (S2 C) MSEA</a></li>
<li class="chapter" data-level="16.10" data-path="figure-1.html"><a href="figure-1.html#s2-d-ageing-related-metabolites"><i class="fa fa-check"></i><b>16.10</b> (S2 D) Ageing-related metabolites</a></li>
<li class="chapter" data-level="16.11" data-path="figure-1.html"><a href="figure-1.html#s2-e-box-plot"><i class="fa fa-check"></i><b>16.11</b> (S2 E) Box plot</a></li>
<li class="chapter" data-level="16.12" data-path="figure-1.html"><a href="figure-1.html#s2-f-overall-survival-analysis"><i class="fa fa-check"></i><b>16.12</b> (S2 F) Overall Survival analysis</a></li>
<li class="chapter" data-level="16.13" data-path="figure-1.html"><a href="figure-1.html#s2-g-box-plot"><i class="fa fa-check"></i><b>16.13</b> (S2 G) Box plot</a></li>
<li class="chapter" data-level="16.14" data-path="figure-1.html"><a href="figure-1.html#s2-h-metabolism-set-enrichment-analysis"><i class="fa fa-check"></i><b>16.14</b> (S2 H) Metabolism Set Enrichment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="figure-2.html"><a href="figure-2.html"><i class="fa fa-check"></i><b>17</b> Figure 2</a>
<ul>
<li class="chapter" data-level="17.1" data-path="figure-2.html"><a href="figure-2.html#a-3d-pca"><i class="fa fa-check"></i><b>17.1</b> (A) 3D PCA</a></li>
<li class="chapter" data-level="17.2" data-path="figure-2.html"><a href="figure-2.html#b-all-vs-hc"><i class="fa fa-check"></i><b>17.2</b> (B) ALL vs HC</a></li>
<li class="chapter" data-level="17.3" data-path="figure-2.html"><a href="figure-2.html#c-intracellular-metabolome-landscape"><i class="fa fa-check"></i><b>17.3</b> (C) Intracellular Metabolome Landscape</a></li>
<li class="chapter" data-level="17.4" data-path="figure-2.html"><a href="figure-2.html#e-bcp-all-vs-t-all"><i class="fa fa-check"></i><b>17.4</b> (E) BCP-ALL vs T-ALL</a></li>
<li class="chapter" data-level="17.5" data-path="figure-2.html"><a href="figure-2.html#s3-a-correlation-within-bmmc-samples"><i class="fa fa-check"></i><b>17.5</b> (S3 A) Correlation Within BMMC Samples</a></li>
<li class="chapter" data-level="17.6" data-path="figure-2.html"><a href="figure-2.html#s3-b-correlation-between-hc-pmmc-and-all-bmmc-mrd-"><i class="fa fa-check"></i><b>17.6</b> (S3 B) Correlation Between HC PMMC And ALL BMMC MRD-</a></li>
<li class="chapter" data-level="17.7" data-path="figure-2.html"><a href="figure-2.html#s3-c-correlation-between-bmmc-and-pbmc"><i class="fa fa-check"></i><b>17.7</b> (S3 C) Correlation Between BMMC And PBMC</a></li>
<li class="chapter" data-level="17.8" data-path="figure-2.html"><a href="figure-2.html#s3-d-differential-analyses"><i class="fa fa-check"></i><b>17.8</b> (S3 D) Differential Analyses</a></li>
<li class="chapter" data-level="17.9" data-path="figure-2.html"><a href="figure-2.html#s3-e-volcano-plot-of-bmmc-d0-vs.-mrd-"><i class="fa fa-check"></i><b>17.9</b> (S3 E) Volcano Plot of BMMC-D0 vs. MRD-</a></li>
<li class="chapter" data-level="17.10" data-path="figure-2.html"><a href="figure-2.html#s3-f-abundance-boxplot"><i class="fa fa-check"></i><b>17.10</b> (S3 F) Abundance Boxplot</a></li>
<li class="chapter" data-level="17.11" data-path="figure-2.html"><a href="figure-2.html#s3-g-wgcna"><i class="fa fa-check"></i><b>17.11</b> (S3 G) WGCNA</a></li>
<li class="chapter" data-level="17.12" data-path="figure-2.html"><a href="figure-2.html#s3-h-bar-plot"><i class="fa fa-check"></i><b>17.12</b> (S3 H) bar plot</a></li>
<li class="chapter" data-level="17.13" data-path="figure-2.html"><a href="figure-2.html#s3-i-venn-diagram"><i class="fa fa-check"></i><b>17.13</b> (S3 I) Venn Diagram</a></li>
<li class="chapter" data-level="17.14" data-path="figure-2.html"><a href="figure-2.html#s3-j-boxplot"><i class="fa fa-check"></i><b>17.14</b> (S3 J) Boxplot</a></li>
<li class="chapter" data-level="17.15" data-path="figure-2.html"><a href="figure-2.html#s3-k-pathway-based-analysis"><i class="fa fa-check"></i><b>17.15</b> (S3 K) Pathway-based Analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="figure-3.html"><a href="figure-3.html"><i class="fa fa-check"></i><b>18</b> Figure 3</a>
<ul>
<li class="chapter" data-level="18.1" data-path="figure-3.html"><a href="figure-3.html#a-gsva-scores-for-metabolic-pathways"><i class="fa fa-check"></i><b>18.1</b> (A) GSVA Scores for Metabolic Pathways</a></li>
<li class="chapter" data-level="18.2" data-path="figure-3.html"><a href="figure-3.html#b-mutations-and-metabolites"><i class="fa fa-check"></i><b>18.2</b> (B) Mutations and Metabolites</a></li>
<li class="chapter" data-level="18.3" data-path="figure-3.html"><a href="figure-3.html#c-idh12-and-etv6-mutations"><i class="fa fa-check"></i><b>18.3</b> (C) IDH1/2 and ETV6 Mutations</a></li>
<li class="chapter" data-level="18.4" data-path="figure-3.html"><a href="figure-3.html#d-fusions-and-metabolites"><i class="fa fa-check"></i><b>18.4</b> (D) Fusions and Metabolites</a></li>
<li class="chapter" data-level="18.5" data-path="figure-3.html"><a href="figure-3.html#e-bcr-abl1-fusion"><i class="fa fa-check"></i><b>18.5</b> (E) BCR-ABL1 Fusion</a></li>
<li class="chapter" data-level="18.6" data-path="figure-3.html"><a href="figure-3.html#s4-a-metabolic-gene-heatmap"><i class="fa fa-check"></i><b>18.6</b> (S4 A) Metabolic Gene Heatmap</a></li>
<li class="chapter" data-level="18.7" data-path="figure-3.html"><a href="figure-3.html#s4-b-correlation-within-bmmc-samples"><i class="fa fa-check"></i><b>18.7</b> (S4 B) Correlation Within BMMC Samples</a></li>
<li class="chapter" data-level="18.8" data-path="figure-3.html"><a href="figure-3.html#s4-c-correlation-of-mrna-expression-of-metabolic-genes"><i class="fa fa-check"></i><b>18.8</b> (S4 C) Correlation of mRNA Expression of Metabolic Genes</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="figure-4.html"><a href="figure-4.html"><i class="fa fa-check"></i><b>19</b> Figure 4</a>
<ul>
<li class="chapter" data-level="19.1" data-path="figure-4.html"><a href="figure-4.html#a-schematic-workflow"><i class="fa fa-check"></i><b>19.1</b> (A) Schematic Workflow</a></li>
<li class="chapter" data-level="19.2" data-path="figure-4.html"><a href="figure-4.html#b-discrimination-of-bcp-all-clusters"><i class="fa fa-check"></i><b>19.2</b> (B) Discrimination of BCP-ALL Clusters</a></li>
<li class="chapter" data-level="19.3" data-path="figure-4.html"><a href="figure-4.html#c-os-in-75-bcp-all-patients"><i class="fa fa-check"></i><b>19.3</b> (C) OS in 75 BCP-ALL patients</a></li>
<li class="chapter" data-level="19.4" data-path="figure-4.html"><a href="figure-4.html#d-multivariate-cox-analysis"><i class="fa fa-check"></i><b>19.4</b> (D) Multivariate Cox Analysis</a></li>
<li class="chapter" data-level="19.5" data-path="figure-4.html"><a href="figure-4.html#e-subnetwork-between-bc3-and-bc12"><i class="fa fa-check"></i><b>19.5</b> (E) Subnetwork between BC3 and BC1/2</a></li>
<li class="chapter" data-level="19.6" data-path="figure-4.html"><a href="figure-4.html#f-discrimination-of-t-all-clusters"><i class="fa fa-check"></i><b>19.6</b> (F) Discrimination of T-ALL Clusters</a></li>
<li class="chapter" data-level="19.7" data-path="figure-4.html"><a href="figure-4.html#g-os-of-tc12"><i class="fa fa-check"></i><b>19.7</b> (G) OS of TC1/2</a></li>
<li class="chapter" data-level="19.8" data-path="figure-4.html"><a href="figure-4.html#h-subnetwork-between-tc2-and-tc1"><i class="fa fa-check"></i><b>19.8</b> (H) Subnetwork between TC2 and TC1</a></li>
<li class="chapter" data-level="19.9" data-path="figure-4.html"><a href="figure-4.html#s5-a-clusters-of-bcp-all"><i class="fa fa-check"></i><b>19.9</b> (S5 A) Clusters of BCP-ALL</a></li>
<li class="chapter" data-level="19.10" data-path="figure-4.html"><a href="figure-4.html#s5-e-waterfall-plot-of-bc123"><i class="fa fa-check"></i><b>19.10</b> (S5 E) Waterfall plot of BC1/2/3</a></li>
<li class="chapter" data-level="19.11" data-path="figure-4.html"><a href="figure-4.html#s5-h-da-score-of-bc3-cluster"><i class="fa fa-check"></i><b>19.11</b> (S5 H) DA-score of BC3 cluster</a></li>
<li class="chapter" data-level="19.12" data-path="figure-4.html"><a href="figure-4.html#s5-i-j-msea-of-bc123"><i class="fa fa-check"></i><b>19.12</b> (S5 I-J) MSEA of BC1/2/3</a></li>
<li class="chapter" data-level="19.13" data-path="figure-4.html"><a href="figure-4.html#s6-a-clusters-of-t-all"><i class="fa fa-check"></i><b>19.13</b> (S6 A) Clusters of T-ALL</a></li>
<li class="chapter" data-level="19.14" data-path="figure-4.html"><a href="figure-4.html#s6-e-f-rfs-and-efs-of-tc12"><i class="fa fa-check"></i><b>19.14</b> (S6 E-F) RFS and EFS of TC1/2</a></li>
<li class="chapter" data-level="19.15" data-path="figure-4.html"><a href="figure-4.html#s6-h-multivariate-cox-analysis-of-tc12"><i class="fa fa-check"></i><b>19.15</b> (S6 H) Multivariate Cox Analysis of TC1/2</a></li>
<li class="chapter" data-level="19.16" data-path="figure-4.html"><a href="figure-4.html#s6-i-heatmap-of-tc12"><i class="fa fa-check"></i><b>19.16</b> (S6 I) Heatmap of TC1/2</a></li>
<li class="chapter" data-level="19.17" data-path="figure-4.html"><a href="figure-4.html#s6-j-da-score-of-tc12"><i class="fa fa-check"></i><b>19.17</b> (S6 J) DA score of TC1/2</a></li>
<li class="chapter" data-level="19.18" data-path="figure-4.html"><a href="figure-4.html#s6-k-l-msea-of-tc12"><i class="fa fa-check"></i><b>19.18</b> (S6 K-L) MSEA of TC1/2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ALL metabolism analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-3" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">Chapter 18</span> Figure 3<a href="figure-3.html#figure-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="Figure-1025/3_Figure3.png" width="1783" style="display: block; margin: auto;" /></p>
<p><strong>Figure 3: Relationship between intracellular metabolome, transcriptome and genomic features in BCP-ALL and T-ALL.</strong></p>
<p>A. Gene set variation analysis (GSVA) of enrichment scores for metabolic pathways in BCP-ALL and T-ALL samples at the RNA-seq level. Each subtype exhibits both individuality and potential commonality.</p>
<p>B. The heatmap illustrates the associations between the metabolites abundance (column) of ALL BMMC and the presence of mutations within the indicated genes (row). The mutations include high frequency somatic mutations within reported ALL-related genes. T statistics are calculated by a linear regression model to represent the correlation level.</p>
<p>C. Correlations between IDH1/2 mutations and 2-HG (left panel), and ETV6 mutations and glutamine (right panel). All samples were ordered based on the abundance (y-axis) of indicated metabolites, and the ones with corresponding mutations were highlighted in red and indicated by the corresponding lines displayed in x-axis.</p>
<p>D. The heatmap illustrates the associations between the abundance of metabolites and the presence of indicated well-known gene fusions. T statistics were calculated by a linear regression model.</p>
<p>E. Correlations between the BCR-ABL1 fusion and the abundance of adenosine (left panel), as well as 2’,3’-cyclic AMP (right panel). Fusion genes were shown as lines and samples were ordered based on the abundance (y-axis) of indicated metabolites.</p>
<div id="a-gsva-scores-for-metabolic-pathways" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> (A) GSVA Scores for Metabolic Pathways<a href="figure-3.html#a-gsva-scores-for-metabolic-pathways" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Gene set variation analysis (GSVA)</strong> scores for metabolic pathways in BCP-ALL and T-ALL samples at the RNA-seq level. Each subgroup exhibits both individuality and potential commonality.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="figure-3.html#cb78-1" tabindex="-1"></a><span class="fu">library</span>(GSVA) </span>
<span id="cb78-2"><a href="figure-3.html#cb78-2" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb78-3"><a href="figure-3.html#cb78-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb78-4"><a href="figure-3.html#cb78-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb78-5"><a href="figure-3.html#cb78-5" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb78-6"><a href="figure-3.html#cb78-6" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb78-7"><a href="figure-3.html#cb78-7" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb78-8"><a href="figure-3.html#cb78-8" tabindex="-1"></a></span>
<span id="cb78-9"><a href="figure-3.html#cb78-9" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb78-10"><a href="figure-3.html#cb78-10" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb78-11"><a href="figure-3.html#cb78-11" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb78-12"><a href="figure-3.html#cb78-12" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Sample_RNA_190_fusion_mutation_v1130.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-13"><a href="figure-3.html#cb78-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb78-14"><a href="figure-3.html#cb78-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bianhao,RNA_id,Prediction_Check,Subtype) <span class="sc">%&gt;%</span></span>
<span id="cb78-15"><a href="figure-3.html#cb78-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Subtype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>,<span class="st">&quot;non_Ph&quot;</span>,<span class="st">&quot;Ph&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb78-16"><a href="figure-3.html#cb78-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Subtype=</span><span class="fu">ifelse</span>(Subtype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>),Subtype,Prediction_Check)) <span class="sc">%&gt;%</span></span>
<span id="cb78-17"><a href="figure-3.html#cb78-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Subtype=</span><span class="fu">factor</span>(Subtype,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;BCL2/MYC&quot;</span>,<span class="st">&quot;Low hypodiploid&quot;</span>,<span class="st">&quot;ETV6-RUNX1 Group&quot;</span>,<span class="st">&quot;High hyperdoploid&quot;</span>,<span class="st">&quot;PAX5alt&quot;</span>,<span class="st">&quot;PAX5 P80R&quot;</span>,<span class="st">&quot;Ph-like&quot;</span>,<span class="st">&quot;DUX4&quot;</span>,<span class="st">&quot;ZNF384 Group&quot;</span>,<span class="st">&quot;TCF3-PBX1&quot;</span>,<span class="st">&quot;BCR-ABL1&quot;</span>,<span class="st">&quot;TWIST2-high&quot;</span>,<span class="st">&quot;IDH&quot;</span>,<span class="st">&quot;ZEB2&quot;</span>,<span class="st">&quot;MEF2D Group&quot;</span>,<span class="st">&quot;KMT2A Group&quot;</span>,<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>)))</span>
<span id="cb78-18"><a href="figure-3.html#cb78-18" tabindex="-1"></a></span>
<span id="cb78-19"><a href="figure-3.html#cb78-19" tabindex="-1"></a>sel_gmt<span class="ot">=</span>GSEABase<span class="sc">::</span><span class="fu">getGmt</span>(<span class="st">&quot;raw_data/KEGG_metabo_genes.gmt&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb78-20"><a href="figure-3.html#cb78-20" tabindex="-1"></a><span class="fu">head</span>(sel_gmt)</span>
<span id="cb78-21"><a href="figure-3.html#cb78-21" tabindex="-1"></a>sets<span class="ot">=</span><span class="fu">as.list</span>(sel_gmt)</span>
<span id="cb78-22"><a href="figure-3.html#cb78-22" tabindex="-1"></a></span>
<span id="cb78-23"><a href="figure-3.html#cb78-23" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;raw_data/20231113_RNA_ALL_VST_coding.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-24"><a href="figure-3.html#cb78-24" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb78-25"><a href="figure-3.html#cb78-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_info<span class="sc">$</span>RNA_id)</span>
<span id="cb78-26"><a href="figure-3.html#cb78-26" tabindex="-1"></a></span>
<span id="cb78-27"><a href="figure-3.html#cb78-27" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb78-28"><a href="figure-3.html#cb78-28" tabindex="-1"></a><span class="co">#  Step 2: Gene set variation analysis (GSVA)</span></span>
<span id="cb78-29"><a href="figure-3.html#cb78-29" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb78-30"><a href="figure-3.html#cb78-30" tabindex="-1"></a>exprMatrix<span class="ot">=</span>dat</span>
<span id="cb78-31"><a href="figure-3.html#cb78-31" tabindex="-1"></a><span class="fu">dim</span>(exprMatrix)</span>
<span id="cb78-32"><a href="figure-3.html#cb78-32" tabindex="-1"></a>gsva_matrix<span class="ot">&lt;-</span> <span class="fu">gsva</span>(<span class="fu">as.matrix</span>(exprMatrix), sel_gmt,<span class="at">method=</span><span class="st">&#39;ssgsea&#39;</span>,<span class="at">kcdf=</span><span class="st">&#39;Gaussian&#39;</span>)</span>
<span id="cb78-33"><a href="figure-3.html#cb78-33" tabindex="-1"></a></span>
<span id="cb78-34"><a href="figure-3.html#cb78-34" tabindex="-1"></a><span class="fu">write.table</span>(gsva_matrix,<span class="st">&quot;result/Figure3/3A_gsva.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb78-35"><a href="figure-3.html#cb78-35" tabindex="-1"></a></span>
<span id="cb78-36"><a href="figure-3.html#cb78-36" tabindex="-1"></a>gsva_matrix1<span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">scale</span>(<span class="fu">t</span>(gsva_matrix)))</span>
<span id="cb78-37"><a href="figure-3.html#cb78-37" tabindex="-1"></a><span class="fu">write.table</span>(gsva_matrix1,<span class="st">&quot;result/Figure3/3A_gsva_norm.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb78-38"><a href="figure-3.html#cb78-38" tabindex="-1"></a></span>
<span id="cb78-39"><a href="figure-3.html#cb78-39" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">&quot;Paired&quot;</span>)</span>
<span id="cb78-40"><a href="figure-3.html#cb78-40" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#FB8072&quot;</span>,<span class="st">&quot;#8DD3C7&quot;</span>, <span class="st">&quot;#BEBADA&quot;</span>,<span class="st">&quot;#FDB462&quot;</span>,<span class="st">&quot;#CCEBC5&quot;</span>, <span class="st">&quot;#FFED6F&quot;</span>)</span>
<span id="cb78-41"><a href="figure-3.html#cb78-41" tabindex="-1"></a>q12 <span class="ot">&lt;-</span> <span class="fu">c</span>(q1,q2)</span>
<span id="cb78-42"><a href="figure-3.html#cb78-42" tabindex="-1"></a><span class="fu">names</span>(q12) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sample_info<span class="sc">$</span>Subtype)</span>
<span id="cb78-43"><a href="figure-3.html#cb78-43" tabindex="-1"></a></span>
<span id="cb78-44"><a href="figure-3.html#cb78-44" tabindex="-1"></a>left_ann <span class="ot">&lt;-</span> PathwayExtendData[,<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">%&gt;%</span></span>
<span id="cb78-45"><a href="figure-3.html#cb78-45" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb78-46"><a href="figure-3.html#cb78-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(kegg_pathwayname,<span class="fu">rownames</span>(gsva_matrix)))</span>
<span id="cb78-47"><a href="figure-3.html#cb78-47" tabindex="-1"></a></span>
<span id="cb78-48"><a href="figure-3.html#cb78-48" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">kegg_pathwayname=</span><span class="fu">rownames</span>(gsva_matrix)) <span class="sc">%&gt;%</span></span>
<span id="cb78-49"><a href="figure-3.html#cb78-49" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(left_ann,<span class="at">by=</span><span class="st">&quot;kegg_pathwayname&quot;</span>)</span>
<span id="cb78-50"><a href="figure-3.html#cb78-50" tabindex="-1"></a></span>
<span id="cb78-51"><a href="figure-3.html#cb78-51" tabindex="-1"></a>right_col <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">name =</span> <span class="st">&quot;Set3&quot;</span>)</span>
<span id="cb78-52"><a href="figure-3.html#cb78-52" tabindex="-1"></a><span class="fu">names</span>(right_col) <span class="ot">&lt;-</span> <span class="fu">unique</span>(a<span class="sc">$</span>kegg_category)</span>
<span id="cb78-53"><a href="figure-3.html#cb78-53" tabindex="-1"></a></span>
<span id="cb78-54"><a href="figure-3.html#cb78-54" tabindex="-1"></a>right_annotation<span class="ot">=</span><span class="fu">rowAnnotation</span>(</span>
<span id="cb78-55"><a href="figure-3.html#cb78-55" tabindex="-1"></a>  <span class="at">Subtype=</span>a<span class="sc">$</span>kegg_category,<span class="at">col=</span><span class="fu">list</span>(<span class="at">Subtype=</span>right_col),</span>
<span id="cb78-56"><a href="figure-3.html#cb78-56" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T,T),<span class="at">border =</span> <span class="fu">c</span>(T,T) ,</span>
<span id="cb78-57"><a href="figure-3.html#cb78-57" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>))</span>
<span id="cb78-58"><a href="figure-3.html#cb78-58" tabindex="-1"></a></span>
<span id="cb78-59"><a href="figure-3.html#cb78-59" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb78-60"><a href="figure-3.html#cb78-60" tabindex="-1"></a>  <span class="at">Subtype=</span>sample_info<span class="sc">$</span>Subtype,<span class="at">col=</span><span class="fu">list</span>(<span class="at">Subtype=</span>q12),</span>
<span id="cb78-61"><a href="figure-3.html#cb78-61" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T,T), <span class="at">border =</span> <span class="fu">c</span>(T,T) ,</span>
<span id="cb78-62"><a href="figure-3.html#cb78-62" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>))</span>
<span id="cb78-63"><a href="figure-3.html#cb78-63" tabindex="-1"></a></span>
<span id="cb78-64"><a href="figure-3.html#cb78-64" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb78-65"><a href="figure-3.html#cb78-65" tabindex="-1"></a></span>
<span id="cb78-66"><a href="figure-3.html#cb78-66" tabindex="-1"></a>p_cell <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(gsva_matrix1,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">18</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">name=</span><span class="st">&quot;Our RNA-seq Data&quot;</span>,</span>
<span id="cb78-67"><a href="figure-3.html#cb78-67" tabindex="-1"></a>                  <span class="at">cluster_row_slices =</span> F,<span class="at">clustering_method_rows =</span> <span class="st">&quot;ward.D&quot;</span>,</span>
<span id="cb78-68"><a href="figure-3.html#cb78-68" tabindex="-1"></a>                  <span class="at">cluster_column_slices =</span> F,</span>
<span id="cb78-69"><a href="figure-3.html#cb78-69" tabindex="-1"></a>                  <span class="at">clustering_method_columns =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb78-70"><a href="figure-3.html#cb78-70" tabindex="-1"></a>                  <span class="at">column_split =</span> sample_info<span class="sc">$</span>Subtype,</span>
<span id="cb78-71"><a href="figure-3.html#cb78-71" tabindex="-1"></a>                  <span class="at">top_annotation =</span>top_annotation,</span>
<span id="cb78-72"><a href="figure-3.html#cb78-72" tabindex="-1"></a>                  <span class="at">right_annotation =</span> right_annotation,</span>
<span id="cb78-73"><a href="figure-3.html#cb78-73" tabindex="-1"></a>                  <span class="at">row_split =</span> a<span class="sc">$</span>kegg_category,</span>
<span id="cb78-74"><a href="figure-3.html#cb78-74" tabindex="-1"></a>                  <span class="at">col =</span> col_fun,</span>
<span id="cb78-75"><a href="figure-3.html#cb78-75" tabindex="-1"></a>                  <span class="at">show_column_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb78-76"><a href="figure-3.html#cb78-76" tabindex="-1"></a>                  <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),</span>
<span id="cb78-77"><a href="figure-3.html#cb78-77" tabindex="-1"></a>                  <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">5</span>))</span>
<span id="cb78-78"><a href="figure-3.html#cb78-78" tabindex="-1"></a></span>
<span id="cb78-79"><a href="figure-3.html#cb78-79" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure3/3A_GSVAheatmap.pdf&quot;</span>,<span class="at">width =</span> <span class="dv">20</span>,<span class="at">height =</span> <span class="dv">15</span>)</span>
<span id="cb78-80"><a href="figure-3.html#cb78-80" tabindex="-1"></a>p_cell</span>
<span id="cb78-81"><a href="figure-3.html#cb78-81" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure3/3A.png" width="782" style="display: block; margin: auto;" /></p>
</div>
<div id="b-mutations-and-metabolites" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> (B) Mutations and Metabolites<a href="figure-3.html#b-mutations-and-metabolites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The heatmap illustrates the associations between the <strong>metabolites abundances</strong> (column) of ALL BMMC and the presence of <strong>mutations within the indicated genes</strong> (row). The mutations include high frequency somatic mutations within reported ALL-related genes. T statistics are calculated by a linear regression model to represent the correlation level.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="figure-3.html#cb79-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-2"><a href="figure-3.html#cb79-2" tabindex="-1"></a></span>
<span id="cb79-3"><a href="figure-3.html#cb79-3" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb79-4"><a href="figure-3.html#cb79-4" tabindex="-1"></a><span class="co">#  Step 1: Load mutation data</span></span>
<span id="cb79-5"><a href="figure-3.html#cb79-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb79-6"><a href="figure-3.html#cb79-6" tabindex="-1"></a>NOTCH1 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_NOTCH1.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-7"><a href="figure-3.html#cb79-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-8"><a href="figure-3.html#cb79-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;NOTCH1&quot;</span>)</span>
<span id="cb79-9"><a href="figure-3.html#cb79-9" tabindex="-1"></a></span>
<span id="cb79-10"><a href="figure-3.html#cb79-10" tabindex="-1"></a>RUNX1 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_RUNX1.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-11"><a href="figure-3.html#cb79-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-12"><a href="figure-3.html#cb79-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;RUNX1&quot;</span>)</span>
<span id="cb79-13"><a href="figure-3.html#cb79-13" tabindex="-1"></a></span>
<span id="cb79-14"><a href="figure-3.html#cb79-14" tabindex="-1"></a>PHF6 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_PHF6.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-15"><a href="figure-3.html#cb79-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-16"><a href="figure-3.html#cb79-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;PHF6&quot;</span>)</span>
<span id="cb79-17"><a href="figure-3.html#cb79-17" tabindex="-1"></a></span>
<span id="cb79-18"><a href="figure-3.html#cb79-18" tabindex="-1"></a>NRAS <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_NRAS.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-19"><a href="figure-3.html#cb79-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-20"><a href="figure-3.html#cb79-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;NRAS&quot;</span>)</span>
<span id="cb79-21"><a href="figure-3.html#cb79-21" tabindex="-1"></a></span>
<span id="cb79-22"><a href="figure-3.html#cb79-22" tabindex="-1"></a>ETV6 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_ETV6.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-23"><a href="figure-3.html#cb79-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-24"><a href="figure-3.html#cb79-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;ETV6&quot;</span>)</span>
<span id="cb79-25"><a href="figure-3.html#cb79-25" tabindex="-1"></a></span>
<span id="cb79-26"><a href="figure-3.html#cb79-26" tabindex="-1"></a>DNMT3A <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_DNMT3A.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-27"><a href="figure-3.html#cb79-27" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-28"><a href="figure-3.html#cb79-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;DNMT3A&quot;</span>)</span>
<span id="cb79-29"><a href="figure-3.html#cb79-29" tabindex="-1"></a></span>
<span id="cb79-30"><a href="figure-3.html#cb79-30" tabindex="-1"></a>PAX5 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_PAX5.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-31"><a href="figure-3.html#cb79-31" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-32"><a href="figure-3.html#cb79-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;PAX5&quot;</span>)</span>
<span id="cb79-33"><a href="figure-3.html#cb79-33" tabindex="-1"></a></span>
<span id="cb79-34"><a href="figure-3.html#cb79-34" tabindex="-1"></a>TP53 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_TP53.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-35"><a href="figure-3.html#cb79-35" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-36"><a href="figure-3.html#cb79-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;TP53&quot;</span>)</span>
<span id="cb79-37"><a href="figure-3.html#cb79-37" tabindex="-1"></a></span>
<span id="cb79-38"><a href="figure-3.html#cb79-38" tabindex="-1"></a>IDH <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_IDH.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-39"><a href="figure-3.html#cb79-39" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-40"><a href="figure-3.html#cb79-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;IDH&quot;</span>)</span>
<span id="cb79-41"><a href="figure-3.html#cb79-41" tabindex="-1"></a></span>
<span id="cb79-42"><a href="figure-3.html#cb79-42" tabindex="-1"></a>SETD1B <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_SETD1B.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-43"><a href="figure-3.html#cb79-43" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-44"><a href="figure-3.html#cb79-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;SETD1B&quot;</span>)</span>
<span id="cb79-45"><a href="figure-3.html#cb79-45" tabindex="-1"></a></span>
<span id="cb79-46"><a href="figure-3.html#cb79-46" tabindex="-1"></a>NCOR2 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_NCOR2.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-47"><a href="figure-3.html#cb79-47" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-48"><a href="figure-3.html#cb79-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;NCOR2&quot;</span>)</span>
<span id="cb79-49"><a href="figure-3.html#cb79-49" tabindex="-1"></a></span>
<span id="cb79-50"><a href="figure-3.html#cb79-50" tabindex="-1"></a>SUZ12 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_SUZ12.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-51"><a href="figure-3.html#cb79-51" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-52"><a href="figure-3.html#cb79-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;SUZ12&quot;</span>)</span>
<span id="cb79-53"><a href="figure-3.html#cb79-53" tabindex="-1"></a></span>
<span id="cb79-54"><a href="figure-3.html#cb79-54" tabindex="-1"></a>SETD2 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_SETD2.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-55"><a href="figure-3.html#cb79-55" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-56"><a href="figure-3.html#cb79-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;SETD2&quot;</span>)</span>
<span id="cb79-57"><a href="figure-3.html#cb79-57" tabindex="-1"></a></span>
<span id="cb79-58"><a href="figure-3.html#cb79-58" tabindex="-1"></a>JAK3 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_JAK3.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-59"><a href="figure-3.html#cb79-59" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-60"><a href="figure-3.html#cb79-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;JAK3&quot;</span>)</span>
<span id="cb79-61"><a href="figure-3.html#cb79-61" tabindex="-1"></a></span>
<span id="cb79-62"><a href="figure-3.html#cb79-62" tabindex="-1"></a>SACS <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_SACS.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-63"><a href="figure-3.html#cb79-63" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-64"><a href="figure-3.html#cb79-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;SACS&quot;</span>)</span>
<span id="cb79-65"><a href="figure-3.html#cb79-65" tabindex="-1"></a></span>
<span id="cb79-66"><a href="figure-3.html#cb79-66" tabindex="-1"></a>EP300 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_EP300.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-67"><a href="figure-3.html#cb79-67" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-68"><a href="figure-3.html#cb79-68" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;EP300&quot;</span>)</span>
<span id="cb79-69"><a href="figure-3.html#cb79-69" tabindex="-1"></a></span>
<span id="cb79-70"><a href="figure-3.html#cb79-70" tabindex="-1"></a><span class="do">## Select relevant mutations</span></span>
<span id="cb79-71"><a href="figure-3.html#cb79-71" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NOTCH1,RUNX1,PHF6,NRAS,ETV6,DNMT3A,PAX5,TP53,IDH,SETD1B,NCOR2,SUZ12,SETD2,JAK3,SACS,EP300) <span class="sc">%&gt;%</span></span>
<span id="cb79-72"><a href="figure-3.html#cb79-72" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,type,t) </span>
<span id="cb79-73"><a href="figure-3.html#cb79-73" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">acast</span>(dat,name <span class="sc">~</span> type) <span class="sc">%&gt;%</span></span>
<span id="cb79-74"><a href="figure-3.html#cb79-74" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-75"><a href="figure-3.html#cb79-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(IDH,NOTCH1,DNMT3A,ETV6,EP300,JAK3,NCOR2,NRAS,PAX5,PHF6,RUNX1,SACS,SETD1B,SETD2,SUZ12,TP53,<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb79-76"><a href="figure-3.html#cb79-76" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb79-77"><a href="figure-3.html#cb79-77" tabindex="-1"></a><span class="fu">write.table</span>(dat1,<span class="st">&quot;result/Figure3/3B_CorMutations.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb79-78"><a href="figure-3.html#cb79-78" tabindex="-1"></a></span>
<span id="cb79-79"><a href="figure-3.html#cb79-79" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb79-80"><a href="figure-3.html#cb79-80" tabindex="-1"></a><span class="co">#  Step 2: Heatmap of mutations</span></span>
<span id="cb79-81"><a href="figure-3.html#cb79-81" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb79-82"><a href="figure-3.html#cb79-82" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb79-83"><a href="figure-3.html#cb79-83" tabindex="-1"></a></span>
<span id="cb79-84"><a href="figure-3.html#cb79-84" tabindex="-1"></a>kid <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/cell_metabolite_info_all_v1109.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-85"><a href="figure-3.html#cb79-85" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-86"><a href="figure-3.html#cb79-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(refmet_name <span class="sc">%in%</span> <span class="fu">colnames</span>(dat1)) <span class="sc">%&gt;%</span></span>
<span id="cb79-87"><a href="figure-3.html#cb79-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(refmet_name,<span class="fu">colnames</span>(dat1)))</span>
<span id="cb79-88"><a href="figure-3.html#cb79-88" tabindex="-1"></a></span>
<span id="cb79-89"><a href="figure-3.html#cb79-89" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acids and peptides&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb79-90"><a href="figure-3.html#cb79-90" tabindex="-1"></a>          <span class="st">&quot;Carbohydrates&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,<span class="st">&quot;Cofactors and Vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb79-91"><a href="figure-3.html#cb79-91" tabindex="-1"></a>          <span class="st">&quot;Energy&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,<span class="st">&quot;Lipids&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,<span class="st">&quot;Nucleic acids&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb79-92"><a href="figure-3.html#cb79-92" tabindex="-1"></a>          <span class="st">&quot;Other&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,<span class="st">&quot;Xenobiotics&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb79-93"><a href="figure-3.html#cb79-93" tabindex="-1"></a></span>
<span id="cb79-94"><a href="figure-3.html#cb79-94" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb79-95"><a href="figure-3.html#cb79-95" tabindex="-1"></a>  <span class="at">category=</span>kid<span class="sc">$</span>class,</span>
<span id="cb79-96"><a href="figure-3.html#cb79-96" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T), </span>
<span id="cb79-97"><a href="figure-3.html#cb79-97" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="at">category=</span>cols),</span>
<span id="cb79-98"><a href="figure-3.html#cb79-98" tabindex="-1"></a> <span class="at">border =</span> <span class="fu">c</span>(T) ,</span>
<span id="cb79-99"><a href="figure-3.html#cb79-99" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb79-100"><a href="figure-3.html#cb79-100" tabindex="-1"></a>)</span>
<span id="cb79-101"><a href="figure-3.html#cb79-101" tabindex="-1"></a></span>
<span id="cb79-102"><a href="figure-3.html#cb79-102" tabindex="-1"></a><span class="cf">if</span>(<span class="dv">0</span>) {</span>
<span id="cb79-103"><a href="figure-3.html#cb79-103" tabindex="-1"></a>mark_met <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2-Hydroxyglutaric acid&quot;</span>,<span class="st">&quot;L-Glutamine&quot;</span>)</span>
<span id="cb79-104"><a href="figure-3.html#cb79-104" tabindex="-1"></a>met_pos <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rownames</span>(<span class="fu">t</span>(dat1)) <span class="sc">%in%</span> mark_met)</span>
<span id="cb79-105"><a href="figure-3.html#cb79-105" tabindex="-1"></a>  </span>
<span id="cb79-106"><a href="figure-3.html#cb79-106" tabindex="-1"></a>right_anno <span class="ot">&lt;-</span>  <span class="fu">rowAnnotation</span>(<span class="at">mark_met =</span> <span class="fu">anno_mark</span>(<span class="at">at =</span> met_pos,</span>
<span id="cb79-107"><a href="figure-3.html#cb79-107" tabindex="-1"></a>                                                 <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">t</span>(dat1))[met_pos]))</span>
<span id="cb79-108"><a href="figure-3.html#cb79-108" tabindex="-1"></a>}</span>
<span id="cb79-109"><a href="figure-3.html#cb79-109" tabindex="-1"></a></span>
<span id="cb79-110"><a href="figure-3.html#cb79-110" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">1.5</span>,<span class="dv">0</span>, <span class="fl">1.5</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb79-111"><a href="figure-3.html#cb79-111" tabindex="-1"></a></span>
<span id="cb79-112"><a href="figure-3.html#cb79-112" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure3/3B_MutationHeatmap.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb79-113"><a href="figure-3.html#cb79-113" tabindex="-1"></a><span class="fu">Heatmap</span>(dat1,<span class="at">top_annotation=</span>top_annotation,<span class="at">show_column_names =</span> T,<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">1</span>),</span>
<span id="cb79-114"><a href="figure-3.html#cb79-114" tabindex="-1"></a>        <span class="at">col =</span> col_fun,<span class="at">cluster_rows =</span> F,<span class="at">show_column_dend=</span>F,</span>
<span id="cb79-115"><a href="figure-3.html#cb79-115" tabindex="-1"></a>        <span class="at">border_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lty =</span> <span class="dv">1</span>))</span>
<span id="cb79-116"><a href="figure-3.html#cb79-116" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure3/3B.png" width="832" style="display: block; margin: auto;" /></p>
</div>
<div id="c-idh12-and-etv6-mutations" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> (C) IDH1/2 and ETV6 Mutations<a href="figure-3.html#c-idh12-and-etv6-mutations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Correlations between IDH1/2 mutations and 2-HG (left panel) and ETV6 mutations and glutamine (right panel)</strong>. All samples are ordered based on the abundance (y-axis) of indicated metabolites, and the ones with corresponding mutations are highlighted in red and indicated by the corresponding lines displayed in x-axis.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="figure-3.html#cb80-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb80-2"><a href="figure-3.html#cb80-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb80-3"><a href="figure-3.html#cb80-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb80-4"><a href="figure-3.html#cb80-4" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb80-5"><a href="figure-3.html#cb80-5" tabindex="-1"></a></span>
<span id="cb80-6"><a href="figure-3.html#cb80-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-7"><a href="figure-3.html#cb80-7" tabindex="-1"></a><span class="co">#  Step 1: Load mutation data</span></span>
<span id="cb80-8"><a href="figure-3.html#cb80-8" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-9"><a href="figure-3.html#cb80-9" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-10"><a href="figure-3.html#cb80-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="figure-3.html#cb80-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="figure-3.html#cb80-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb80-13"><a href="figure-3.html#cb80-13" tabindex="-1"></a></span>
<span id="cb80-14"><a href="figure-3.html#cb80-14" tabindex="-1"></a>mutation_b <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_B_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-15"><a href="figure-3.html#cb80-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-16"><a href="figure-3.html#cb80-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17) <span class="sc">%&gt;%</span></span>
<span id="cb80-17"><a href="figure-3.html#cb80-17" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb80-18"><a href="figure-3.html#cb80-18" tabindex="-1"></a>mutation_t <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_T_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-19"><a href="figure-3.html#cb80-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-20"><a href="figure-3.html#cb80-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17) <span class="sc">%&gt;%</span></span>
<span id="cb80-21"><a href="figure-3.html#cb80-21" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb80-22"><a href="figure-3.html#cb80-22" tabindex="-1"></a></span>
<span id="cb80-23"><a href="figure-3.html#cb80-23" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-24"><a href="figure-3.html#cb80-24" tabindex="-1"></a><span class="co">#  Step 2: IDH1/2 and 2-Hydroxyglutaric acid</span></span>
<span id="cb80-25"><a href="figure-3.html#cb80-25" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-26"><a href="figure-3.html#cb80-26" tabindex="-1"></a><span class="do">## IDH1/2</span></span>
<span id="cb80-27"><a href="figure-3.html#cb80-27" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mutation_b,mutation_t) <span class="sc">%&gt;%</span></span>
<span id="cb80-28"><a href="figure-3.html#cb80-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V17 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>))</span>
<span id="cb80-29"><a href="figure-3.html#cb80-29" tabindex="-1"></a></span>
<span id="cb80-30"><a href="figure-3.html#cb80-30" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-31"><a href="figure-3.html#cb80-31" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-32"><a href="figure-3.html#cb80-32" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-33"><a href="figure-3.html#cb80-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_info<span class="sc">$</span>METc_BM_D0_ID))</span>
<span id="cb80-34"><a href="figure-3.html#cb80-34" tabindex="-1"></a></span>
<span id="cb80-35"><a href="figure-3.html#cb80-35" tabindex="-1"></a><span class="do">## 2-Hydroxyglutaric acid</span></span>
<span id="cb80-36"><a href="figure-3.html#cb80-36" tabindex="-1"></a>meta_filter<span class="ot">=</span><span class="st">&quot;2-Hydroxyglutaric acid&quot;</span></span>
<span id="cb80-37"><a href="figure-3.html#cb80-37" tabindex="-1"></a>metabolite_diff <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_IDH.txt&quot;</span>)</span>
<span id="cb80-38"><a href="figure-3.html#cb80-38" tabindex="-1"></a></span>
<span id="cb80-39"><a href="figure-3.html#cb80-39" tabindex="-1"></a>dat_melt_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb80-40"><a href="figure-3.html#cb80-40" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-41"><a href="figure-3.html#cb80-41" tabindex="-1"></a>    reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-42"><a href="figure-3.html#cb80-42" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(id<span class="sc">==</span>meta_filter) <span class="sc">%&gt;%</span></span>
<span id="cb80-43"><a href="figure-3.html#cb80-43" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_info,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;METc_BM_D0_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-44"><a href="figure-3.html#cb80-44" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb80-45"><a href="figure-3.html#cb80-45" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(metabolite_diff,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-46"><a href="figure-3.html#cb80-46" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(RNA_id_raw <span class="sc">%in%</span> mutation<span class="sc">$</span>V2,<span class="st">&quot;IDH&quot;</span>,<span class="st">&quot;non_IDH&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-47"><a href="figure-3.html#cb80-47" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">variable=</span><span class="fu">factor</span>(variable,<span class="at">levels =</span> variable))</span>
<span id="cb80-48"><a href="figure-3.html#cb80-48" tabindex="-1"></a>  </span>
<span id="cb80-49"><a href="figure-3.html#cb80-49" tabindex="-1"></a><span class="do">## Visualization</span></span>
<span id="cb80-50"><a href="figure-3.html#cb80-50" tabindex="-1"></a>  t<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>t,<span class="dv">2</span>))</span>
<span id="cb80-51"><a href="figure-3.html#cb80-51" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>P.Value,<span class="dv">3</span>))</span>
<span id="cb80-52"><a href="figure-3.html#cb80-52" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt_filter,<span class="fu">aes</span>(variable,<span class="fu">log2</span>(value<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb80-53"><a href="figure-3.html#cb80-53" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(type)))<span class="sc">+</span></span>
<span id="cb80-54"><a href="figure-3.html#cb80-54" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-55"><a href="figure-3.html#cb80-55" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb80-56"><a href="figure-3.html#cb80-56" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-57"><a href="figure-3.html#cb80-57" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb80-58"><a href="figure-3.html#cb80-58" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">title=</span><span class="fu">paste0</span>(meta_filter,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">T statistic = &quot;</span>,t,<span class="st">&quot;; p=&quot;</span>,p))<span class="sc">+</span></span>
<span id="cb80-59"><a href="figure-3.html#cb80-59" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb80-60"><a href="figure-3.html#cb80-60" tabindex="-1"></a>  </span>
<span id="cb80-61"><a href="figure-3.html#cb80-61" tabindex="-1"></a>  sample_order <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Meta_ID=</span>dat_melt_filter<span class="sc">$</span>variable,<span class="at">type=</span><span class="fu">factor</span>(dat_melt_filter<span class="sc">$</span>type))</span>
<span id="cb80-62"><a href="figure-3.html#cb80-62" tabindex="-1"></a>  </span>
<span id="cb80-63"><a href="figure-3.html#cb80-63" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sample_order,<span class="fu">aes</span>(Meta_ID,<span class="at">y=</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb80-64"><a href="figure-3.html#cb80-64" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>type,<span class="at">color=</span>type),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb80-65"><a href="figure-3.html#cb80-65" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Ordered samples&quot;</span>)<span class="sc">+</span></span>
<span id="cb80-66"><a href="figure-3.html#cb80-66" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb80-67"><a href="figure-3.html#cb80-67" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb80-68"><a href="figure-3.html#cb80-68" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb80-69"><a href="figure-3.html#cb80-69" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-70"><a href="figure-3.html#cb80-70" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-71"><a href="figure-3.html#cb80-71" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>,<span class="at">axis.title.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb80-72"><a href="figure-3.html#cb80-72" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1,p2,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">rel_heights=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">3</span>),<span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),<span class="at">align=</span><span class="st">&quot;v&quot;</span>)</span>
<span id="cb80-73"><a href="figure-3.html#cb80-73" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">&quot;result/Figure3/3C_2-HG.pdf&quot;</span>,p)</span>
<span id="cb80-74"><a href="figure-3.html#cb80-74" tabindex="-1"></a></span>
<span id="cb80-75"><a href="figure-3.html#cb80-75" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-76"><a href="figure-3.html#cb80-76" tabindex="-1"></a><span class="co">#  Step 3: ETV6 and L-Glutamine</span></span>
<span id="cb80-77"><a href="figure-3.html#cb80-77" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb80-78"><a href="figure-3.html#cb80-78" tabindex="-1"></a><span class="do">## ETV6</span></span>
<span id="cb80-79"><a href="figure-3.html#cb80-79" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-80"><a href="figure-3.html#cb80-80" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-81"><a href="figure-3.html#cb80-81" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb80-82"><a href="figure-3.html#cb80-82" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb80-83"><a href="figure-3.html#cb80-83" tabindex="-1"></a></span>
<span id="cb80-84"><a href="figure-3.html#cb80-84" tabindex="-1"></a>mutation_b <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_B_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-85"><a href="figure-3.html#cb80-85" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-86"><a href="figure-3.html#cb80-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17) <span class="sc">%&gt;%</span></span>
<span id="cb80-87"><a href="figure-3.html#cb80-87" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb80-88"><a href="figure-3.html#cb80-88" tabindex="-1"></a>mutation_t <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_T_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-89"><a href="figure-3.html#cb80-89" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-90"><a href="figure-3.html#cb80-90" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17) <span class="sc">%&gt;%</span></span>
<span id="cb80-91"><a href="figure-3.html#cb80-91" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb80-92"><a href="figure-3.html#cb80-92" tabindex="-1"></a></span>
<span id="cb80-93"><a href="figure-3.html#cb80-93" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mutation_b,mutation_t) <span class="sc">%&gt;%</span></span>
<span id="cb80-94"><a href="figure-3.html#cb80-94" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(V17 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ETV6&quot;</span>))</span>
<span id="cb80-95"><a href="figure-3.html#cb80-95" tabindex="-1"></a></span>
<span id="cb80-96"><a href="figure-3.html#cb80-96" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-97"><a href="figure-3.html#cb80-97" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-98"><a href="figure-3.html#cb80-98" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-99"><a href="figure-3.html#cb80-99" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_info<span class="sc">$</span>METc_BM_D0_ID))</span>
<span id="cb80-100"><a href="figure-3.html#cb80-100" tabindex="-1"></a></span>
<span id="cb80-101"><a href="figure-3.html#cb80-101" tabindex="-1"></a><span class="do">## L-Glutamine</span></span>
<span id="cb80-102"><a href="figure-3.html#cb80-102" tabindex="-1"></a>meta_filter<span class="ot">=</span><span class="st">&quot;L-Glutamine&quot;</span></span>
<span id="cb80-103"><a href="figure-3.html#cb80-103" tabindex="-1"></a>metabolite_diff <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4B.all_ETV6.txt&quot;</span>)</span>
<span id="cb80-104"><a href="figure-3.html#cb80-104" tabindex="-1"></a></span>
<span id="cb80-105"><a href="figure-3.html#cb80-105" tabindex="-1"></a>dat_melt_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb80-106"><a href="figure-3.html#cb80-106" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-107"><a href="figure-3.html#cb80-107" tabindex="-1"></a>    reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-108"><a href="figure-3.html#cb80-108" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(id<span class="sc">==</span>meta_filter) <span class="sc">%&gt;%</span></span>
<span id="cb80-109"><a href="figure-3.html#cb80-109" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_info,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;METc_BM_D0_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-110"><a href="figure-3.html#cb80-110" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb80-111"><a href="figure-3.html#cb80-111" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(metabolite_diff,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-112"><a href="figure-3.html#cb80-112" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(RNA_id_raw <span class="sc">%in%</span> mutation<span class="sc">$</span>V2,<span class="st">&quot;ETV6&quot;</span>,<span class="st">&quot;non_ETV6&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-113"><a href="figure-3.html#cb80-113" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">variable=</span><span class="fu">factor</span>(variable,<span class="at">levels =</span> variable))</span>
<span id="cb80-114"><a href="figure-3.html#cb80-114" tabindex="-1"></a></span>
<span id="cb80-115"><a href="figure-3.html#cb80-115" tabindex="-1"></a><span class="do">## Visualization  </span></span>
<span id="cb80-116"><a href="figure-3.html#cb80-116" tabindex="-1"></a>  t<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>t,<span class="dv">2</span>))</span>
<span id="cb80-117"><a href="figure-3.html#cb80-117" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>P.Value,<span class="dv">3</span>))</span>
<span id="cb80-118"><a href="figure-3.html#cb80-118" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt_filter,<span class="fu">aes</span>(variable,<span class="fu">log2</span>(value<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb80-119"><a href="figure-3.html#cb80-119" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(type)))<span class="sc">+</span></span>
<span id="cb80-120"><a href="figure-3.html#cb80-120" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-121"><a href="figure-3.html#cb80-121" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb80-122"><a href="figure-3.html#cb80-122" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb80-123"><a href="figure-3.html#cb80-123" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb80-124"><a href="figure-3.html#cb80-124" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">title=</span><span class="fu">paste0</span>(meta_filter,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">T statistic = &quot;</span>,t,<span class="st">&quot;; p=&quot;</span>,p))<span class="sc">+</span></span>
<span id="cb80-125"><a href="figure-3.html#cb80-125" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb80-126"><a href="figure-3.html#cb80-126" tabindex="-1"></a>  </span>
<span id="cb80-127"><a href="figure-3.html#cb80-127" tabindex="-1"></a>  sample_order <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Meta_ID=</span>dat_melt_filter<span class="sc">$</span>variable,<span class="at">type=</span><span class="fu">factor</span>(dat_melt_filter<span class="sc">$</span>type))</span>
<span id="cb80-128"><a href="figure-3.html#cb80-128" tabindex="-1"></a>  </span>
<span id="cb80-129"><a href="figure-3.html#cb80-129" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sample_order,<span class="fu">aes</span>(Meta_ID,<span class="at">y=</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb80-130"><a href="figure-3.html#cb80-130" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>type,<span class="at">color=</span>type),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb80-131"><a href="figure-3.html#cb80-131" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Ordered samples&quot;</span>)<span class="sc">+</span></span>
<span id="cb80-132"><a href="figure-3.html#cb80-132" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb80-133"><a href="figure-3.html#cb80-133" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb80-134"><a href="figure-3.html#cb80-134" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb80-135"><a href="figure-3.html#cb80-135" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-136"><a href="figure-3.html#cb80-136" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb80-137"><a href="figure-3.html#cb80-137" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>,<span class="at">axis.title.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb80-138"><a href="figure-3.html#cb80-138" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1,p2,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">rel_heights=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">3</span>),<span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),<span class="at">align=</span><span class="st">&quot;v&quot;</span>)</span>
<span id="cb80-139"><a href="figure-3.html#cb80-139" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure3/3C_Glutamine.pdf&quot;</span>,p)</span></code></pre></div>
<p><img src="Figure-1025/Figure3/3C.png" width="536" style="display: block; margin: auto;" /></p>
</div>
<div id="d-fusions-and-metabolites" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> (D) Fusions and Metabolites<a href="figure-3.html#d-fusions-and-metabolites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The heatmap illustrates the associations between <strong>the abundances of metabolites and the presence of indicated well-known gene fusions</strong>. T statistics are calculated by a linear regression model.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="figure-3.html#cb81-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb81-2"><a href="figure-3.html#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="figure-3.html#cb81-3" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb81-4"><a href="figure-3.html#cb81-4" tabindex="-1"></a><span class="co">#  Step 1: Load fusion data</span></span>
<span id="cb81-5"><a href="figure-3.html#cb81-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb81-6"><a href="figure-3.html#cb81-6" tabindex="-1"></a>BCR <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_BCR-ABL1.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="figure-3.html#cb81-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-8"><a href="figure-3.html#cb81-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;BCR-ABL1&quot;</span>)</span>
<span id="cb81-9"><a href="figure-3.html#cb81-9" tabindex="-1"></a></span>
<span id="cb81-10"><a href="figure-3.html#cb81-10" tabindex="-1"></a>DUX4 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_DUX4 rearrangement.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-11"><a href="figure-3.html#cb81-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-12"><a href="figure-3.html#cb81-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;DUX4&quot;</span>)</span>
<span id="cb81-13"><a href="figure-3.html#cb81-13" tabindex="-1"></a></span>
<span id="cb81-14"><a href="figure-3.html#cb81-14" tabindex="-1"></a>ZNF384 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_ZNF384 fusion.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-15"><a href="figure-3.html#cb81-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-16"><a href="figure-3.html#cb81-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;ZNF384&quot;</span>)</span>
<span id="cb81-17"><a href="figure-3.html#cb81-17" tabindex="-1"></a></span>
<span id="cb81-18"><a href="figure-3.html#cb81-18" tabindex="-1"></a>TCF3 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_TCF3-PBX1.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-19"><a href="figure-3.html#cb81-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-20"><a href="figure-3.html#cb81-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;TCF3-PBX1&quot;</span>)</span>
<span id="cb81-21"><a href="figure-3.html#cb81-21" tabindex="-1"></a></span>
<span id="cb81-22"><a href="figure-3.html#cb81-22" tabindex="-1"></a>SET <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_SET-NUP214.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-23"><a href="figure-3.html#cb81-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-24"><a href="figure-3.html#cb81-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;SET-NUP214&quot;</span>)</span>
<span id="cb81-25"><a href="figure-3.html#cb81-25" tabindex="-1"></a></span>
<span id="cb81-26"><a href="figure-3.html#cb81-26" tabindex="-1"></a>KMT2A <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_KMT2A rearrangement.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-27"><a href="figure-3.html#cb81-27" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-28"><a href="figure-3.html#cb81-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;KMT2A&quot;</span>)</span>
<span id="cb81-29"><a href="figure-3.html#cb81-29" tabindex="-1"></a></span>
<span id="cb81-30"><a href="figure-3.html#cb81-30" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(BCR,DUX4,ZNF384,TCF3,SET,KMT2A) <span class="sc">%&gt;%</span></span>
<span id="cb81-31"><a href="figure-3.html#cb81-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(name,type,t) </span>
<span id="cb81-32"><a href="figure-3.html#cb81-32" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">acast</span>(dat,name <span class="sc">~</span> type) <span class="sc">%&gt;%</span></span>
<span id="cb81-33"><a href="figure-3.html#cb81-33" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb81-34"><a href="figure-3.html#cb81-34" tabindex="-1"></a><span class="fu">write.table</span>(dat1,<span class="st">&quot;result/Figure3/3D_CorFusions.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb81-35"><a href="figure-3.html#cb81-35" tabindex="-1"></a></span>
<span id="cb81-36"><a href="figure-3.html#cb81-36" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb81-37"><a href="figure-3.html#cb81-37" tabindex="-1"></a><span class="co">#  Step 2: Heatmap of fusions</span></span>
<span id="cb81-38"><a href="figure-3.html#cb81-38" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb81-39"><a href="figure-3.html#cb81-39" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb81-40"><a href="figure-3.html#cb81-40" tabindex="-1"></a></span>
<span id="cb81-41"><a href="figure-3.html#cb81-41" tabindex="-1"></a>kid <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/cell_metabolite_info_all_v1109.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-42"><a href="figure-3.html#cb81-42" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-43"><a href="figure-3.html#cb81-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(refmet_name <span class="sc">%in%</span> <span class="fu">colnames</span>(dat1)) <span class="sc">%&gt;%</span></span>
<span id="cb81-44"><a href="figure-3.html#cb81-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(refmet_name,<span class="fu">colnames</span>(dat1)))</span>
<span id="cb81-45"><a href="figure-3.html#cb81-45" tabindex="-1"></a></span>
<span id="cb81-46"><a href="figure-3.html#cb81-46" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acids and peptides&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb81-47"><a href="figure-3.html#cb81-47" tabindex="-1"></a>          <span class="st">&quot;Carbohydrates&quot;</span><span class="ot">=</span><span class="st">&quot;#D95F02&quot;</span>,<span class="st">&quot;Cofactors and Vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb81-48"><a href="figure-3.html#cb81-48" tabindex="-1"></a>          <span class="st">&quot;Energy&quot;</span><span class="ot">=</span><span class="st">&quot;#E7298A&quot;</span>,<span class="st">&quot;Lipids&quot;</span><span class="ot">=</span><span class="st">&quot;#66A61E&quot;</span>,<span class="st">&quot;Nucleic acids&quot;</span><span class="ot">=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb81-49"><a href="figure-3.html#cb81-49" tabindex="-1"></a>          <span class="st">&quot;Other&quot;</span><span class="ot">=</span><span class="st">&quot;#A6761D&quot;</span>,<span class="st">&quot;Xenobiotics&quot;</span><span class="ot">=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb81-50"><a href="figure-3.html#cb81-50" tabindex="-1"></a></span>
<span id="cb81-51"><a href="figure-3.html#cb81-51" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb81-52"><a href="figure-3.html#cb81-52" tabindex="-1"></a>  <span class="at">category=</span>kid<span class="sc">$</span>class,</span>
<span id="cb81-53"><a href="figure-3.html#cb81-53" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T), </span>
<span id="cb81-54"><a href="figure-3.html#cb81-54" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="at">category=</span>cols),</span>
<span id="cb81-55"><a href="figure-3.html#cb81-55" tabindex="-1"></a>  <span class="at">border =</span> <span class="fu">c</span>(T) ,</span>
<span id="cb81-56"><a href="figure-3.html#cb81-56" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb81-57"><a href="figure-3.html#cb81-57" tabindex="-1"></a>)</span>
<span id="cb81-58"><a href="figure-3.html#cb81-58" tabindex="-1"></a></span>
<span id="cb81-59"><a href="figure-3.html#cb81-59" tabindex="-1"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb81-60"><a href="figure-3.html#cb81-60" tabindex="-1"></a>mark_met <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Inosine&quot;</span>,<span class="st">&quot;2&#39;,3&#39; cyclic AMP&quot;</span>)</span>
<span id="cb81-61"><a href="figure-3.html#cb81-61" tabindex="-1"></a>met_pos <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rownames</span>(<span class="fu">t</span>(dat1)) <span class="sc">%in%</span> mark_met)</span>
<span id="cb81-62"><a href="figure-3.html#cb81-62" tabindex="-1"></a>  </span>
<span id="cb81-63"><a href="figure-3.html#cb81-63" tabindex="-1"></a>right_anno <span class="ot">&lt;-</span>  <span class="fu">rowAnnotation</span>(<span class="at">mark_met =</span> <span class="fu">anno_mark</span>(<span class="at">at =</span> met_pos,</span>
<span id="cb81-64"><a href="figure-3.html#cb81-64" tabindex="-1"></a>                             <span class="at">labels =</span> <span class="fu">rownames</span>(<span class="fu">t</span>(dat1))[met_pos]))</span>
<span id="cb81-65"><a href="figure-3.html#cb81-65" tabindex="-1"></a>}</span>
<span id="cb81-66"><a href="figure-3.html#cb81-66" tabindex="-1"></a></span>
<span id="cb81-67"><a href="figure-3.html#cb81-67" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="fl">1.5</span>,<span class="dv">0</span>, <span class="fl">1.5</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb81-68"><a href="figure-3.html#cb81-68" tabindex="-1"></a></span>
<span id="cb81-69"><a href="figure-3.html#cb81-69" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure3/3D_FusionHeatmap.pdf&quot;</span>,<span class="at">width=</span><span class="dv">8</span>,<span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb81-70"><a href="figure-3.html#cb81-70" tabindex="-1"></a><span class="fu">Heatmap</span>(dat1,<span class="at">top_annotation=</span>top_annotation,<span class="at">show_column_names =</span> T,<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">1</span>),</span>
<span id="cb81-71"><a href="figure-3.html#cb81-71" tabindex="-1"></a>        <span class="at">col =</span> col_fun,<span class="at">cluster_columns =</span> T,<span class="at">show_row_names=</span>T,</span>
<span id="cb81-72"><a href="figure-3.html#cb81-72" tabindex="-1"></a>        <span class="at">show_column_dend=</span>F,</span>
<span id="cb81-73"><a href="figure-3.html#cb81-73" tabindex="-1"></a>        <span class="at">border_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lty =</span> <span class="dv">1</span>),<span class="at">show_row_dend =</span> F)</span>
<span id="cb81-74"><a href="figure-3.html#cb81-74" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure3/3D.png" width="846" style="display: block; margin: auto;" /></p>
</div>
<div id="e-bcr-abl1-fusion" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> (E) BCR-ABL1 Fusion<a href="figure-3.html#e-bcr-abl1-fusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Correlations between the <strong>BCR-ABL1 fusion</strong> and the abundances of <strong>adenosine (left panel) and 2’,3’ cyclic AMP (right panel)</strong>. Fusion genes-related metabolites are shown as lines and samples are ordered based on the abundance (y-axis) of indicated metabolites.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="figure-3.html#cb82-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb82-2"><a href="figure-3.html#cb82-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb82-3"><a href="figure-3.html#cb82-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb82-4"><a href="figure-3.html#cb82-4" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb82-5"><a href="figure-3.html#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="figure-3.html#cb82-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb82-7"><a href="figure-3.html#cb82-7" tabindex="-1"></a><span class="co">#  Step 1: Load fusion data</span></span>
<span id="cb82-8"><a href="figure-3.html#cb82-8" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb82-9"><a href="figure-3.html#cb82-9" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-10"><a href="figure-3.html#cb82-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-11"><a href="figure-3.html#cb82-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb82-12"><a href="figure-3.html#cb82-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb82-13"><a href="figure-3.html#cb82-13" tabindex="-1"></a></span>
<span id="cb82-14"><a href="figure-3.html#cb82-14" tabindex="-1"></a>fusion_b <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/fusion_B_v0803.xlsx&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-15"><a href="figure-3.html#cb82-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-16"><a href="figure-3.html#cb82-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,fusion_group) <span class="sc">%&gt;%</span></span>
<span id="cb82-17"><a href="figure-3.html#cb82-17" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-18"><a href="figure-3.html#cb82-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fusion_group=</span><span class="fu">ifelse</span>(fusion_group<span class="sc">==</span><span class="st">&quot;BCR--ABL1&quot;</span>,<span class="st">&quot;BCR-ABL1&quot;</span>,fusion_group)) <span class="sc">%&gt;%</span></span>
<span id="cb82-19"><a href="figure-3.html#cb82-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fusion_group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;BCR-ABL1&quot;</span>,fusion_group),<span class="st">&quot;BCR-ABL1&quot;</span>,fusion_group)) <span class="sc">%&gt;%</span></span>
<span id="cb82-20"><a href="figure-3.html#cb82-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fusion_group=</span><span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;PAX5-&quot;</span>,fusion_group),<span class="st">&quot;PAX5 Group&quot;</span>,fusion_group)) <span class="sc">%&gt;%</span></span>
<span id="cb82-21"><a href="figure-3.html#cb82-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fusion_group=</span><span class="fu">ifelse</span>(fusion_group<span class="sc">==</span><span class="st">&quot;PICALM-MLLT10&quot;</span>,<span class="st">&quot;MLLT10 rearrangement&quot;</span>,fusion_group))</span>
<span id="cb82-22"><a href="figure-3.html#cb82-22" tabindex="-1"></a>fusion_t <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/fusion_T_v0803.xlsx&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-23"><a href="figure-3.html#cb82-23" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-24"><a href="figure-3.html#cb82-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,final_check) <span class="sc">%&gt;%</span></span>
<span id="cb82-25"><a href="figure-3.html#cb82-25" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-26"><a href="figure-3.html#cb82-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_check=</span><span class="fu">ifelse</span>(final_check<span class="sc">==</span><span class="st">&quot;KMT2A rearrangement&quot;</span>,<span class="st">&quot;KMT2A Group&quot;</span>,final_check)) <span class="sc">%&gt;%</span></span>
<span id="cb82-27"><a href="figure-3.html#cb82-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;fusion_group&quot;</span><span class="ot">=</span><span class="st">&quot;final_check&quot;</span>)</span>
<span id="cb82-28"><a href="figure-3.html#cb82-28" tabindex="-1"></a></span>
<span id="cb82-29"><a href="figure-3.html#cb82-29" tabindex="-1"></a>fusion <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fusion_b,fusion_t) <span class="sc">%&gt;%</span></span>
<span id="cb82-30"><a href="figure-3.html#cb82-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fusion_group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BCR-ABL1&quot;</span>))</span>
<span id="cb82-31"><a href="figure-3.html#cb82-31" tabindex="-1"></a></span>
<span id="cb82-32"><a href="figure-3.html#cb82-32" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-33"><a href="figure-3.html#cb82-33" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-34"><a href="figure-3.html#cb82-34" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-35"><a href="figure-3.html#cb82-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_info<span class="sc">$</span>METc_BM_D0_ID))</span>
<span id="cb82-36"><a href="figure-3.html#cb82-36" tabindex="-1"></a></span>
<span id="cb82-37"><a href="figure-3.html#cb82-37" tabindex="-1"></a>metabolite_diff <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/temp/Fig4D.all_BCR-ABL1.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-38"><a href="figure-3.html#cb82-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Inosine&quot;</span>,<span class="st">&quot;2&#39;,3&#39; cyclic AMP&quot;</span>,<span class="st">&quot;Adenosine&quot;</span>))</span>
<span id="cb82-39"><a href="figure-3.html#cb82-39" tabindex="-1"></a></span>
<span id="cb82-40"><a href="figure-3.html#cb82-40" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb82-41"><a href="figure-3.html#cb82-41" tabindex="-1"></a><span class="co">#  Step 2: BCR-ABL1 and Inosine&quot;,&quot;2&#39;,3&#39; cyclic AMP&quot;,&quot;Adenosine&quot;</span></span>
<span id="cb82-42"><a href="figure-3.html#cb82-42" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb82-43"><a href="figure-3.html#cb82-43" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Inosine&quot;</span>,<span class="st">&quot;2&#39;,3&#39; cyclic AMP&quot;</span>,<span class="st">&quot;Adenosine&quot;</span>)</span>
<span id="cb82-44"><a href="figure-3.html#cb82-44" tabindex="-1"></a><span class="cf">for</span> (meta_filter <span class="cf">in</span> a) {</span>
<span id="cb82-45"><a href="figure-3.html#cb82-45" tabindex="-1"></a>  dat_melt_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb82-46"><a href="figure-3.html#cb82-46" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-47"><a href="figure-3.html#cb82-47" tabindex="-1"></a>    reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-48"><a href="figure-3.html#cb82-48" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(id<span class="sc">==</span>meta_filter) <span class="sc">%&gt;%</span></span>
<span id="cb82-49"><a href="figure-3.html#cb82-49" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_info,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;METc_BM_D0_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-50"><a href="figure-3.html#cb82-50" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(value) <span class="sc">%&gt;%</span></span>
<span id="cb82-51"><a href="figure-3.html#cb82-51" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(metabolite_diff,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;id&quot;</span><span class="ot">=</span><span class="st">&quot;name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-52"><a href="figure-3.html#cb82-52" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(RNA_id_raw <span class="sc">%in%</span> fusion<span class="sc">$</span>RNA_id,<span class="st">&quot;fusion&quot;</span>,<span class="st">&quot;non_fusion&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb82-53"><a href="figure-3.html#cb82-53" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">variable=</span><span class="fu">factor</span>(variable,<span class="at">levels =</span> variable))</span>
<span id="cb82-54"><a href="figure-3.html#cb82-54" tabindex="-1"></a>  </span>
<span id="cb82-55"><a href="figure-3.html#cb82-55" tabindex="-1"></a>  t<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>t,<span class="dv">2</span>))</span>
<span id="cb82-56"><a href="figure-3.html#cb82-56" tabindex="-1"></a>  p<span class="ot">=</span><span class="fu">unique</span>(<span class="fu">round</span>(dat_melt_filter<span class="sc">$</span>P.Value,<span class="dv">3</span>))</span>
<span id="cb82-57"><a href="figure-3.html#cb82-57" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt_filter,<span class="fu">aes</span>(variable,<span class="fu">log2</span>(value<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb82-58"><a href="figure-3.html#cb82-58" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(type)))<span class="sc">+</span></span>
<span id="cb82-59"><a href="figure-3.html#cb82-59" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-60"><a href="figure-3.html#cb82-60" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb82-61"><a href="figure-3.html#cb82-61" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb82-62"><a href="figure-3.html#cb82-62" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb82-63"><a href="figure-3.html#cb82-63" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">title=</span><span class="fu">paste0</span>(meta_filter,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">T statistic = &quot;</span>,t,<span class="st">&quot;; p=&quot;</span>,p))<span class="sc">+</span></span>
<span id="cb82-64"><a href="figure-3.html#cb82-64" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb82-65"><a href="figure-3.html#cb82-65" tabindex="-1"></a>  </span>
<span id="cb82-66"><a href="figure-3.html#cb82-66" tabindex="-1"></a>  sample_order <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Meta_ID=</span>dat_melt_filter<span class="sc">$</span>variable,<span class="at">type=</span><span class="fu">factor</span>(dat_melt_filter<span class="sc">$</span>type))</span>
<span id="cb82-67"><a href="figure-3.html#cb82-67" tabindex="-1"></a>  </span>
<span id="cb82-68"><a href="figure-3.html#cb82-68" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sample_order,<span class="fu">aes</span>(Meta_ID,<span class="at">y=</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb82-69"><a href="figure-3.html#cb82-69" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>type,<span class="at">color=</span>type),<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb82-70"><a href="figure-3.html#cb82-70" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Ordered samples&quot;</span>)<span class="sc">+</span></span>
<span id="cb82-71"><a href="figure-3.html#cb82-71" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb82-72"><a href="figure-3.html#cb82-72" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb82-73"><a href="figure-3.html#cb82-73" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb82-74"><a href="figure-3.html#cb82-74" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-75"><a href="figure-3.html#cb82-75" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;white&quot;</span>))<span class="sc">+</span></span>
<span id="cb82-76"><a href="figure-3.html#cb82-76" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&#39;none&#39;</span>,<span class="at">axis.title.y=</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb82-77"><a href="figure-3.html#cb82-77" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1,p2,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">1</span>,<span class="at">rel_heights=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">3</span>),<span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>),<span class="at">align=</span><span class="st">&quot;v&quot;</span>)</span>
<span id="cb82-78"><a href="figure-3.html#cb82-78" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;result/Figure3/3E_BCR-ABL1_&quot;</span>,meta_filter,<span class="st">&quot;.pdf&quot;</span>),p,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb82-79"><a href="figure-3.html#cb82-79" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Figure-1025/Figure3/3E.png" width="522" style="display: block; margin: auto;" /></p>
</div>
<div id="s4-a-metabolic-gene-heatmap" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> (S4 A) Metabolic Gene Heatmap<a href="figure-3.html#s4-a-metabolic-gene-heatmap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>metabolic gene (row) heatmap</strong> displays a similar pattern to that of Fig. 4a, showcasing both individual characteristics and potential commonalities among each ALL subtype.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="figure-3.html#cb83-1" tabindex="-1"></a><span class="fu">library</span>(GSVA)</span>
<span id="cb83-2"><a href="figure-3.html#cb83-2" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb83-3"><a href="figure-3.html#cb83-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb83-4"><a href="figure-3.html#cb83-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb83-5"><a href="figure-3.html#cb83-5" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb83-6"><a href="figure-3.html#cb83-6" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb83-7"><a href="figure-3.html#cb83-7" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb83-8"><a href="figure-3.html#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="figure-3.html#cb83-9" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb83-10"><a href="figure-3.html#cb83-10" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb83-11"><a href="figure-3.html#cb83-11" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb83-12"><a href="figure-3.html#cb83-12" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Sample_RNA_190_fusion_mutation_v1130.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-13"><a href="figure-3.html#cb83-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-14"><a href="figure-3.html#cb83-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bianhao,RNA_id,Prediction_Check,Subtype) <span class="sc">%&gt;%</span></span>
<span id="cb83-15"><a href="figure-3.html#cb83-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Subtype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>,<span class="st">&quot;non_Ph&quot;</span>,<span class="st">&quot;Ph&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-16"><a href="figure-3.html#cb83-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Subtype=</span><span class="fu">ifelse</span>(Subtype <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>),Subtype,Prediction_Check)) <span class="sc">%&gt;%</span></span>
<span id="cb83-17"><a href="figure-3.html#cb83-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Subtype=</span><span class="fu">factor</span>(Subtype,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;BCL2/MYC&quot;</span>,<span class="st">&quot;Low hypodiploid&quot;</span>,<span class="st">&quot;ETV6-RUNX1 Group&quot;</span>,<span class="st">&quot;High hyperdoploid&quot;</span>,<span class="st">&quot;PAX5alt&quot;</span>,<span class="st">&quot;PAX5 P80R&quot;</span>,<span class="st">&quot;Ph-like&quot;</span>,<span class="st">&quot;DUX4&quot;</span>,<span class="st">&quot;ZNF384 Group&quot;</span>,<span class="st">&quot;TCF3-PBX1&quot;</span>,<span class="st">&quot;BCR-ABL1&quot;</span>,<span class="st">&quot;TWIST2-high&quot;</span>,<span class="st">&quot;IDH&quot;</span>,<span class="st">&quot;ZEB2&quot;</span>,<span class="st">&quot;MEF2D Group&quot;</span>,<span class="st">&quot;KMT2A Group&quot;</span>,<span class="st">&quot;ETP&quot;</span>,<span class="st">&quot;non_ETP&quot;</span>)))</span>
<span id="cb83-18"><a href="figure-3.html#cb83-18" tabindex="-1"></a></span>
<span id="cb83-19"><a href="figure-3.html#cb83-19" tabindex="-1"></a>kegg_gene <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span></span>
<span id="cb83-20"><a href="figure-3.html#cb83-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-21"><a href="figure-3.html#cb83-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb83-22"><a href="figure-3.html#cb83-22" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb83-23"><a href="figure-3.html#cb83-23" tabindex="-1"></a></span>
<span id="cb83-24"><a href="figure-3.html#cb83-24" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;raw_data/20231113_RNA_ALL_VST_coding.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-25"><a href="figure-3.html#cb83-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-26"><a href="figure-3.html#cb83-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_info<span class="sc">$</span>RNA_id) <span class="sc">%&gt;%</span></span>
<span id="cb83-27"><a href="figure-3.html#cb83-27" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-28"><a href="figure-3.html#cb83-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(gene <span class="sc">%in%</span> kegg_gene) <span class="sc">%&gt;%</span></span>
<span id="cb83-29"><a href="figure-3.html#cb83-29" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;gene&quot;</span>)</span>
<span id="cb83-30"><a href="figure-3.html#cb83-30" tabindex="-1"></a></span>
<span id="cb83-31"><a href="figure-3.html#cb83-31" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;metabolic gene&quot;</span>)</span>
<span id="cb83-32"><a href="figure-3.html#cb83-32" tabindex="-1"></a><span class="fu">dim</span>(dat)</span>
<span id="cb83-33"><a href="figure-3.html#cb83-33" tabindex="-1"></a></span>
<span id="cb83-34"><a href="figure-3.html#cb83-34" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dat<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb83-35"><a href="figure-3.html#cb83-35" tabindex="-1"></a></span>
<span id="cb83-36"><a href="figure-3.html#cb83-36" tabindex="-1"></a>dat<span class="sc">$</span>n <span class="ot">&lt;-</span> n</span>
<span id="cb83-37"><a href="figure-3.html#cb83-37" tabindex="-1"></a></span>
<span id="cb83-38"><a href="figure-3.html#cb83-38" tabindex="-1"></a>dat_filter <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb83-39"><a href="figure-3.html#cb83-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&lt;</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb83-40"><a href="figure-3.html#cb83-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb83-41"><a href="figure-3.html#cb83-41" tabindex="-1"></a></span>
<span id="cb83-42"><a href="figure-3.html#cb83-42" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;result_number&quot;</span>)</span>
<span id="cb83-43"><a href="figure-3.html#cb83-43" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(dat_filter))</span>
<span id="cb83-44"><a href="figure-3.html#cb83-44" tabindex="-1"></a></span>
<span id="cb83-45"><a href="figure-3.html#cb83-45" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb83-46"><a href="figure-3.html#cb83-46" tabindex="-1"></a><span class="co">#  Step 2: Heatmap</span></span>
<span id="cb83-47"><a href="figure-3.html#cb83-47" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb83-48"><a href="figure-3.html#cb83-48" tabindex="-1"></a>dat_scale <span class="ot">&lt;-</span> <span class="fu">myscale</span>(dat_filter,<span class="at">method=</span><span class="st">&quot;raw_zscore&quot;</span>)</span>
<span id="cb83-49"><a href="figure-3.html#cb83-49" tabindex="-1"></a></span>
<span id="cb83-50"><a href="figure-3.html#cb83-50" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">12</span>, <span class="at">name =</span> <span class="st">&quot;Paired&quot;</span>)</span>
<span id="cb83-51"><a href="figure-3.html#cb83-51" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#FB8072&quot;</span>,<span class="st">&quot;#8DD3C7&quot;</span>, <span class="st">&quot;#BEBADA&quot;</span>,<span class="st">&quot;#FDB462&quot;</span>,<span class="st">&quot;#CCEBC5&quot;</span>, <span class="st">&quot;#FFED6F&quot;</span>)</span>
<span id="cb83-52"><a href="figure-3.html#cb83-52" tabindex="-1"></a>q12 <span class="ot">&lt;-</span> <span class="fu">c</span>(q1,q2)</span>
<span id="cb83-53"><a href="figure-3.html#cb83-53" tabindex="-1"></a><span class="fu">names</span>(q12) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sample_info<span class="sc">$</span>Subtype)</span>
<span id="cb83-54"><a href="figure-3.html#cb83-54" tabindex="-1"></a></span>
<span id="cb83-55"><a href="figure-3.html#cb83-55" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb83-56"><a href="figure-3.html#cb83-56" tabindex="-1"></a>  <span class="at">Subtype=</span>sample_info<span class="sc">$</span>Subtype,</span>
<span id="cb83-57"><a href="figure-3.html#cb83-57" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="at">Subtype=</span>q12),</span>
<span id="cb83-58"><a href="figure-3.html#cb83-58" tabindex="-1"></a>  <span class="at">show_annotation_name =</span> <span class="fu">c</span>(T,T), </span>
<span id="cb83-59"><a href="figure-3.html#cb83-59" tabindex="-1"></a>  <span class="at">border =</span> <span class="fu">c</span>(T,T) ,</span>
<span id="cb83-60"><a href="figure-3.html#cb83-60" tabindex="-1"></a>  <span class="at">simple_anno_size =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>),<span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb83-61"><a href="figure-3.html#cb83-61" tabindex="-1"></a>)</span>
<span id="cb83-62"><a href="figure-3.html#cb83-62" tabindex="-1"></a></span>
<span id="cb83-63"><a href="figure-3.html#cb83-63" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb83-64"><a href="figure-3.html#cb83-64" tabindex="-1"></a></span>
<span id="cb83-65"><a href="figure-3.html#cb83-65" tabindex="-1"></a>p_cell <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(dat_scale,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">18</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">name=</span><span class="st">&quot;Our RNA-seq Data&quot;</span>,</span>
<span id="cb83-66"><a href="figure-3.html#cb83-66" tabindex="-1"></a>                  <span class="at">cluster_row_slices =</span> F,<span class="at">clustering_method_rows =</span> <span class="st">&quot;ward.D&quot;</span>,</span>
<span id="cb83-67"><a href="figure-3.html#cb83-67" tabindex="-1"></a>                  <span class="at">cluster_column_slices =</span> F,</span>
<span id="cb83-68"><a href="figure-3.html#cb83-68" tabindex="-1"></a>                  <span class="at">clustering_method_columns =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb83-69"><a href="figure-3.html#cb83-69" tabindex="-1"></a>                  <span class="at">column_split =</span> sample_info<span class="sc">$</span>Subtype,</span>
<span id="cb83-70"><a href="figure-3.html#cb83-70" tabindex="-1"></a>                  <span class="at">top_annotation =</span>top_annotation,</span>
<span id="cb83-71"><a href="figure-3.html#cb83-71" tabindex="-1"></a>                  <span class="at">col =</span> col_fun,</span>
<span id="cb83-72"><a href="figure-3.html#cb83-72" tabindex="-1"></a>                  <span class="at">show_column_names =</span> F,<span class="at">show_row_names =</span> F,</span>
<span id="cb83-73"><a href="figure-3.html#cb83-73" tabindex="-1"></a>                  <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">6</span>),<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">5</span>))</span>
<span id="cb83-74"><a href="figure-3.html#cb83-74" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure3/S4A_MGeneHeatmap.pdf&quot;</span>,<span class="at">width =</span> <span class="dv">15</span>,<span class="at">height =</span> <span class="dv">15</span>)</span>
<span id="cb83-75"><a href="figure-3.html#cb83-75" tabindex="-1"></a>p_cell</span>
<span id="cb83-76"><a href="figure-3.html#cb83-76" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure3/S4A.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="s4-b-correlation-within-bmmc-samples" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> (S4 B) Correlation Within BMMC Samples<a href="figure-3.html#s4-b-correlation-within-bmmc-samples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>correlation coefficient (R) plot among BMMC samples</strong>, calculated using metabolic genes expression data. The lower R value is considered as reflecting higher heterogeneity within a given sample pool, and the R of 0.8 is highlighted on the y-axis with a brown line. The median R of each box is 0.890, 0.922, and 0.921, respectively. Statistical significance was determined using Wilcoxon test. **** P &lt; 0.0001.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="figure-3.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb84-2"><a href="figure-3.html#cb84-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb84-3"><a href="figure-3.html#cb84-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb84-4"><a href="figure-3.html#cb84-4" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb84-5"><a href="figure-3.html#cb84-5" tabindex="-1"></a></span>
<span id="cb84-6"><a href="figure-3.html#cb84-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-7"><a href="figure-3.html#cb84-7" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb84-8"><a href="figure-3.html#cb84-8" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-9"><a href="figure-3.html#cb84-9" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-10"><a href="figure-3.html#cb84-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-11"><a href="figure-3.html#cb84-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb84-12"><a href="figure-3.html#cb84-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb84-13"><a href="figure-3.html#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="figure-3.html#cb84-14" tabindex="-1"></a>sample_b <span class="ot">&lt;-</span> sample_info <span class="sc">%&gt;%</span></span>
<span id="cb84-15"><a href="figure-3.html#cb84-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Lineage<span class="sc">==</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb84-16"><a href="figure-3.html#cb84-16" tabindex="-1"></a>sample_t <span class="ot">&lt;-</span> sample_info <span class="sc">%&gt;%</span></span>
<span id="cb84-17"><a href="figure-3.html#cb84-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Lineage<span class="sc">==</span><span class="st">&quot;T&quot;</span>)</span>
<span id="cb84-18"><a href="figure-3.html#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="figure-3.html#cb84-19" tabindex="-1"></a>gene_metabolite1 <span class="ot">&lt;-</span> gene_metabolite <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(dest_type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb84-20"><a href="figure-3.html#cb84-20" tabindex="-1"></a>gene2 <span class="ot">&lt;-</span> PathwayExtendData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb84-21"><a href="figure-3.html#cb84-21" tabindex="-1"></a>gene_filter <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(gene_metabolite1<span class="sc">$</span>gene,gene2<span class="sc">$</span>name))</span>
<span id="cb84-22"><a href="figure-3.html#cb84-22" tabindex="-1"></a></span>
<span id="cb84-23"><a href="figure-3.html#cb84-23" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;raw_data/20231113_RNA_ALL_VST_coding.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-24"><a href="figure-3.html#cb84-24" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-25"><a href="figure-3.html#cb84-25" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-26"><a href="figure-3.html#cb84-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">%in%</span> gene_filter) <span class="sc">%&gt;%</span></span>
<span id="cb84-27"><a href="figure-3.html#cb84-27" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-28"><a href="figure-3.html#cb84-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(sample_info<span class="sc">$</span>RNA_id_raw))</span>
<span id="cb84-29"><a href="figure-3.html#cb84-29" tabindex="-1"></a></span>
<span id="cb84-30"><a href="figure-3.html#cb84-30" tabindex="-1"></a>dat_b <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb84-31"><a href="figure-3.html#cb84-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_b<span class="sc">$</span>RNA_id_raw)</span>
<span id="cb84-32"><a href="figure-3.html#cb84-32" tabindex="-1"></a></span>
<span id="cb84-33"><a href="figure-3.html#cb84-33" tabindex="-1"></a>dat_t <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb84-34"><a href="figure-3.html#cb84-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_t<span class="sc">$</span>RNA_id_raw)</span>
<span id="cb84-35"><a href="figure-3.html#cb84-35" tabindex="-1"></a></span>
<span id="cb84-36"><a href="figure-3.html#cb84-36" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-37"><a href="figure-3.html#cb84-37" tabindex="-1"></a><span class="co">#  Step 2: Spearman</span></span>
<span id="cb84-38"><a href="figure-3.html#cb84-38" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-39"><a href="figure-3.html#cb84-39" tabindex="-1"></a>cor_b <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat_b,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-40"><a href="figure-3.html#cb84-40" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-41"><a href="figure-3.html#cb84-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Var1 <span class="sc">!=</span> Var2) <span class="sc">%&gt;%</span></span>
<span id="cb84-42"><a href="figure-3.html#cb84-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">as.character</span>(Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-43"><a href="figure-3.html#cb84-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var2=</span><span class="fu">as.character</span>(Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-44"><a href="figure-3.html#cb84-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample1=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var1,Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-45"><a href="figure-3.html#cb84-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample2=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var2,Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-46"><a href="figure-3.html#cb84-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample1,sample2,value) <span class="sc">%&gt;%</span></span>
<span id="cb84-47"><a href="figure-3.html#cb84-47" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-48"><a href="figure-3.html#cb84-48" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;BCP-ALL&quot;</span>)</span>
<span id="cb84-49"><a href="figure-3.html#cb84-49" tabindex="-1"></a></span>
<span id="cb84-50"><a href="figure-3.html#cb84-50" tabindex="-1"></a>cor_t <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat_t,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-51"><a href="figure-3.html#cb84-51" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-52"><a href="figure-3.html#cb84-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Var1 <span class="sc">!=</span> Var2) <span class="sc">%&gt;%</span></span>
<span id="cb84-53"><a href="figure-3.html#cb84-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">as.character</span>(Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-54"><a href="figure-3.html#cb84-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var2=</span><span class="fu">as.character</span>(Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-55"><a href="figure-3.html#cb84-55" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample1=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var1,Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-56"><a href="figure-3.html#cb84-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample2=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var2,Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-57"><a href="figure-3.html#cb84-57" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample1,sample2,value) <span class="sc">%&gt;%</span></span>
<span id="cb84-58"><a href="figure-3.html#cb84-58" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-59"><a href="figure-3.html#cb84-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;T-ALL&quot;</span>)</span>
<span id="cb84-60"><a href="figure-3.html#cb84-60" tabindex="-1"></a></span>
<span id="cb84-61"><a href="figure-3.html#cb84-61" tabindex="-1"></a>cor_all <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="at">x=</span>dat_b,<span class="at">y=</span>dat_t,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-62"><a href="figure-3.html#cb84-62" tabindex="-1"></a>  reshape2<span class="sc">::</span><span class="fu">melt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-63"><a href="figure-3.html#cb84-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">as.character</span>(Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-64"><a href="figure-3.html#cb84-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var2=</span><span class="fu">as.character</span>(Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-65"><a href="figure-3.html#cb84-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample1=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var1,Var2)) <span class="sc">%&gt;%</span></span>
<span id="cb84-66"><a href="figure-3.html#cb84-66" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">sample2=</span><span class="fu">ifelse</span>(Var1 <span class="sc">&gt;</span> Var2,Var2,Var1)) <span class="sc">%&gt;%</span></span>
<span id="cb84-67"><a href="figure-3.html#cb84-67" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample1,sample2,value) <span class="sc">%&gt;%</span></span>
<span id="cb84-68"><a href="figure-3.html#cb84-68" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-69"><a href="figure-3.html#cb84-69" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;ALL-BvsT&quot;</span>)</span>
<span id="cb84-70"><a href="figure-3.html#cb84-70" tabindex="-1"></a></span>
<span id="cb84-71"><a href="figure-3.html#cb84-71" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;b&quot;</span>)</span>
<span id="cb84-72"><a href="figure-3.html#cb84-72" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">median</span>(cor_b<span class="sc">$</span>value))</span>
<span id="cb84-73"><a href="figure-3.html#cb84-73" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb84-74"><a href="figure-3.html#cb84-74" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">median</span>(cor_t<span class="sc">$</span>value))</span>
<span id="cb84-75"><a href="figure-3.html#cb84-75" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;b-t&quot;</span>)</span>
<span id="cb84-76"><a href="figure-3.html#cb84-76" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">median</span>(cor_all<span class="sc">$</span>value))</span>
<span id="cb84-77"><a href="figure-3.html#cb84-77" tabindex="-1"></a></span>
<span id="cb84-78"><a href="figure-3.html#cb84-78" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cor_b,cor_t,cor_all)</span>
<span id="cb84-79"><a href="figure-3.html#cb84-79" tabindex="-1"></a></span>
<span id="cb84-80"><a href="figure-3.html#cb84-80" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="fu">c</span>(<span class="st">&quot;ALL-BvsT&quot;</span>, <span class="st">&quot;BCP-ALL&quot;</span>),</span>
<span id="cb84-81"><a href="figure-3.html#cb84-81" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;BCP-ALL&quot;</span>, <span class="st">&quot;T-ALL&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;ALL-BvsT&quot;</span>, <span class="st">&quot;T-ALL&quot;</span>) )</span>
<span id="cb84-82"><a href="figure-3.html#cb84-82" tabindex="-1"></a></span>
<span id="cb84-83"><a href="figure-3.html#cb84-83" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-84"><a href="figure-3.html#cb84-84" tabindex="-1"></a><span class="co">#  Step 3: Visualization</span></span>
<span id="cb84-85"><a href="figure-3.html#cb84-85" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb84-86"><a href="figure-3.html#cb84-86" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cor_result,<span class="fu">aes</span>(type,value))<span class="sc">+</span></span>
<span id="cb84-87"><a href="figure-3.html#cb84-87" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size=</span>.<span class="dv">3</span>,<span class="at">width=</span>.<span class="dv">2</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb84-88"><a href="figure-3.html#cb84-88" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">&quot;#D01910&quot;</span>,<span class="at">outlier.colour =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb84-89"><a href="figure-3.html#cb84-89" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> comparisons)<span class="sc">+</span></span>
<span id="cb84-90"><a href="figure-3.html#cb84-90" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb84-91"><a href="figure-3.html#cb84-91" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="fl">0.65</span>,<span class="fl">1.08</span>))<span class="sc">+</span></span>
<span id="cb84-92"><a href="figure-3.html#cb84-92" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="st">&quot;Correlation coefficient&quot;</span>,<span class="at">title=</span><span class="st">&quot;Meta gene&quot;</span>)</span>
<span id="cb84-93"><a href="figure-3.html#cb84-93" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure3/S4B_cor_boxplot.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">4</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure3/S4B.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="s4-c-correlation-of-mrna-expression-of-metabolic-genes" class="section level2 hasAnchor" number="18.8">
<h2><span class="header-section-number">18.8</span> (S4 C) Correlation of mRNA Expression of Metabolic Genes<a href="figure-3.html#s4-c-correlation-of-mrna-expression-of-metabolic-genes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(left panel) Correlation of metabolic gene expression with the abundance of paired metabolites. The median correlation coefficient is R=0.017. (middle panel) The abundance of adenosine is positively associated with NT5E that catalyzes the conversion of extracellular nucleotides to membrane-permeable nucleosides.<br />
(right panel) The abundance of NADH is negatively associated with NAXD that enables ATP-dependent NAD(P)H-hydrate dehydratase activity.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="figure-3.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb85-2"><a href="figure-3.html#cb85-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb85-3"><a href="figure-3.html#cb85-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb85-4"><a href="figure-3.html#cb85-4" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb85-5"><a href="figure-3.html#cb85-5" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb85-6"><a href="figure-3.html#cb85-6" tabindex="-1"></a></span>
<span id="cb85-7"><a href="figure-3.html#cb85-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb85-8"><a href="figure-3.html#cb85-8" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb85-9"><a href="figure-3.html#cb85-9" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb85-10"><a href="figure-3.html#cb85-10" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-11"><a href="figure-3.html#cb85-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-12"><a href="figure-3.html#cb85-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(METc_BM_D0_ID,RNA_id_raw) <span class="sc">%&gt;%</span></span>
<span id="cb85-13"><a href="figure-3.html#cb85-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb85-14"><a href="figure-3.html#cb85-14" tabindex="-1"></a></span>
<span id="cb85-15"><a href="figure-3.html#cb85-15" tabindex="-1"></a>kid <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/cell_metabolite_info_all_v1109.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-16"><a href="figure-3.html#cb85-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-17"><a href="figure-3.html#cb85-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(refmet_name,KEGG)</span>
<span id="cb85-18"><a href="figure-3.html#cb85-18" tabindex="-1"></a></span>
<span id="cb85-19"><a href="figure-3.html#cb85-19" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-20"><a href="figure-3.html#cb85-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-21"><a href="figure-3.html#cb85-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(label,sample_info<span class="sc">$</span>METc_BM_D0_ID) <span class="sc">%&gt;%</span></span>
<span id="cb85-22"><a href="figure-3.html#cb85-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;label&quot;</span><span class="ot">=</span><span class="st">&quot;refmet_name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb85-23"><a href="figure-3.html#cb85-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>label) <span class="sc">%&gt;%</span></span>
<span id="cb85-24"><a href="figure-3.html#cb85-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb85-25"><a href="figure-3.html#cb85-25" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;KEGG&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-26"><a href="figure-3.html#cb85-26" tabindex="-1"></a>  <span class="fu">log1p</span>()</span>
<span id="cb85-27"><a href="figure-3.html#cb85-27" tabindex="-1"></a></span>
<span id="cb85-28"><a href="figure-3.html#cb85-28" tabindex="-1"></a>gene_metabolite1 <span class="ot">&lt;-</span> gene_metabolite <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(dest_type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb85-29"><a href="figure-3.html#cb85-29" tabindex="-1"></a>gene_filter <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(gene_metabolite1<span class="sc">$</span>gene))</span>
<span id="cb85-30"><a href="figure-3.html#cb85-30" tabindex="-1"></a></span>
<span id="cb85-31"><a href="figure-3.html#cb85-31" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;raw_data/20231113_RNA_ALL_VST_coding.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-32"><a href="figure-3.html#cb85-32" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-33"><a href="figure-3.html#cb85-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_info<span class="sc">$</span>RNA_id_raw) <span class="sc">%&gt;%</span></span>
<span id="cb85-34"><a href="figure-3.html#cb85-34" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-35"><a href="figure-3.html#cb85-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">%in%</span> gene_filter) <span class="sc">%&gt;%</span></span>
<span id="cb85-36"><a href="figure-3.html#cb85-36" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>)</span>
<span id="cb85-37"><a href="figure-3.html#cb85-37" tabindex="-1"></a></span>
<span id="cb85-38"><a href="figure-3.html#cb85-38" tabindex="-1"></a>dat_gene_0 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dat_gene<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb85-39"><a href="figure-3.html#cb85-39" tabindex="-1"></a>dat_gene_filter <span class="ot">&lt;-</span> dat_gene <span class="sc">%&gt;%</span></span>
<span id="cb85-40"><a href="figure-3.html#cb85-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">num=</span>dat_gene_0) <span class="sc">%&gt;%</span></span>
<span id="cb85-41"><a href="figure-3.html#cb85-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(num <span class="sc">&lt;</span> <span class="fl">0.5</span><span class="sc">*</span><span class="fu">ncol</span>(dat_gene)) <span class="sc">%&gt;%</span></span>
<span id="cb85-42"><a href="figure-3.html#cb85-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>num)</span>
<span id="cb85-43"><a href="figure-3.html#cb85-43" tabindex="-1"></a></span>
<span id="cb85-44"><a href="figure-3.html#cb85-44" tabindex="-1"></a>dat_met_filter <span class="ot">&lt;-</span> dat_met <span class="sc">%&gt;%</span></span>
<span id="cb85-45"><a href="figure-3.html#cb85-45" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;keggId&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-46"><a href="figure-3.html#cb85-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(keggId <span class="sc">%in%</span> gene_metabolite<span class="sc">$</span>keggId) <span class="sc">%&gt;%</span></span>
<span id="cb85-47"><a href="figure-3.html#cb85-47" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;keggId&quot;</span>)</span>
<span id="cb85-48"><a href="figure-3.html#cb85-48" tabindex="-1"></a></span>
<span id="cb85-49"><a href="figure-3.html#cb85-49" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb85-50"><a href="figure-3.html#cb85-50" tabindex="-1"></a><span class="co">#  Step 2: Correlation analysis</span></span>
<span id="cb85-51"><a href="figure-3.html#cb85-51" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb85-52"><a href="figure-3.html#cb85-52" tabindex="-1"></a><span class="do">## Run in Linux  </span></span>
<span id="cb85-53"><a href="figure-3.html#cb85-53" tabindex="-1"></a><span class="co">#cor_result &lt;- data.frame()</span></span>
<span id="cb85-54"><a href="figure-3.html#cb85-54" tabindex="-1"></a><span class="co">#for (i in 1:nrow(dat_met_filter)) {</span></span>
<span id="cb85-55"><a href="figure-3.html#cb85-55" tabindex="-1"></a><span class="co">#  print(i)</span></span>
<span id="cb85-56"><a href="figure-3.html#cb85-56" tabindex="-1"></a><span class="co">#  for (j in 1:nrow(dat_gene_filter)) {</span></span>
<span id="cb85-57"><a href="figure-3.html#cb85-57" tabindex="-1"></a><span class="co">#    dd &lt;- gene_metabolite %&gt;%</span></span>
<span id="cb85-58"><a href="figure-3.html#cb85-58" tabindex="-1"></a><span class="co">#      dplyr::filter(keggId == rownames(dat_met_filter)[i]) %&gt;%</span></span>
<span id="cb85-59"><a href="figure-3.html#cb85-59" tabindex="-1"></a><span class="co">#      dplyr::filter(gene == rownames(dat_gene_filter)[j])</span></span>
<span id="cb85-60"><a href="figure-3.html#cb85-60" tabindex="-1"></a><span class="co">#    if (nrow(dd)&gt;0) {</span></span>
<span id="cb85-61"><a href="figure-3.html#cb85-61" tabindex="-1"></a><span class="co">#      cor_temp &lt;- cor.test(as.numeric(dat_met_filter[i,]),as.numeric(dat_gene_filter[j,]),method =  &quot;spearman&quot;)</span></span>
<span id="cb85-62"><a href="figure-3.html#cb85-62" tabindex="-1"></a><span class="co">#      cor_temp1 &lt;- data.frame(keggId=rownames(dat_met_filter)[i],gene=rownames(dat_gene_filter)[j],cor=cor_temp$estimate)</span></span>
<span id="cb85-63"><a href="figure-3.html#cb85-63" tabindex="-1"></a><span class="co">#      cor_result &lt;- rbind(cor_result,cor_temp1)</span></span>
<span id="cb85-64"><a href="figure-3.html#cb85-64" tabindex="-1"></a><span class="co">#    }</span></span>
<span id="cb85-65"><a href="figure-3.html#cb85-65" tabindex="-1"></a><span class="co">#  }</span></span>
<span id="cb85-66"><a href="figure-3.html#cb85-66" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb85-67"><a href="figure-3.html#cb85-67" tabindex="-1"></a></span>
<span id="cb85-68"><a href="figure-3.html#cb85-68" tabindex="-1"></a><span class="co">#write.table(cor_result,&quot;result/Figure3/S4C_cor_spearman.txt&quot;,quote=F,row.names=F,sep=&quot;\t&quot;)</span></span>
<span id="cb85-69"><a href="figure-3.html#cb85-69" tabindex="-1"></a></span>
<span id="cb85-70"><a href="figure-3.html#cb85-70" tabindex="-1"></a>cor_result <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure3/S4C_cor_spearman.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-71"><a href="figure-3.html#cb85-71" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb85-72"><a href="figure-3.html#cb85-72" tabindex="-1"></a></span>
<span id="cb85-73"><a href="figure-3.html#cb85-73" tabindex="-1"></a>md <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">median</span>(cor_result<span class="sc">$</span>cor),<span class="dv">3</span>)</span>
<span id="cb85-74"><a href="figure-3.html#cb85-74" tabindex="-1"></a><span class="fu">print</span>(md)</span>
<span id="cb85-75"><a href="figure-3.html#cb85-75" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(cor_result, <span class="at">x =</span> <span class="st">&quot;cor&quot;</span>, <span class="at">y =</span> <span class="st">&quot;..density..&quot;</span>,</span>
<span id="cb85-76"><a href="figure-3.html#cb85-76" tabindex="-1"></a>                         <span class="at">add =</span> <span class="st">&quot;median&quot;</span>, <span class="at">rug =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-77"><a href="figure-3.html#cb85-77" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">&quot;Correlation coefficient&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;density&quot;</span>,</span>
<span id="cb85-78"><a href="figure-3.html#cb85-78" tabindex="-1"></a>                         <span class="at">color =</span> <span class="st">&quot;#CE0000&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#CE0000&quot;</span>, </span>
<span id="cb85-79"><a href="figure-3.html#cb85-79" tabindex="-1"></a>                         <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Correlation in gene &amp; metabolite (median= &quot;</span>,md,<span class="st">&quot;)&quot;</span>),</span>
<span id="cb85-80"><a href="figure-3.html#cb85-80" tabindex="-1"></a>                         <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">add_density =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb85-81"><a href="figure-3.html#cb85-81" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb85-82"><a href="figure-3.html#cb85-82" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure3/S4C_cor_spearman.pdf&quot;</span>,p,<span class="at">width=</span><span class="fl">5.2</span>,<span class="at">height =</span> <span class="fl">4.5</span>)</span>
<span id="cb85-83"><a href="figure-3.html#cb85-83" tabindex="-1"></a></span>
<span id="cb85-84"><a href="figure-3.html#cb85-84" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb85-85"><a href="figure-3.html#cb85-85" tabindex="-1"></a><span class="co">#  Step 3: Pearson</span></span>
<span id="cb85-86"><a href="figure-3.html#cb85-86" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb85-87"><a href="figure-3.html#cb85-87" tabindex="-1"></a><span class="do">## Load data</span></span>
<span id="cb85-88"><a href="figure-3.html#cb85-88" tabindex="-1"></a>sample_info <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-89"><a href="figure-3.html#cb85-89" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-90"><a href="figure-3.html#cb85-90" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(METc_BM_D0_ID,RNA_id_raw,Pid) <span class="sc">%&gt;%</span></span>
<span id="cb85-91"><a href="figure-3.html#cb85-91" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(RNA_id_raw))</span>
<span id="cb85-92"><a href="figure-3.html#cb85-92" tabindex="-1"></a></span>
<span id="cb85-93"><a href="figure-3.html#cb85-93" tabindex="-1"></a>dat_met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-94"><a href="figure-3.html#cb85-94" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-95"><a href="figure-3.html#cb85-95" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-96"><a href="figure-3.html#cb85-96" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_info<span class="sc">$</span>METc_BM_D0_ID) <span class="sc">%&gt;%</span></span>
<span id="cb85-97"><a href="figure-3.html#cb85-97" tabindex="-1"></a>  <span class="fu">log1p</span>()</span>
<span id="cb85-98"><a href="figure-3.html#cb85-98" tabindex="-1"></a><span class="fu">names</span>(dat_met) <span class="ot">&lt;-</span> sample_info<span class="sc">$</span>Pid</span>
<span id="cb85-99"><a href="figure-3.html#cb85-99" tabindex="-1"></a></span>
<span id="cb85-100"><a href="figure-3.html#cb85-100" tabindex="-1"></a>gene_metabolite1 <span class="ot">&lt;-</span> gene_metabolite <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(dest_type<span class="sc">==</span><span class="st">&quot;gene&quot;</span>)</span>
<span id="cb85-101"><a href="figure-3.html#cb85-101" tabindex="-1"></a>gene_filter <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(gene_metabolite1<span class="sc">$</span>gene))</span>
<span id="cb85-102"><a href="figure-3.html#cb85-102" tabindex="-1"></a></span>
<span id="cb85-103"><a href="figure-3.html#cb85-103" tabindex="-1"></a>dat_gene <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;raw_data/20231113_RNA_ALL_VST_coding.rds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-104"><a href="figure-3.html#cb85-104" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-105"><a href="figure-3.html#cb85-105" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_info<span class="sc">$</span>RNA_id_raw) <span class="sc">%&gt;%</span></span>
<span id="cb85-106"><a href="figure-3.html#cb85-106" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-107"><a href="figure-3.html#cb85-107" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">%in%</span> gene_filter) <span class="sc">%&gt;%</span></span>
<span id="cb85-108"><a href="figure-3.html#cb85-108" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>)</span>
<span id="cb85-109"><a href="figure-3.html#cb85-109" tabindex="-1"></a><span class="fu">names</span>(dat_gene) <span class="ot">&lt;-</span> sample_info<span class="sc">$</span>Pid</span>
<span id="cb85-110"><a href="figure-3.html#cb85-110" tabindex="-1"></a></span>
<span id="cb85-111"><a href="figure-3.html#cb85-111" tabindex="-1"></a>metabolites <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Adenosine&quot;</span>)</span>
<span id="cb85-112"><a href="figure-3.html#cb85-112" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NT5E&quot;</span>)</span>
<span id="cb85-113"><a href="figure-3.html#cb85-113" tabindex="-1"></a></span>
<span id="cb85-114"><a href="figure-3.html#cb85-114" tabindex="-1"></a><span class="do">## cor_Adenosine_NT5E</span></span>
<span id="cb85-115"><a href="figure-3.html#cb85-115" tabindex="-1"></a><span class="cf">for</span> (metabolite <span class="cf">in</span> metabolites) {</span>
<span id="cb85-116"><a href="figure-3.html#cb85-116" tabindex="-1"></a>  <span class="cf">for</span> (gene <span class="cf">in</span> genes) {</span>
<span id="cb85-117"><a href="figure-3.html#cb85-117" tabindex="-1"></a>    dat_melt_filter <span class="ot">&lt;-</span> dat_met <span class="sc">%&gt;%</span></span>
<span id="cb85-118"><a href="figure-3.html#cb85-118" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-119"><a href="figure-3.html#cb85-119" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">==</span> metabolite) <span class="sc">%&gt;%</span></span>
<span id="cb85-120"><a href="figure-3.html#cb85-120" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>)</span>
<span id="cb85-121"><a href="figure-3.html#cb85-121" tabindex="-1"></a>    </span>
<span id="cb85-122"><a href="figure-3.html#cb85-122" tabindex="-1"></a>    dat_gene_filter <span class="ot">&lt;-</span> dat_gene <span class="sc">%&gt;%</span></span>
<span id="cb85-123"><a href="figure-3.html#cb85-123" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-124"><a href="figure-3.html#cb85-124" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(gene<span class="sc">==</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb85-125"><a href="figure-3.html#cb85-125" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;gene&quot;</span>)</span>
<span id="cb85-126"><a href="figure-3.html#cb85-126" tabindex="-1"></a>    </span>
<span id="cb85-127"><a href="figure-3.html#cb85-127" tabindex="-1"></a>    dat_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_melt_filter,dat_gene_filter) <span class="sc">%&gt;%</span></span>
<span id="cb85-128"><a href="figure-3.html#cb85-128" tabindex="-1"></a>      <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-129"><a href="figure-3.html#cb85-129" tabindex="-1"></a>      <span class="fu">as.data.frame</span>()</span>
<span id="cb85-130"><a href="figure-3.html#cb85-130" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(dat_filter,<span class="at">x=</span>metabolite,<span class="at">y=</span>gene,</span>
<span id="cb85-131"><a href="figure-3.html#cb85-131" tabindex="-1"></a>                   <span class="at">add=</span><span class="st">&quot;reg.line&quot;</span>,<span class="at">conf.int=</span><span class="cn">TRUE</span>,<span class="at">cor.coef=</span><span class="cn">TRUE</span>,<span class="at">cor.method=</span><span class="st">&quot;pearso&quot;</span>)</span>
<span id="cb85-132"><a href="figure-3.html#cb85-132" tabindex="-1"></a>    </span>
<span id="cb85-133"><a href="figure-3.html#cb85-133" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;result/Figure3/S4C_&quot;</span>,metabolite,<span class="st">&quot;_&quot;</span>,gene,<span class="st">&quot;.pdf&quot;</span>),p,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb85-134"><a href="figure-3.html#cb85-134" tabindex="-1"></a>  }</span>
<span id="cb85-135"><a href="figure-3.html#cb85-135" tabindex="-1"></a>}</span>
<span id="cb85-136"><a href="figure-3.html#cb85-136" tabindex="-1"></a></span>
<span id="cb85-137"><a href="figure-3.html#cb85-137" tabindex="-1"></a><span class="do">## cor_NADH_NAXD</span></span>
<span id="cb85-138"><a href="figure-3.html#cb85-138" tabindex="-1"></a>metabolites <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NADH&quot;</span>)</span>
<span id="cb85-139"><a href="figure-3.html#cb85-139" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;NAXD&quot;</span>)</span>
<span id="cb85-140"><a href="figure-3.html#cb85-140" tabindex="-1"></a></span>
<span id="cb85-141"><a href="figure-3.html#cb85-141" tabindex="-1"></a><span class="cf">for</span> (metabolite <span class="cf">in</span> metabolites) {</span>
<span id="cb85-142"><a href="figure-3.html#cb85-142" tabindex="-1"></a>  <span class="cf">for</span> (gene <span class="cf">in</span> genes) {</span>
<span id="cb85-143"><a href="figure-3.html#cb85-143" tabindex="-1"></a>    dat_melt_filter <span class="ot">&lt;-</span> dat_met <span class="sc">%&gt;%</span></span>
<span id="cb85-144"><a href="figure-3.html#cb85-144" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-145"><a href="figure-3.html#cb85-145" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">==</span> metabolite) <span class="sc">%&gt;%</span></span>
<span id="cb85-146"><a href="figure-3.html#cb85-146" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>)</span>
<span id="cb85-147"><a href="figure-3.html#cb85-147" tabindex="-1"></a>    </span>
<span id="cb85-148"><a href="figure-3.html#cb85-148" tabindex="-1"></a>    dat_gene_filter <span class="ot">&lt;-</span> dat_gene <span class="sc">%&gt;%</span></span>
<span id="cb85-149"><a href="figure-3.html#cb85-149" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;gene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-150"><a href="figure-3.html#cb85-150" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(gene<span class="sc">==</span>gene) <span class="sc">%&gt;%</span></span>
<span id="cb85-151"><a href="figure-3.html#cb85-151" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;gene&quot;</span>)</span>
<span id="cb85-152"><a href="figure-3.html#cb85-152" tabindex="-1"></a>    </span>
<span id="cb85-153"><a href="figure-3.html#cb85-153" tabindex="-1"></a>    dat_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_melt_filter,dat_gene_filter) <span class="sc">%&gt;%</span></span>
<span id="cb85-154"><a href="figure-3.html#cb85-154" tabindex="-1"></a>      <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-155"><a href="figure-3.html#cb85-155" tabindex="-1"></a>      <span class="fu">as.data.frame</span>()</span>
<span id="cb85-156"><a href="figure-3.html#cb85-156" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(dat_filter,<span class="at">x=</span>metabolite,<span class="at">y=</span>gene,</span>
<span id="cb85-157"><a href="figure-3.html#cb85-157" tabindex="-1"></a>                   <span class="at">add=</span><span class="st">&quot;reg.line&quot;</span>,<span class="at">conf.int=</span><span class="cn">TRUE</span>,<span class="at">cor.coef=</span><span class="cn">TRUE</span>,<span class="at">cor.method=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb85-158"><a href="figure-3.html#cb85-158" tabindex="-1"></a>    </span>
<span id="cb85-159"><a href="figure-3.html#cb85-159" tabindex="-1"></a>    <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;result/Figure3/S4C_&quot;</span>,metabolite,<span class="st">&quot;_&quot;</span>,gene,<span class="st">&quot;.pdf&quot;</span>),p,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb85-160"><a href="figure-3.html#cb85-160" tabindex="-1"></a>  }</span>
<span id="cb85-161"><a href="figure-3.html#cb85-161" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Figure-1025/Figure3/S4C.png" width="1089" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="figure-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="figure-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/17-Figure3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
