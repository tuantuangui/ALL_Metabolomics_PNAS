<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Figure 1 | ALL metabolism analysis</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Figure 1 | ALL metabolism analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Figure 1 | ALL metabolism analysis" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Tuantuan Gui" />


<meta name="date" content="2024-12-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cell-rsd.html"/>
<link rel="next" href="figure-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ALL Metabolimics PNAS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> the ALL metabolism analysis</a></li>
<li class="chapter" data-level="2" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html"><i class="fa fa-check"></i><b>2</b> serum: 2020 data preprocess</a>
<ul>
<li class="chapter" data-level="2.1" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html#positive"><i class="fa fa-check"></i><b>2.1</b> positive</a></li>
<li class="chapter" data-level="2.2" data-path="serum-2020-data-preprocess.html"><a href="serum-2020-data-preprocess.html#negative"><i class="fa fa-check"></i><b>2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html"><i class="fa fa-check"></i><b>3</b> serum: 2021 data preprocess</a>
<ul>
<li class="chapter" data-level="3.1" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html#positive-1"><i class="fa fa-check"></i><b>3.1</b> positive</a></li>
<li class="chapter" data-level="3.2" data-path="serum-2021-data-preprocess.html"><a href="serum-2021-data-preprocess.html#negative-1"><i class="fa fa-check"></i><b>3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html"><i class="fa fa-check"></i><b>4</b> serum: metID data anatation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html#serum-2020"><i class="fa fa-check"></i><b>4.1</b> serum 2020</a></li>
<li class="chapter" data-level="4.2" data-path="serum-metid-data-anatation.html"><a href="serum-metid-data-anatation.html#serum-2021"><i class="fa fa-check"></i><b>4.2</b> serum 2021</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="serum-combine-data-from-ab-metid-and-metdna-of-serum-2020-and-serum-2021.html"><a href="serum-combine-data-from-ab-metid-and-metdna-of-serum-2020-and-serum-2021.html"><i class="fa fa-check"></i><b>5</b> serum: combine data from AB, metID and metDNA of serum 2020 and serum 2021</a></li>
<li class="chapter" data-level="6" data-path="serum-combine-data-from-positive-and-negative.html"><a href="serum-combine-data-from-positive-and-negative.html"><i class="fa fa-check"></i><b>6</b> serum: combine data from positive and negative</a></li>
<li class="chapter" data-level="7" data-path="serum-batch-effection-of-data-from-serum-2020-and-serum-2021-using-sva.html"><a href="serum-batch-effection-of-data-from-serum-2020-and-serum-2021-using-sva.html"><i class="fa fa-check"></i><b>7</b> serum: batch effection of data from serum 2020 and serum 2021 using sva</a></li>
<li class="chapter" data-level="8" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html"><i class="fa fa-check"></i><b>8</b> Cell: AB data process</a>
<ul>
<li class="chapter" data-level="8.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-the-metabolites-too-much-na-and-impute-the-na"><i class="fa fa-check"></i><b>8.1</b> filter the metabolites (too much NA) and impute the NA</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-2"><i class="fa fa-check"></i><b>8.1.1</b> positive</a></li>
<li class="chapter" data-level="8.1.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-2"><i class="fa fa-check"></i><b>8.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#transform-the-metabolite-name-to-refmet-name"><i class="fa fa-check"></i><b>8.2</b> transform the metabolite name to refmet name</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-3"><i class="fa fa-check"></i><b>8.2.1</b> positive</a></li>
<li class="chapter" data-level="8.2.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-3"><i class="fa fa-check"></i><b>8.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-the-metabolite-based-on-the-library-hit"><i class="fa fa-check"></i><b>8.3</b> filter the metabolite based on the library hit</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#positive-4"><i class="fa fa-check"></i><b>8.3.1</b> positive</a></li>
<li class="chapter" data-level="8.3.2" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#negative-4"><i class="fa fa-check"></i><b>8.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="cell-ab-data-process.html"><a href="cell-ab-data-process.html#filter-metabolite-by-manual-check"><i class="fa fa-check"></i><b>8.4</b> filter metabolite by manual check</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cell-annotation.html"><a href="cell-annotation.html"><i class="fa fa-check"></i><b>9</b> Cell: annotation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cell-annotation.html"><a href="cell-annotation.html#metid"><i class="fa fa-check"></i><b>9.1</b> metID</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-5"><i class="fa fa-check"></i><b>9.1.1</b> positive</a></li>
<li class="chapter" data-level="9.1.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-5"><i class="fa fa-check"></i><b>9.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="cell-annotation.html"><a href="cell-annotation.html#metdna"><i class="fa fa-check"></i><b>9.2</b> metDNA</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-6"><i class="fa fa-check"></i><b>9.2.1</b> positive</a></li>
<li class="chapter" data-level="9.2.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-6"><i class="fa fa-check"></i><b>9.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="cell-annotation.html"><a href="cell-annotation.html#combine-the-data-from-metid-and-metdna"><i class="fa fa-check"></i><b>9.3</b> combine the data from metID and metDNA</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-7"><i class="fa fa-check"></i><b>9.3.1</b> positive</a></li>
<li class="chapter" data-level="9.3.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-7"><i class="fa fa-check"></i><b>9.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="cell-annotation.html"><a href="cell-annotation.html#transform-metabolite-name-to-refmet-name"><i class="fa fa-check"></i><b>9.4</b> transform metabolite name to refmet name</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="cell-annotation.html"><a href="cell-annotation.html#positive-8"><i class="fa fa-check"></i><b>9.4.1</b> positive</a></li>
<li class="chapter" data-level="9.4.2" data-path="cell-annotation.html"><a href="cell-annotation.html#negative-8"><i class="fa fa-check"></i><b>9.4.2</b> negative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html"><i class="fa fa-check"></i><b>10</b> Cell: combine the data from AB and xcms</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#combine-the-data-from-ab-and-xcms"><i class="fa fa-check"></i><b>10.1</b> combine the data from AB and xcms</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#positive-9"><i class="fa fa-check"></i><b>10.1.1</b> positive</a></li>
<li class="chapter" data-level="10.1.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#negative-9"><i class="fa fa-check"></i><b>10.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#transform-the-format-to-serrf"><i class="fa fa-check"></i><b>10.2</b> transform the format to serrf</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#positive-10"><i class="fa fa-check"></i><b>10.2.1</b> positive</a></li>
<li class="chapter" data-level="10.2.2" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#negative-10"><i class="fa fa-check"></i><b>10.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cell-combine-the-data-from-ab-and-xcms.html"><a href="cell-combine-the-data-from-ab-and-xcms.html#rsd"><i class="fa fa-check"></i><b>10.3</b> RSD</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cell-combine-positive.html"><a href="cell-combine-positive.html"><i class="fa fa-check"></i><b>11</b> Cell: combine positive</a></li>
<li class="chapter" data-level="12" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html"><i class="fa fa-check"></i><b>12</b> Cell: metabolite info</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#ab"><i class="fa fa-check"></i><b>12.1</b> AB</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-11"><i class="fa fa-check"></i><b>12.1.1</b> positive</a></li>
<li class="chapter" data-level="12.1.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-11"><i class="fa fa-check"></i><b>12.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#metid-1"><i class="fa fa-check"></i><b>12.2</b> metID</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-12"><i class="fa fa-check"></i><b>12.2.1</b> positive</a></li>
<li class="chapter" data-level="12.2.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-12"><i class="fa fa-check"></i><b>12.2.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#metdna-1"><i class="fa fa-check"></i><b>12.3</b> metDNA</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#positive-13"><i class="fa fa-check"></i><b>12.3.1</b> positive</a></li>
<li class="chapter" data-level="12.3.2" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#negative-13"><i class="fa fa-check"></i><b>12.3.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#combine-the-data-from-abmetid-and-metdna"><i class="fa fa-check"></i><b>12.4</b> combine the data from AB,metID and metDNA</a></li>
<li class="chapter" data-level="12.5" data-path="cell-metabolite-info.html"><a href="cell-metabolite-info.html#compare-with-the-local-cas-id"><i class="fa fa-check"></i><b>12.5</b> compare with the local CAS ID</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cell-qc.html"><a href="cell-qc.html"><i class="fa fa-check"></i><b>13</b> Cell: QC</a>
<ul>
<li class="chapter" data-level="13.1" data-path="cell-qc.html"><a href="cell-qc.html#pca"><i class="fa fa-check"></i><b>13.1</b> PCA</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="cell-qc.html"><a href="cell-qc.html#positive-14"><i class="fa fa-check"></i><b>13.1.1</b> positive</a></li>
<li class="chapter" data-level="13.1.2" data-path="cell-qc.html"><a href="cell-qc.html#negative-14"><i class="fa fa-check"></i><b>13.1.2</b> negative</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="cell-qc.html"><a href="cell-qc.html#the-distribution-of-every-metabolite"><i class="fa fa-check"></i><b>13.2</b> the distribution of every metabolite</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="cell-qc.html"><a href="cell-qc.html#positive-15"><i class="fa fa-check"></i><b>13.2.1</b> positive</a></li>
<li class="chapter" data-level="13.2.2" data-path="cell-qc.html"><a href="cell-qc.html#negative-15"><i class="fa fa-check"></i><b>13.2.2</b> negative</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html"><i class="fa fa-check"></i><b>14</b> Cell: filter metabolites and samples</a>
<ul>
<li class="chapter" data-level="14.1" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-out-c053"><i class="fa fa-check"></i><b>14.1</b> filter out C053</a></li>
<li class="chapter" data-level="14.2" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-compound"><i class="fa fa-check"></i><b>14.2</b> filter compound</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="cell-filter-metabolites-and-samples.html"><a href="cell-filter-metabolites-and-samples.html#filter-compound-in-2023.11.08"><i class="fa fa-check"></i><b>14.2.1</b> filter compound in 2023.11.08</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="cell-rsd.html"><a href="cell-rsd.html"><i class="fa fa-check"></i><b>15</b> Cell: RSD</a>
<ul>
<li class="chapter" data-level="15.1" data-path="cell-rsd.html"><a href="cell-rsd.html#after"><i class="fa fa-check"></i><b>15.1</b> after</a></li>
<li class="chapter" data-level="15.2" data-path="cell-rsd.html"><a href="cell-rsd.html#rsd-1"><i class="fa fa-check"></i><b>15.2</b> RSD</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="figure-1.html"><a href="figure-1.html"><i class="fa fa-check"></i><b>16</b> Figure 1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="figure-1.html"><a href="figure-1.html#b-annotated-metabolites"><i class="fa fa-check"></i><b>16.1</b> (B) Annotated metabolites</a></li>
<li class="chapter" data-level="16.2" data-path="figure-1.html"><a href="figure-1.html#c-comprehensive-metabolome-overview"><i class="fa fa-check"></i><b>16.2</b> (C) Comprehensive metabolome overview</a></li>
<li class="chapter" data-level="16.3" data-path="figure-1.html"><a href="figure-1.html#s1-a-clinical-characteristics"><i class="fa fa-check"></i><b>16.3</b> (S1 A) Clinical characteristics</a></li>
<li class="chapter" data-level="16.4" data-path="figure-1.html"><a href="figure-1.html#s1-b-venn-plot"><i class="fa fa-check"></i><b>16.4</b> (S1 B) Venn plot</a></li>
<li class="chapter" data-level="16.5" data-path="figure-1.html"><a href="figure-1.html#s1-c-waterfall-plot"><i class="fa fa-check"></i><b>16.5</b> (S1 C) Waterfall plot</a></li>
<li class="chapter" data-level="16.6" data-path="figure-1.html"><a href="figure-1.html#s1-d-scatter-plot"><i class="fa fa-check"></i><b>16.6</b> (S1 D) Scatter plot</a></li>
<li class="chapter" data-level="16.7" data-path="figure-1.html"><a href="figure-1.html#s2-a-pca"><i class="fa fa-check"></i><b>16.7</b> (S2 A) PCA</a></li>
<li class="chapter" data-level="16.8" data-path="figure-1.html"><a href="figure-1.html#s2-b-volcano-plot"><i class="fa fa-check"></i><b>16.8</b> (S2 B) Volcano Plot</a></li>
<li class="chapter" data-level="16.9" data-path="figure-1.html"><a href="figure-1.html#s2-c-msea"><i class="fa fa-check"></i><b>16.9</b> (S2 C) MSEA</a></li>
<li class="chapter" data-level="16.10" data-path="figure-1.html"><a href="figure-1.html#s2-d-ageing-related-metabolites"><i class="fa fa-check"></i><b>16.10</b> (S2 D) Ageing-related metabolites</a></li>
<li class="chapter" data-level="16.11" data-path="figure-1.html"><a href="figure-1.html#s2-e-box-plot"><i class="fa fa-check"></i><b>16.11</b> (S2 E) Box plot</a></li>
<li class="chapter" data-level="16.12" data-path="figure-1.html"><a href="figure-1.html#s2-f-overall-survival-analysis"><i class="fa fa-check"></i><b>16.12</b> (S2 F) Overall Survival analysis</a></li>
<li class="chapter" data-level="16.13" data-path="figure-1.html"><a href="figure-1.html#s2-g-box-plot"><i class="fa fa-check"></i><b>16.13</b> (S2 G) Box plot</a></li>
<li class="chapter" data-level="16.14" data-path="figure-1.html"><a href="figure-1.html#s2-h-metabolism-set-enrichment-analysis"><i class="fa fa-check"></i><b>16.14</b> (S2 H) Metabolism Set Enrichment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="figure-2.html"><a href="figure-2.html"><i class="fa fa-check"></i><b>17</b> Figure 2</a>
<ul>
<li class="chapter" data-level="17.1" data-path="figure-2.html"><a href="figure-2.html#a-3d-pca"><i class="fa fa-check"></i><b>17.1</b> (A) 3D PCA</a></li>
<li class="chapter" data-level="17.2" data-path="figure-2.html"><a href="figure-2.html#b-all-vs-hc"><i class="fa fa-check"></i><b>17.2</b> (B) ALL vs HC</a></li>
<li class="chapter" data-level="17.3" data-path="figure-2.html"><a href="figure-2.html#c-intracellular-metabolome-landscape"><i class="fa fa-check"></i><b>17.3</b> (C) Intracellular Metabolome Landscape</a></li>
<li class="chapter" data-level="17.4" data-path="figure-2.html"><a href="figure-2.html#e-bcp-all-vs-t-all"><i class="fa fa-check"></i><b>17.4</b> (E) BCP-ALL vs T-ALL</a></li>
<li class="chapter" data-level="17.5" data-path="figure-2.html"><a href="figure-2.html#s3-a-correlation-within-bmmc-samples"><i class="fa fa-check"></i><b>17.5</b> (S3 A) Correlation Within BMMC Samples</a></li>
<li class="chapter" data-level="17.6" data-path="figure-2.html"><a href="figure-2.html#s3-b-correlation-between-hc-pmmc-and-all-bmmc-mrd-"><i class="fa fa-check"></i><b>17.6</b> (S3 B) Correlation Between HC PMMC And ALL BMMC MRD-</a></li>
<li class="chapter" data-level="17.7" data-path="figure-2.html"><a href="figure-2.html#s3-c-correlation-between-bmmc-and-pbmc"><i class="fa fa-check"></i><b>17.7</b> (S3 C) Correlation Between BMMC And PBMC</a></li>
<li class="chapter" data-level="17.8" data-path="figure-2.html"><a href="figure-2.html#s3-d-differential-analyses"><i class="fa fa-check"></i><b>17.8</b> (S3 D) Differential Analyses</a></li>
<li class="chapter" data-level="17.9" data-path="figure-2.html"><a href="figure-2.html#s3-e-volcano-plot-of-bmmc-d0-vs.-mrd-"><i class="fa fa-check"></i><b>17.9</b> (S3 E) Volcano Plot of BMMC-D0 vs. MRD-</a></li>
<li class="chapter" data-level="17.10" data-path="figure-2.html"><a href="figure-2.html#s3-f-abundance-boxplot"><i class="fa fa-check"></i><b>17.10</b> (S3 F) Abundance Boxplot</a></li>
<li class="chapter" data-level="17.11" data-path="figure-2.html"><a href="figure-2.html#s3-g-wgcna"><i class="fa fa-check"></i><b>17.11</b> (S3 G) WGCNA</a></li>
<li class="chapter" data-level="17.12" data-path="figure-2.html"><a href="figure-2.html#s3-h-bar-plot"><i class="fa fa-check"></i><b>17.12</b> (S3 H) bar plot</a></li>
<li class="chapter" data-level="17.13" data-path="figure-2.html"><a href="figure-2.html#s3-i-venn-diagram"><i class="fa fa-check"></i><b>17.13</b> (S3 I) Venn Diagram</a></li>
<li class="chapter" data-level="17.14" data-path="figure-2.html"><a href="figure-2.html#s3-j-boxplot"><i class="fa fa-check"></i><b>17.14</b> (S3 J) Boxplot</a></li>
<li class="chapter" data-level="17.15" data-path="figure-2.html"><a href="figure-2.html#s3-k-pathway-based-analysis"><i class="fa fa-check"></i><b>17.15</b> (S3 K) Pathway-based Analysis</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="figure-3.html"><a href="figure-3.html"><i class="fa fa-check"></i><b>18</b> Figure 3</a>
<ul>
<li class="chapter" data-level="18.1" data-path="figure-3.html"><a href="figure-3.html#a-gsva-scores-for-metabolic-pathways"><i class="fa fa-check"></i><b>18.1</b> (A) GSVA Scores for Metabolic Pathways</a></li>
<li class="chapter" data-level="18.2" data-path="figure-3.html"><a href="figure-3.html#b-mutations-and-metabolites"><i class="fa fa-check"></i><b>18.2</b> (B) Mutations and Metabolites</a></li>
<li class="chapter" data-level="18.3" data-path="figure-3.html"><a href="figure-3.html#c-idh12-and-etv6-mutations"><i class="fa fa-check"></i><b>18.3</b> (C) IDH1/2 and ETV6 Mutations</a></li>
<li class="chapter" data-level="18.4" data-path="figure-3.html"><a href="figure-3.html#d-fusions-and-metabolites"><i class="fa fa-check"></i><b>18.4</b> (D) Fusions and Metabolites</a></li>
<li class="chapter" data-level="18.5" data-path="figure-3.html"><a href="figure-3.html#e-bcr-abl1-fusion"><i class="fa fa-check"></i><b>18.5</b> (E) BCR-ABL1 Fusion</a></li>
<li class="chapter" data-level="18.6" data-path="figure-3.html"><a href="figure-3.html#s4-a-metabolic-gene-heatmap"><i class="fa fa-check"></i><b>18.6</b> (S4 A) Metabolic Gene Heatmap</a></li>
<li class="chapter" data-level="18.7" data-path="figure-3.html"><a href="figure-3.html#s4-b-correlation-within-bmmc-samples"><i class="fa fa-check"></i><b>18.7</b> (S4 B) Correlation Within BMMC Samples</a></li>
<li class="chapter" data-level="18.8" data-path="figure-3.html"><a href="figure-3.html#s4-c-correlation-of-mrna-expression-of-metabolic-genes"><i class="fa fa-check"></i><b>18.8</b> (S4 C) Correlation of mRNA Expression of Metabolic Genes</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="figure-4.html"><a href="figure-4.html"><i class="fa fa-check"></i><b>19</b> Figure 4</a>
<ul>
<li class="chapter" data-level="19.1" data-path="figure-4.html"><a href="figure-4.html#a-schematic-workflow"><i class="fa fa-check"></i><b>19.1</b> (A) Schematic Workflow</a></li>
<li class="chapter" data-level="19.2" data-path="figure-4.html"><a href="figure-4.html#b-discrimination-of-bcp-all-clusters"><i class="fa fa-check"></i><b>19.2</b> (B) Discrimination of BCP-ALL Clusters</a></li>
<li class="chapter" data-level="19.3" data-path="figure-4.html"><a href="figure-4.html#c-os-in-75-bcp-all-patients"><i class="fa fa-check"></i><b>19.3</b> (C) OS in 75 BCP-ALL patients</a></li>
<li class="chapter" data-level="19.4" data-path="figure-4.html"><a href="figure-4.html#d-multivariate-cox-analysis"><i class="fa fa-check"></i><b>19.4</b> (D) Multivariate Cox Analysis</a></li>
<li class="chapter" data-level="19.5" data-path="figure-4.html"><a href="figure-4.html#e-subnetwork-between-bc3-and-bc12"><i class="fa fa-check"></i><b>19.5</b> (E) Subnetwork between BC3 and BC1/2</a></li>
<li class="chapter" data-level="19.6" data-path="figure-4.html"><a href="figure-4.html#f-discrimination-of-t-all-clusters"><i class="fa fa-check"></i><b>19.6</b> (F) Discrimination of T-ALL Clusters</a></li>
<li class="chapter" data-level="19.7" data-path="figure-4.html"><a href="figure-4.html#g-os-of-tc12"><i class="fa fa-check"></i><b>19.7</b> (G) OS of TC1/2</a></li>
<li class="chapter" data-level="19.8" data-path="figure-4.html"><a href="figure-4.html#h-subnetwork-between-tc2-and-tc1"><i class="fa fa-check"></i><b>19.8</b> (H) Subnetwork between TC2 and TC1</a></li>
<li class="chapter" data-level="19.9" data-path="figure-4.html"><a href="figure-4.html#s5-a-clusters-of-bcp-all"><i class="fa fa-check"></i><b>19.9</b> (S5 A) Clusters of BCP-ALL</a></li>
<li class="chapter" data-level="19.10" data-path="figure-4.html"><a href="figure-4.html#s5-e-waterfall-plot-of-bc123"><i class="fa fa-check"></i><b>19.10</b> (S5 E) Waterfall plot of BC1/2/3</a></li>
<li class="chapter" data-level="19.11" data-path="figure-4.html"><a href="figure-4.html#s5-h-da-score-of-bc3-cluster"><i class="fa fa-check"></i><b>19.11</b> (S5 H) DA-score of BC3 cluster</a></li>
<li class="chapter" data-level="19.12" data-path="figure-4.html"><a href="figure-4.html#s5-i-j-msea-of-bc123"><i class="fa fa-check"></i><b>19.12</b> (S5 I-J) MSEA of BC1/2/3</a></li>
<li class="chapter" data-level="19.13" data-path="figure-4.html"><a href="figure-4.html#s6-a-clusters-of-t-all"><i class="fa fa-check"></i><b>19.13</b> (S6 A) Clusters of T-ALL</a></li>
<li class="chapter" data-level="19.14" data-path="figure-4.html"><a href="figure-4.html#s6-e-f-rfs-and-efs-of-tc12"><i class="fa fa-check"></i><b>19.14</b> (S6 E-F) RFS and EFS of TC1/2</a></li>
<li class="chapter" data-level="19.15" data-path="figure-4.html"><a href="figure-4.html#s6-h-multivariate-cox-analysis-of-tc12"><i class="fa fa-check"></i><b>19.15</b> (S6 H) Multivariate Cox Analysis of TC1/2</a></li>
<li class="chapter" data-level="19.16" data-path="figure-4.html"><a href="figure-4.html#s6-i-heatmap-of-tc12"><i class="fa fa-check"></i><b>19.16</b> (S6 I) Heatmap of TC1/2</a></li>
<li class="chapter" data-level="19.17" data-path="figure-4.html"><a href="figure-4.html#s6-j-da-score-of-tc12"><i class="fa fa-check"></i><b>19.17</b> (S6 J) DA score of TC1/2</a></li>
<li class="chapter" data-level="19.18" data-path="figure-4.html"><a href="figure-4.html#s6-k-l-msea-of-tc12"><i class="fa fa-check"></i><b>19.18</b> (S6 K-L) MSEA of TC1/2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank"></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ALL metabolism analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-1" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Figure 1<a href="figure-1.html#figure-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="Figure-1025/1_Figure1.png" width="1861" style="display: block; margin: auto;" /></p>
<p><strong>Figure 1: Construction of a multi-omics landscape of the adult ALL cohort centering on the metabolome.</strong></p>
<p>A. Overview of the experimental design and the number of samples for metabolome and RNA-seq analyses. * Among the 106 samples subject to intracellular metabolome investigation on D0 of induction therapy, BMMC samples were used in 100 cases and PBMC samples were available in 6 cases.</p>
<p>B. Number of annotated metabolites in serum and intracellular samples, grouped by metabolites functional category, mainly based on KEGG.</p>
<p>C. (Middle Panel) The heatmap provides a comprehensive overview of the metabolome in BCP-ALL and T-ALL patients at specified time points, further grouped by D28 status. The entire metabolome pattern is categorized into nine clusters, with significantly enriched pathways for clustered metabolites annotated on the right (P &lt; 0.05). Each row represents a metabolite, each column corresponds to a sample, and each score reflects its relative abundance compared to HC levels, calculated as the median within each subgroup. (Left Panel) The correlation between each cluster and clinical parameters assessed on Day 0 (D0) is displayed (P-value &lt; 0.01). UA: uric acid; CREA: creatine; HDL: high-density lipoprotein; PAB: Prealbumin; AST: Aspartate Aminotransferase; ALP: Alkaline Phosphatase; WBC: White Blood Cell count; TBIL: Total Bilirubin; GGT: Gamma-Glutamyl Transferase; BUN: Blood Urea Nitrogen; PLT: Platelet count; DBIL: Direct Bilirubin; TP: Total Protein; ALB: Albumin; CHOL: Cholesterol; GLU: Glucose; Hb: Hemoglobin.</p>
<div id="b-annotated-metabolites" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> (B) Annotated metabolites<a href="figure-1.html#b-annotated-metabolites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Number of annotated metabolites in serum and intracellular samples</strong>, grouped by metabolites functional category, mainly based on KEGG.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="figure-1.html#cb49-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-2"><a href="figure-1.html#cb49-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-3"><a href="figure-1.html#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="figure-1.html#cb49-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb49-5"><a href="figure-1.html#cb49-5" tabindex="-1"></a><span class="co">#  Step 1: Load metabolomics data and set parameters</span></span>
<span id="cb49-6"><a href="figure-1.html#cb49-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb49-7"><a href="figure-1.html#cb49-7" tabindex="-1"></a>dat_cell <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/cell_dat_final_reuslt_v0329.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="figure-1.html#cb49-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="figure-1.html#cb49-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span>stringr<span class="sc">::</span><span class="fu">str_to_title</span>(label)) </span>
<span id="cb49-10"><a href="figure-1.html#cb49-10" tabindex="-1"></a></span>
<span id="cb49-11"><a href="figure-1.html#cb49-11" tabindex="-1"></a><span class="fu">dim</span>(dat_cell)</span>
<span id="cb49-12"><a href="figure-1.html#cb49-12" tabindex="-1"></a></span>
<span id="cb49-13"><a href="figure-1.html#cb49-13" tabindex="-1"></a>kidc <span class="ot">&lt;-</span> openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>(<span class="st">&quot;raw_data/cell_metabolite_info_all_v1109.xlsx&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-14"><a href="figure-1.html#cb49-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span>refmet_name) <span class="sc">%&gt;%</span> </span>
<span id="cb49-15"><a href="figure-1.html#cb49-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span>stringr<span class="sc">::</span><span class="fu">str_to_title</span>(label)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-16"><a href="figure-1.html#cb49-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(label,class) <span class="sc">%&gt;%</span></span>
<span id="cb49-17"><a href="figure-1.html#cb49-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">class=</span><span class="fu">ifelse</span>(class<span class="sc">==</span><span class="st">&quot;Nucleic acids&quot;</span>,<span class="st">&quot;Nucleotides&quot;</span>,class))</span>
<span id="cb49-18"><a href="figure-1.html#cb49-18" tabindex="-1"></a>cell.data <span class="ot">&lt;-</span> kidc <span class="sc">%&gt;%</span> </span>
<span id="cb49-19"><a href="figure-1.html#cb49-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">%in%</span> dat_cell<span class="sc">$</span>label) <span class="sc">%&gt;%</span> </span>
<span id="cb49-20"><a href="figure-1.html#cb49-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(dat_cell,<span class="at">by=</span><span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-21"><a href="figure-1.html#cb49-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">super.class=</span>class) <span class="sc">%&gt;%</span> </span>
<span id="cb49-22"><a href="figure-1.html#cb49-22" tabindex="-1"></a>  <span class="fu">group_by</span>(super.class) <span class="sc">%&gt;%</span> </span>
<span id="cb49-23"><a href="figure-1.html#cb49-23" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb49-24"><a href="figure-1.html#cb49-24" tabindex="-1"></a></span>
<span id="cb49-25"><a href="figure-1.html#cb49-25" tabindex="-1"></a>kid <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_metabolites_id_v240328.txt&quot;</span>)</span>
<span id="cb49-26"><a href="figure-1.html#cb49-26" tabindex="-1"></a></span>
<span id="cb49-27"><a href="figure-1.html#cb49-27" tabindex="-1"></a>dataRAW <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-28"><a href="figure-1.html#cb49-28" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb49-29"><a href="figure-1.html#cb49-29" tabindex="-1"></a>data_raw <span class="ot">&lt;-</span> dataRAW <span class="sc">%&gt;%</span> </span>
<span id="cb49-30"><a href="figure-1.html#cb49-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">label=</span>stringr<span class="sc">::</span><span class="fu">str_to_title</span>(label)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-31"><a href="figure-1.html#cb49-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Metabolites&quot;</span><span class="ot">=</span><span class="st">&quot;label&quot;</span>)</span>
<span id="cb49-32"><a href="figure-1.html#cb49-32" tabindex="-1"></a></span>
<span id="cb49-33"><a href="figure-1.html#cb49-33" tabindex="-1"></a>serum.data <span class="ot">&lt;-</span> kid <span class="sc">%&gt;%</span> </span>
<span id="cb49-34"><a href="figure-1.html#cb49-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(query <span class="sc">%in%</span> dataRAW<span class="sc">$</span>label) <span class="sc">%&gt;%</span> </span>
<span id="cb49-35"><a href="figure-1.html#cb49-35" tabindex="-1"></a>  <span class="fu">group_by</span>(super.class) <span class="sc">%&gt;%</span> </span>
<span id="cb49-36"><a href="figure-1.html#cb49-36" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) </span>
<span id="cb49-37"><a href="figure-1.html#cb49-37" tabindex="-1"></a></span>
<span id="cb49-38"><a href="figure-1.html#cb49-38" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb49-39"><a href="figure-1.html#cb49-39" tabindex="-1"></a><span class="co">#  Step 2: Barplot and Venn Diagram</span></span>
<span id="cb49-40"><a href="figure-1.html#cb49-40" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb49-41"><a href="figure-1.html#cb49-41" tabindex="-1"></a><span class="do">## Barplot for annotated metabolites</span></span>
<span id="cb49-42"><a href="figure-1.html#cb49-42" tabindex="-1"></a>pie.s <span class="ot">&lt;-</span> serum.data</span>
<span id="cb49-43"><a href="figure-1.html#cb49-43" tabindex="-1"></a>pie.c <span class="ot">&lt;-</span> cell.data</span>
<span id="cb49-44"><a href="figure-1.html#cb49-44" tabindex="-1"></a></span>
<span id="cb49-45"><a href="figure-1.html#cb49-45" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;serum&quot;</span>),<span class="dv">8</span>)</span>
<span id="cb49-46"><a href="figure-1.html#cb49-46" tabindex="-1"></a>pie.s<span class="sc">$</span>group <span class="ot">&lt;-</span> group </span>
<span id="cb49-47"><a href="figure-1.html#cb49-47" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;cell&quot;</span>),<span class="dv">8</span>)</span>
<span id="cb49-48"><a href="figure-1.html#cb49-48" tabindex="-1"></a>pie.c<span class="sc">$</span>group <span class="ot">&lt;-</span> group </span>
<span id="cb49-49"><a href="figure-1.html#cb49-49" tabindex="-1"></a></span>
<span id="cb49-50"><a href="figure-1.html#cb49-50" tabindex="-1"></a>pie <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pie.c,pie.s) <span class="sc">%&gt;%</span></span>
<span id="cb49-51"><a href="figure-1.html#cb49-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span>
<span id="cb49-52"><a href="figure-1.html#cb49-52" tabindex="-1"></a></span>
<span id="cb49-53"><a href="figure-1.html#cb49-53" tabindex="-1"></a>pie_sort <span class="ot">&lt;-</span> pie <span class="sc">%&gt;%</span></span>
<span id="cb49-54"><a href="figure-1.html#cb49-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(group<span class="sc">==</span><span class="st">&quot;cell&quot;</span>)</span>
<span id="cb49-55"><a href="figure-1.html#cb49-55" tabindex="-1"></a>pie<span class="sc">$</span>super.class <span class="ot">&lt;-</span> <span class="fu">factor</span>(pie<span class="sc">$</span>super.class,<span class="at">level=</span><span class="fu">c</span>(<span class="st">&quot;Lipids&quot;</span>,<span class="st">&quot;Amino acids and peptides&quot;</span>,<span class="st">&quot;Nucleotides&quot;</span>,<span class="st">&quot;Carbohydrates&quot;</span>,<span class="st">&quot;Cofactors and Vitamins&quot;</span>,<span class="st">&quot;Energy&quot;</span>,<span class="st">&quot;Xenobiotics&quot;</span>,<span class="st">&quot;Other&quot;</span>))</span>
<span id="cb49-56"><a href="figure-1.html#cb49-56" tabindex="-1"></a>cs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;serum&quot;</span><span class="ot">=</span><span class="st">&quot;#2b6a99&quot;</span>,<span class="st">&quot;cell&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>)</span>
<span id="cb49-57"><a href="figure-1.html#cb49-57" tabindex="-1"></a></span>
<span id="cb49-58"><a href="figure-1.html#cb49-58" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pie, <span class="fu">aes</span>(<span class="at">x=</span>super.class, <span class="at">weight=</span>count,<span class="at">fill=</span><span class="fu">factor</span>(group)))<span class="sc">+</span></span>
<span id="cb49-59"><a href="figure-1.html#cb49-59" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb49-60"><a href="figure-1.html#cb49-60" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb49-61"><a href="figure-1.html#cb49-61" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;serum&quot;</span><span class="ot">=</span><span class="st">&quot;#2b6a99&quot;</span>,<span class="st">&quot;cell&quot;</span><span class="ot">=</span><span class="st">&quot;#f16c23&quot;</span>))<span class="sc">+</span></span>
<span id="cb49-62"><a href="figure-1.html#cb49-62" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb49-63"><a href="figure-1.html#cb49-63" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb49-64"><a href="figure-1.html#cb49-64" tabindex="-1"></a><span class="fu">ggsave</span>(p1,<span class="at">filename =</span> <span class="st">&quot;result/Figure1/1B.barplot.pdf&quot;</span>,<span class="at">width =</span> <span class="dv">8</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb49-65"><a href="figure-1.html#cb49-65" tabindex="-1"></a></span>
<span id="cb49-66"><a href="figure-1.html#cb49-66" tabindex="-1"></a><span class="do">## Venn</span></span>
<span id="cb49-67"><a href="figure-1.html#cb49-67" tabindex="-1"></a>cell <span class="ot">&lt;-</span> dat_cell<span class="sc">$</span>label</span>
<span id="cb49-68"><a href="figure-1.html#cb49-68" tabindex="-1"></a>serum <span class="ot">&lt;-</span> data_raw<span class="sc">$</span>Metabolites</span>
<span id="cb49-69"><a href="figure-1.html#cb49-69" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb49-70"><a href="figure-1.html#cb49-70" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">venn.diagram</span>(<span class="fu">list</span>(<span class="at">cell=</span>cell,<span class="at">serum=</span>serum),<span class="at">filename=</span><span class="cn">NULL</span>,<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#f16c23&quot;</span>,<span class="st">&quot;#2b6a99&quot;</span>),<span class="at">alpha =</span><span class="dv">1</span>)</span>
<span id="cb49-71"><a href="figure-1.html#cb49-71" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/1B.pie.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb49-72"><a href="figure-1.html#cb49-72" tabindex="-1"></a><span class="fu">grid.draw</span>(a)</span>
<span id="cb49-73"><a href="figure-1.html#cb49-73" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure1/1B.png" width="446" style="display: block; margin: auto;" /></p>
</div>
<div id="c-comprehensive-metabolome-overview" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> (C) Comprehensive metabolome overview<a href="figure-1.html#c-comprehensive-metabolome-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(Middle Panel) The heatmap provides a comprehensive overview of the metabolome in BCP-ALL and T-ALL patients at specified time points, further grouped by D28 status. The entire metabolome pattern is categorized into nine clusters, with significantly enriched pathways for clustered metabolites annotated on the right (P &lt; 0.05). Each row represents a metabolite, each column corresponds to a sample, and each score reflects its relative abundance compared to HC levels, calculated as the median within each subgroup.</p>
<p>(Left Panel) The correlation between each cluster and clinical parameters assessed on Day 0 (D0) is displayed (P-value &lt; 0.01).</p>
<p>UA: uric acid; CREA: creatine; HDL: high-density lipoprotein; PAB: Prealbumin; AST: Aspartate Aminotransferase; ALP: Alkaline Phosphatase; WBC: White Blood Cell count; TBIL: Total Bilirubin; GGT: Gamma-Glutamyl Transferase; BUN: Blood Urea Nitrogen; PLT: Platelet count; DBIL: Direct Bilirubin; TP: Total Protein; ALB: Albumin; CHOL: Cholesterol; GLU: Glucose; Hb: Hemoglobin.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="figure-1.html#cb50-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb50-2"><a href="figure-1.html#cb50-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb50-3"><a href="figure-1.html#cb50-3" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb50-4"><a href="figure-1.html#cb50-4" tabindex="-1"></a><span class="fu">library</span>(maSigPro)</span>
<span id="cb50-5"><a href="figure-1.html#cb50-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-6"><a href="figure-1.html#cb50-6" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb50-7"><a href="figure-1.html#cb50-7" tabindex="-1"></a></span>
<span id="cb50-8"><a href="figure-1.html#cb50-8" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-9"><a href="figure-1.html#cb50-9" tabindex="-1"></a><span class="co">#  Step 1: Use maSigPro for time series data analysis</span></span>
<span id="cb50-10"><a href="figure-1.html#cb50-10" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-11"><a href="figure-1.html#cb50-11" tabindex="-1"></a></span>
<span id="cb50-12"><a href="figure-1.html#cb50-12" tabindex="-1"></a>sample_patient_A <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="figure-1.html#cb50-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-14"><a href="figure-1.html#cb50-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="figure-1.html#cb50-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,METs_D0_ID,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="figure-1.html#cb50-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;METs_D0_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-17"><a href="figure-1.html#cb50-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;D0&quot;</span>)</span>
<span id="cb50-18"><a href="figure-1.html#cb50-18" tabindex="-1"></a>sample_patient_C <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-19"><a href="figure-1.html#cb50-19" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-20"><a href="figure-1.html#cb50-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_D14_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-21"><a href="figure-1.html#cb50-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,METs_D14_ID,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-22"><a href="figure-1.html#cb50-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;METs_D14_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-23"><a href="figure-1.html#cb50-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;D14&quot;</span>)</span>
<span id="cb50-24"><a href="figure-1.html#cb50-24" tabindex="-1"></a>sample_patient_E <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-25"><a href="figure-1.html#cb50-25" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-26"><a href="figure-1.html#cb50-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_D28_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-27"><a href="figure-1.html#cb50-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,METs_D28_ID,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-28"><a href="figure-1.html#cb50-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;METs_D28_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-29"><a href="figure-1.html#cb50-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;D28&quot;</span>)</span>
<span id="cb50-30"><a href="figure-1.html#cb50-30" tabindex="-1"></a>sample_patient_Cons <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-31"><a href="figure-1.html#cb50-31" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-32"><a href="figure-1.html#cb50-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_Cons_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-33"><a href="figure-1.html#cb50-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,METs_Cons_ID,<span class="st">`</span><span class="at">Cons_BM MRD status</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-34"><a href="figure-1.html#cb50-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;D28_BM MRD status&quot;</span><span class="ot">=</span><span class="st">&quot;Cons_BM MRD status&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-35"><a href="figure-1.html#cb50-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;NR&quot;</span>,<span class="st">&quot;PR&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-36"><a href="figure-1.html#cb50-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&quot;CR&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-37"><a href="figure-1.html#cb50-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;METs_Cons_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-38"><a href="figure-1.html#cb50-38" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="st">&quot;Cons&quot;</span>)</span>
<span id="cb50-39"><a href="figure-1.html#cb50-39" tabindex="-1"></a></span>
<span id="cb50-40"><a href="figure-1.html#cb50-40" tabindex="-1"></a>sample_patient_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sample_patient_A,sample_patient_C,</span>
<span id="cb50-41"><a href="figure-1.html#cb50-41" tabindex="-1"></a>                            sample_patient_E,sample_patient_Cons) <span class="sc">%&gt;%</span></span>
<span id="cb50-42"><a href="figure-1.html#cb50-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;early death&quot;</span>,<span class="st">&quot;PR&quot;</span>,<span class="st">&quot;NR&quot;</span>),<span class="st">&quot;NoCR&quot;</span>,</span>
<span id="cb50-43"><a href="figure-1.html#cb50-43" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>))</span>
<span id="cb50-44"><a href="figure-1.html#cb50-44" tabindex="-1"></a></span>
<span id="cb50-45"><a href="figure-1.html#cb50-45" tabindex="-1"></a>dd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-46"><a href="figure-1.html#cb50-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Metabolite,<span class="fu">all_of</span>(sample_patient_all<span class="sc">$</span>ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-47"><a href="figure-1.html#cb50-47" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-48"><a href="figure-1.html#cb50-48" tabindex="-1"></a>  <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-49"><a href="figure-1.html#cb50-49" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb50-50"><a href="figure-1.html#cb50-50" tabindex="-1"></a></span>
<span id="cb50-51"><a href="figure-1.html#cb50-51" tabindex="-1"></a>dat_design <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">names</span>(dd)) <span class="sc">%&gt;%</span></span>
<span id="cb50-52"><a href="figure-1.html#cb50-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_patient_all,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-53"><a href="figure-1.html#cb50-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(type),<span class="st">&quot;HC&quot;</span>,type)) <span class="sc">%&gt;%</span></span>
<span id="cb50-54"><a href="figure-1.html#cb50-54" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>),<span class="st">&quot;HC&quot;</span>,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-55"><a href="figure-1.html#cb50-55" tabindex="-1"></a> <span class="co"># dplyr::mutate(Control=ifelse(type==&quot;HC&quot;,1,0)) %&gt;%</span></span>
<span id="cb50-56"><a href="figure-1.html#cb50-56" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">POS=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-57"><a href="figure-1.html#cb50-57" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">NEG=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-58"><a href="figure-1.html#cb50-58" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">NoCR=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NoCR&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-59"><a href="figure-1.html#cb50-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Time=</span>type) <span class="sc">%&gt;%</span></span>
<span id="cb50-60"><a href="figure-1.html#cb50-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Replicate=</span><span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;HC&quot;</span>,<span class="dv">1</span>,</span>
<span id="cb50-61"><a href="figure-1.html#cb50-61" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D0&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="dv">2</span>,</span>
<span id="cb50-62"><a href="figure-1.html#cb50-62" tabindex="-1"></a>                                        <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D0&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="dv">3</span>,</span>
<span id="cb50-63"><a href="figure-1.html#cb50-63" tabindex="-1"></a>                                               <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D0&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NoCR&quot;</span>,<span class="dv">4</span>,</span>
<span id="cb50-64"><a href="figure-1.html#cb50-64" tabindex="-1"></a>                                                      <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D14&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="dv">5</span>,</span>
<span id="cb50-65"><a href="figure-1.html#cb50-65" tabindex="-1"></a>                                                             <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D14&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="dv">6</span>,</span>
<span id="cb50-66"><a href="figure-1.html#cb50-66" tabindex="-1"></a>                                                                    <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D14&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NoCR&quot;</span>,<span class="dv">7</span>,</span>
<span id="cb50-67"><a href="figure-1.html#cb50-67" tabindex="-1"></a>                                                                           <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D28&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="dv">8</span>,</span>
<span id="cb50-68"><a href="figure-1.html#cb50-68" tabindex="-1"></a>                                                                                  <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D28&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="dv">9</span>,</span>
<span id="cb50-69"><a href="figure-1.html#cb50-69" tabindex="-1"></a>                                                                                         <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;D28&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NoCR&quot;</span>,<span class="dv">10</span>,</span>
<span id="cb50-70"><a href="figure-1.html#cb50-70" tabindex="-1"></a>                                                                                                <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;Cons&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="dv">11</span>,</span>
<span id="cb50-71"><a href="figure-1.html#cb50-71" tabindex="-1"></a>                                                                                                       <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;Cons&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="dv">12</span>,</span>
<span id="cb50-72"><a href="figure-1.html#cb50-72" tabindex="-1"></a>                                                                                                              <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">&quot;Cons&quot;</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;NoCR&quot;</span>,<span class="dv">13</span>,<span class="st">&quot;a&quot;</span></span>
<span id="cb50-73"><a href="figure-1.html#cb50-73" tabindex="-1"></a>                                                                                                              )))))))))))))) <span class="sc">%&gt;%</span></span>
<span id="cb50-74"><a href="figure-1.html#cb50-74" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,Time,Replicate,NoCR,POS,NEG) <span class="sc">%&gt;%</span></span>
<span id="cb50-75"><a href="figure-1.html#cb50-75" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-76"><a href="figure-1.html#cb50-76" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Time=</span><span class="fu">ifelse</span>(Time<span class="sc">==</span><span class="st">&quot;HC&quot;</span>,<span class="dv">1</span>,</span>
<span id="cb50-77"><a href="figure-1.html#cb50-77" tabindex="-1"></a>                            <span class="fu">ifelse</span>(Time<span class="sc">==</span><span class="st">&quot;D0&quot;</span>,<span class="dv">2</span>,</span>
<span id="cb50-78"><a href="figure-1.html#cb50-78" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(Time<span class="sc">==</span><span class="st">&quot;D14&quot;</span>,<span class="dv">3</span>,</span>
<span id="cb50-79"><a href="figure-1.html#cb50-79" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(Time<span class="sc">==</span><span class="st">&quot;D28&quot;</span>,<span class="dv">4</span>,</span>
<span id="cb50-80"><a href="figure-1.html#cb50-80" tabindex="-1"></a>                                                 <span class="fu">ifelse</span>(Time<span class="sc">==</span><span class="st">&quot;Cons&quot;</span>,<span class="dv">5</span>,<span class="cn">NA</span>)))))) <span class="sc">%&gt;%</span></span>
<span id="cb50-81"><a href="figure-1.html#cb50-81" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb50-82"><a href="figure-1.html#cb50-82" tabindex="-1"></a></span>
<span id="cb50-83"><a href="figure-1.html#cb50-83" tabindex="-1"></a>dat_design1<span class="ot">=</span><span class="fu">apply</span>(dat_design,<span class="dv">2</span>,as.numeric)</span>
<span id="cb50-84"><a href="figure-1.html#cb50-84" tabindex="-1"></a><span class="fu">rownames</span>(dat_design1) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dat_design)</span>
<span id="cb50-85"><a href="figure-1.html#cb50-85" tabindex="-1"></a>dat_design <span class="ot">&lt;-</span> dat_design1</span>
<span id="cb50-86"><a href="figure-1.html#cb50-86" tabindex="-1"></a></span>
<span id="cb50-87"><a href="figure-1.html#cb50-87" tabindex="-1"></a>dd_scale <span class="ot">&lt;-</span> <span class="fu">myscale</span>(dd ,<span class="at">method=</span><span class="st">&quot;raw_zscore&quot;</span>)</span>
<span id="cb50-88"><a href="figure-1.html#cb50-88" tabindex="-1"></a></span>
<span id="cb50-89"><a href="figure-1.html#cb50-89" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">make.design.matrix</span>(dat_design, <span class="at">degree =</span> <span class="dv">2</span>)</span>
<span id="cb50-90"><a href="figure-1.html#cb50-90" tabindex="-1"></a></span>
<span id="cb50-91"><a href="figure-1.html#cb50-91" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-92"><a href="figure-1.html#cb50-92" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">p.vector</span>(dd_scale, design, <span class="at">Q =</span> <span class="fl">0.05</span>, <span class="at">MT.adjust =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">min.obs =</span> <span class="dv">50</span>)</span>
<span id="cb50-93"><a href="figure-1.html#cb50-93" tabindex="-1"></a>fit<span class="sc">$</span>i <span class="co"># returns the number of significant genes</span></span>
<span id="cb50-94"><a href="figure-1.html#cb50-94" tabindex="-1"></a></span>
<span id="cb50-95"><a href="figure-1.html#cb50-95" tabindex="-1"></a>fit<span class="sc">$</span>alfa <span class="co"># gives p-value at the Q false discovery control level</span></span>
<span id="cb50-96"><a href="figure-1.html#cb50-96" tabindex="-1"></a></span>
<span id="cb50-97"><a href="figure-1.html#cb50-97" tabindex="-1"></a><span class="do">## 4. Difference Analysis</span></span>
<span id="cb50-98"><a href="figure-1.html#cb50-98" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-99"><a href="figure-1.html#cb50-99" tabindex="-1"></a>tstep <span class="ot">&lt;-</span> <span class="fu">T.fit</span>(fit, <span class="at">step.method =</span> <span class="st">&quot;backward&quot;</span>, <span class="at">alfa =</span> <span class="fl">0.05</span>)</span>
<span id="cb50-100"><a href="figure-1.html#cb50-100" tabindex="-1"></a></span>
<span id="cb50-101"><a href="figure-1.html#cb50-101" tabindex="-1"></a><span class="do">## 5. Extract differentially expressed genes</span></span>
<span id="cb50-102"><a href="figure-1.html#cb50-102" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb50-103"><a href="figure-1.html#cb50-103" tabindex="-1"></a>sigs <span class="ot">&lt;-</span> <span class="fu">get.siggenes</span>(tstep, <span class="at">rsq =</span> <span class="fl">0.05</span>, <span class="at">vars =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb50-104"><a href="figure-1.html#cb50-104" tabindex="-1"></a></span>
<span id="cb50-105"><a href="figure-1.html#cb50-105" tabindex="-1"></a><span class="co">#suma2Venn(sigs$summary[, c(1:3)])</span></span>
<span id="cb50-106"><a href="figure-1.html#cb50-106" tabindex="-1"></a><span class="co">#suma2Venn(sigs$summary[, c(1:4)])</span></span>
<span id="cb50-107"><a href="figure-1.html#cb50-107" tabindex="-1"></a></span>
<span id="cb50-108"><a href="figure-1.html#cb50-108" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/1C.all_0.05.pdf&quot;</span>)</span>
<span id="cb50-109"><a href="figure-1.html#cb50-109" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">see.genes</span>(sigs<span class="sc">$</span>sig.genes, <span class="at">edesign=</span>design<span class="sc">$</span>edesign,<span class="at">show.fit =</span> T, <span class="at">dis =</span>design<span class="sc">$</span>dis, </span>
<span id="cb50-110"><a href="figure-1.html#cb50-110" tabindex="-1"></a>               <span class="at">cluster.method=</span><span class="st">&quot;hclust&quot;</span> ,<span class="at">cluster.data =</span> <span class="dv">1</span>, <span class="at">k.mclust=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-111"><a href="figure-1.html#cb50-111" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb50-112"><a href="figure-1.html#cb50-112" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="at">nn=</span>a<span class="sc">$</span>cut),<span class="st">&quot;result/Figure1/1C.all_0.05.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb50-113"><a href="figure-1.html#cb50-113" tabindex="-1"></a></span>
<span id="cb50-114"><a href="figure-1.html#cb50-114" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-115"><a href="figure-1.html#cb50-115" tabindex="-1"></a><span class="co">#  Step 2: The comprehensive metabolome overview of BCP-ALL/T-ALL patients at denoted time points and further grouped by D28 status</span></span>
<span id="cb50-116"><a href="figure-1.html#cb50-116" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-117"><a href="figure-1.html#cb50-117" tabindex="-1"></a></span>
<span id="cb50-118"><a href="figure-1.html#cb50-118" tabindex="-1"></a>mark_meta <span class="ot">&lt;-</span> <span class="st">&quot;Taurocholic acid&quot;</span></span>
<span id="cb50-119"><a href="figure-1.html#cb50-119" tabindex="-1"></a></span>
<span id="cb50-120"><a href="figure-1.html#cb50-120" tabindex="-1"></a>sample_patient_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sample_patient_A,sample_patient_C,</span>
<span id="cb50-121"><a href="figure-1.html#cb50-121" tabindex="-1"></a>                            sample_patient_E,sample_patient_Cons) <span class="sc">%&gt;%</span></span>
<span id="cb50-122"><a href="figure-1.html#cb50-122" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;early death&quot;</span>,<span class="st">&quot;PR&quot;</span>,<span class="st">&quot;NR&quot;</span>),<span class="st">&quot;NoCR&quot;</span>,</span>
<span id="cb50-123"><a href="figure-1.html#cb50-123" tabindex="-1"></a>                                           <span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-124"><a href="figure-1.html#cb50-124" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>)</span>
<span id="cb50-125"><a href="figure-1.html#cb50-125" tabindex="-1"></a></span>
<span id="cb50-126"><a href="figure-1.html#cb50-126" tabindex="-1"></a>met <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure1/1C.all_0.05.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-127"><a href="figure-1.html#cb50-127" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb50-128"><a href="figure-1.html#cb50-128" tabindex="-1"></a></span>
<span id="cb50-129"><a href="figure-1.html#cb50-129" tabindex="-1"></a>dd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-130"><a href="figure-1.html#cb50-130" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Metabolite,<span class="fu">starts_with</span>(<span class="st">&quot;H&quot;</span>),<span class="fu">all_of</span>(sample_patient_all<span class="sc">$</span>ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-131"><a href="figure-1.html#cb50-131" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Metabolite <span class="sc">%in%</span> met<span class="sc">$</span>V1) <span class="sc">%&gt;%</span></span>
<span id="cb50-132"><a href="figure-1.html#cb50-132" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Metabolite,met<span class="sc">$</span>V1)) <span class="sc">%&gt;%</span></span>
<span id="cb50-133"><a href="figure-1.html#cb50-133" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-134"><a href="figure-1.html#cb50-134" tabindex="-1"></a>  <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-135"><a href="figure-1.html#cb50-135" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-136"><a href="figure-1.html#cb50-136" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;Metabolite&quot;</span>)</span>
<span id="cb50-137"><a href="figure-1.html#cb50-137" tabindex="-1"></a>sample_all <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">names</span>(dd)) <span class="sc">%&gt;%</span></span>
<span id="cb50-138"><a href="figure-1.html#cb50-138" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ID <span class="sc">!=</span> <span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-139"><a href="figure-1.html#cb50-139" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_patient_all,<span class="at">by=</span><span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-140"><a href="figure-1.html#cb50-140" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">type=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(type),<span class="st">&quot;HC&quot;</span>,type)) <span class="sc">%&gt;%</span></span>
<span id="cb50-141"><a href="figure-1.html#cb50-141" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>),<span class="st">&quot;HC&quot;</span>,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>))</span>
<span id="cb50-142"><a href="figure-1.html#cb50-142" tabindex="-1"></a></span>
<span id="cb50-143"><a href="figure-1.html#cb50-143" tabindex="-1"></a>dd_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dd,<span class="at">id=</span><span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-144"><a href="figure-1.html#cb50-144" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(sample_all,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;ID&quot;</span>))</span>
<span id="cb50-145"><a href="figure-1.html#cb50-145" tabindex="-1"></a>dd_median <span class="ot">&lt;-</span> dd_melt <span class="sc">%&gt;%</span></span>
<span id="cb50-146"><a href="figure-1.html#cb50-146" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Metabolite,<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>, type) <span class="sc">%&gt;%</span></span>
<span id="cb50-147"><a href="figure-1.html#cb50-147" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">median</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb50-148"><a href="figure-1.html#cb50-148" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-149"><a href="figure-1.html#cb50-149" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">a=</span><span class="fu">paste0</span>(<span class="st">`</span><span class="at">D28_BM MRD status</span><span class="st">`</span>,<span class="st">&quot;_&quot;</span>,type)) <span class="sc">%&gt;%</span></span>
<span id="cb50-150"><a href="figure-1.html#cb50-150" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Metabolite,a,n)</span>
<span id="cb50-151"><a href="figure-1.html#cb50-151" tabindex="-1"></a></span>
<span id="cb50-152"><a href="figure-1.html#cb50-152" tabindex="-1"></a>dd_dcast <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(dd_median,Metabolite<span class="sc">~</span>a) <span class="sc">%&gt;%</span></span>
<span id="cb50-153"><a href="figure-1.html#cb50-153" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Metabolite,met<span class="sc">$</span>V1)) <span class="sc">%&gt;%</span></span>
<span id="cb50-154"><a href="figure-1.html#cb50-154" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>)</span>
<span id="cb50-155"><a href="figure-1.html#cb50-155" tabindex="-1"></a>dd_scale <span class="ot">&lt;-</span> <span class="fu">log2</span>(dd_dcast<span class="sc">/</span>dd_dcast<span class="sc">$</span>HC_HC) <span class="sc">%&gt;%</span></span>
<span id="cb50-156"><a href="figure-1.html#cb50-156" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>HC_HC)</span>
<span id="cb50-157"><a href="figure-1.html#cb50-157" tabindex="-1"></a></span>
<span id="cb50-158"><a href="figure-1.html#cb50-158" tabindex="-1"></a>sample_all <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">names</span>(dd_scale)) <span class="sc">%&gt;%</span></span>
<span id="cb50-159"><a href="figure-1.html#cb50-159" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">a=</span>ID) <span class="sc">%&gt;%</span></span>
<span id="cb50-160"><a href="figure-1.html#cb50-160" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(ID,<span class="at">sep=</span><span class="st">&quot;_&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;status&quot;</span>,<span class="st">&quot;type&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-161"><a href="figure-1.html#cb50-161" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">status=</span><span class="fu">ifelse</span>(status<span class="sc">==</span><span class="st">&quot;NEG&quot;</span>,<span class="st">&quot;MRD-&quot;</span>,</span>
<span id="cb50-162"><a href="figure-1.html#cb50-162" tabindex="-1"></a>                              <span class="fu">ifelse</span>(status<span class="sc">==</span><span class="st">&quot;POS&quot;</span>,<span class="st">&quot;MRD+&quot;</span>,status))) <span class="sc">%&gt;%</span></span>
<span id="cb50-163"><a href="figure-1.html#cb50-163" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(status,<span class="fu">c</span>(<span class="st">&quot;HC&quot;</span>,<span class="st">&quot;MRD-&quot;</span>,<span class="st">&quot;MRD+&quot;</span>,<span class="st">&quot;NoCR&quot;</span>)))</span>
<span id="cb50-164"><a href="figure-1.html#cb50-164" tabindex="-1"></a>dd_result <span class="ot">&lt;-</span> dd_scale <span class="sc">%&gt;%</span></span>
<span id="cb50-165"><a href="figure-1.html#cb50-165" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_all<span class="sc">$</span>a)</span>
<span id="cb50-166"><a href="figure-1.html#cb50-166" tabindex="-1"></a></span>
<span id="cb50-167"><a href="figure-1.html#cb50-167" tabindex="-1"></a>overlap_met <span class="ot">&lt;-</span> <span class="fu">intersect</span>(stringr<span class="sc">::</span><span class="fu">str_to_title</span>(mark_meta),stringr<span class="sc">::</span><span class="fu">str_to_title</span>(<span class="fu">rownames</span>(dd_result)))</span>
<span id="cb50-168"><a href="figure-1.html#cb50-168" tabindex="-1"></a></span>
<span id="cb50-169"><a href="figure-1.html#cb50-169" tabindex="-1"></a>gene_pos <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>()</span>
<span id="cb50-170"><a href="figure-1.html#cb50-170" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(overlap_met)) {</span>
<span id="cb50-171"><a href="figure-1.html#cb50-171" tabindex="-1"></a>  gene_pos_temp <span class="ot">&lt;-</span> <span class="fu">which</span>(stringr<span class="sc">::</span><span class="fu">str_to_title</span>(<span class="fu">rownames</span>(dd_result)) <span class="sc">==</span> overlap_met[i])</span>
<span id="cb50-172"><a href="figure-1.html#cb50-172" tabindex="-1"></a>  gene_pos <span class="ot">&lt;-</span> <span class="fu">c</span>(gene_pos,gene_pos_temp)</span>
<span id="cb50-173"><a href="figure-1.html#cb50-173" tabindex="-1"></a>}</span>
<span id="cb50-174"><a href="figure-1.html#cb50-174" tabindex="-1"></a><span class="fu">length</span>(gene_pos)</span>
<span id="cb50-175"><a href="figure-1.html#cb50-175" tabindex="-1"></a><span class="fu">setdiff</span>(stringr<span class="sc">::</span><span class="fu">str_to_title</span>(overlap_met),stringr<span class="sc">::</span><span class="fu">str_to_title</span>(<span class="fu">rownames</span>(dd_result)))</span>
<span id="cb50-176"><a href="figure-1.html#cb50-176" tabindex="-1"></a></span>
<span id="cb50-177"><a href="figure-1.html#cb50-177" tabindex="-1"></a>right_anno <span class="ot">&lt;-</span>  <span class="fu">rowAnnotation</span>(<span class="at">mark_gene =</span> <span class="fu">anno_mark</span>(<span class="at">at =</span> gene_pos, </span>
<span id="cb50-178"><a href="figure-1.html#cb50-178" tabindex="-1"></a>                                                   <span class="at">labels =</span> overlap_met,</span>
<span id="cb50-179"><a href="figure-1.html#cb50-179" tabindex="-1"></a>                                                   <span class="at">labels_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">5</span>)))</span>
<span id="cb50-180"><a href="figure-1.html#cb50-180" tabindex="-1"></a></span>
<span id="cb50-181"><a href="figure-1.html#cb50-181" tabindex="-1"></a>top_annotation <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb50-182"><a href="figure-1.html#cb50-182" tabindex="-1"></a>  <span class="at">Type=</span>sample_all<span class="sc">$</span>type,</span>
<span id="cb50-183"><a href="figure-1.html#cb50-183" tabindex="-1"></a>  <span class="at">status=</span>sample_all<span class="sc">$</span><span class="st">`</span><span class="at">status</span><span class="st">`</span>,</span>
<span id="cb50-184"><a href="figure-1.html#cb50-184" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">list</span>(<span class="st">`</span><span class="at">Type</span><span class="st">`</span><span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;D0&quot;</span><span class="ot">=</span><span class="st">&quot;#D01910&quot;</span>,<span class="st">&quot;D14&quot;</span><span class="ot">=</span><span class="st">&quot;#FE7F2D&quot;</span>,<span class="st">&quot;D28&quot;</span><span class="ot">=</span><span class="st">&quot;#006633&quot;</span>,<span class="st">&quot;Cons&quot;</span><span class="ot">=</span><span class="st">&quot;#330066&quot;</span>),</span>
<span id="cb50-185"><a href="figure-1.html#cb50-185" tabindex="-1"></a>           <span class="at">status=</span><span class="fu">c</span>(<span class="st">&quot;MRD-&quot;</span><span class="ot">=</span><span class="st">&quot;#00468BFF&quot;</span>,<span class="st">&quot;MRD+&quot;</span><span class="ot">=</span><span class="st">&quot;#0099B4FF&quot;</span>,<span class="st">&quot;NoCR&quot;</span><span class="ot">=</span><span class="st">&quot;#AD002AFF&quot;</span>)))</span>
<span id="cb50-186"><a href="figure-1.html#cb50-186" tabindex="-1"></a></span>
<span id="cb50-187"><a href="figure-1.html#cb50-187" tabindex="-1"></a>col_fun <span class="ot">=</span> circlize<span class="sc">::</span><span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="fu">c</span>(<span class="st">&quot;#00599F&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;#D01910&quot;</span>))</span>
<span id="cb50-188"><a href="figure-1.html#cb50-188" tabindex="-1"></a></span>
<span id="cb50-189"><a href="figure-1.html#cb50-189" tabindex="-1"></a>p_metabolite <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(dd_result,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">12</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">name=</span><span class="st">&quot;Serum Metabolite&quot;</span>,</span>
<span id="cb50-190"><a href="figure-1.html#cb50-190" tabindex="-1"></a>                        <span class="at">cluster_row_slices =</span> F,<span class="at">border=</span>T,</span>
<span id="cb50-191"><a href="figure-1.html#cb50-191" tabindex="-1"></a>                        <span class="at">cluster_column_slices =</span> F,</span>
<span id="cb50-192"><a href="figure-1.html#cb50-192" tabindex="-1"></a>                        <span class="at">clustering_method_rows =</span> <span class="st">&quot;ward.D&quot;</span>,</span>
<span id="cb50-193"><a href="figure-1.html#cb50-193" tabindex="-1"></a>                        <span class="at">cluster_columns =</span> F,<span class="at">right_annotation =</span> right_anno,</span>
<span id="cb50-194"><a href="figure-1.html#cb50-194" tabindex="-1"></a>                        <span class="co"># clustering_method_columns = &quot;ward.D2&quot;,</span></span>
<span id="cb50-195"><a href="figure-1.html#cb50-195" tabindex="-1"></a>                        <span class="at">column_split =</span> <span class="fu">factor</span>(sample_all<span class="sc">$</span>type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;D0&quot;</span>,<span class="st">&quot;D14&quot;</span>,<span class="st">&quot;D28&quot;</span>,<span class="st">&quot;Cons&quot;</span>)),</span>
<span id="cb50-196"><a href="figure-1.html#cb50-196" tabindex="-1"></a>                        <span class="at">row_split =</span> met<span class="sc">$</span>nn,</span>
<span id="cb50-197"><a href="figure-1.html#cb50-197" tabindex="-1"></a>                        <span class="at">col =</span> col_fun,</span>
<span id="cb50-198"><a href="figure-1.html#cb50-198" tabindex="-1"></a>                        <span class="at">top_annotation =</span>top_annotation,</span>
<span id="cb50-199"><a href="figure-1.html#cb50-199" tabindex="-1"></a>                        <span class="at">show_column_names =</span> F,<span class="at">show_row_names =</span> T,</span>
<span id="cb50-200"><a href="figure-1.html#cb50-200" tabindex="-1"></a>                        <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">2</span>),<span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">3</span>))</span>
<span id="cb50-201"><a href="figure-1.html#cb50-201" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/1C.heatmap-haveHC-0.05-final.pdf&quot;</span>,<span class="at">width =</span> <span class="dv">10</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb50-202"><a href="figure-1.html#cb50-202" tabindex="-1"></a>p_metabolite</span>
<span id="cb50-203"><a href="figure-1.html#cb50-203" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb50-204"><a href="figure-1.html#cb50-204" tabindex="-1"></a></span>
<span id="cb50-205"><a href="figure-1.html#cb50-205" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-206"><a href="figure-1.html#cb50-206" tabindex="-1"></a><span class="co">#  Step 3: Enriched pathways for clustered metabolites</span></span>
<span id="cb50-207"><a href="figure-1.html#cb50-207" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-208"><a href="figure-1.html#cb50-208" tabindex="-1"></a></span>
<span id="cb50-209"><a href="figure-1.html#cb50-209" tabindex="-1"></a>kid <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">6</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-210"><a href="figure-1.html#cb50-210" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-211"><a href="figure-1.html#cb50-211" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Refmet_name,Library,<span class="st">`</span><span class="at">Annotated category</span><span class="st">`</span>,<span class="st">`</span><span class="at">KEGG ID</span><span class="st">`</span>)</span>
<span id="cb50-212"><a href="figure-1.html#cb50-212" tabindex="-1"></a></span>
<span id="cb50-213"><a href="figure-1.html#cb50-213" tabindex="-1"></a>dd <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure1/1C.all_0.05.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-214"><a href="figure-1.html#cb50-214" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-215"><a href="figure-1.html#cb50-215" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;V1&quot;</span><span class="ot">=</span><span class="st">&quot;Refmet_name&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-216"><a href="figure-1.html#cb50-216" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">KEGG ID</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&quot;None&quot;</span>)</span>
<span id="cb50-217"><a href="figure-1.html#cb50-217" tabindex="-1"></a></span>
<span id="cb50-218"><a href="figure-1.html#cb50-218" tabindex="-1"></a>pathway_result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-219"><a href="figure-1.html#cb50-219" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb50-220"><a href="figure-1.html#cb50-220" tabindex="-1"></a>  dd_1 <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span></span>
<span id="cb50-221"><a href="figure-1.html#cb50-221" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(nn<span class="sc">==</span>i) <span class="sc">%&gt;%</span></span>
<span id="cb50-222"><a href="figure-1.html#cb50-222" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(<span class="st">`</span><span class="at">KEGG ID</span><span class="st">`</span>,<span class="at">.keep_all =</span> T)</span>
<span id="cb50-223"><a href="figure-1.html#cb50-223" tabindex="-1"></a>  </span>
<span id="cb50-224"><a href="figure-1.html#cb50-224" tabindex="-1"></a>  dd_1_result <span class="ot">&lt;-</span> <span class="fu">ePEAlyser</span>(dd_1<span class="sc">$</span><span class="st">`</span><span class="at">KEGG ID</span><span class="st">`</span>,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>,</span>
<span id="cb50-225"><a href="figure-1.html#cb50-225" tabindex="-1"></a>                                              <span class="at">p_cutoff =</span> <span class="fl">0.05</span>,<span class="at">noverlap_cutoff =</span> <span class="dv">1</span>,<span class="at">test =</span> <span class="st">&quot;hypergeo&quot;</span>)</span>
<span id="cb50-226"><a href="figure-1.html#cb50-226" tabindex="-1"></a>  </span>
<span id="cb50-227"><a href="figure-1.html#cb50-227" tabindex="-1"></a>  dd_1_result_mutate <span class="ot">&lt;-</span> dd_1_result<span class="sc">$</span>output <span class="sc">%&gt;%</span></span>
<span id="cb50-228"><a href="figure-1.html#cb50-228" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>,i))</span>
<span id="cb50-229"><a href="figure-1.html#cb50-229" tabindex="-1"></a>  pathway_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pathway_result,dd_1_result_mutate)</span>
<span id="cb50-230"><a href="figure-1.html#cb50-230" tabindex="-1"></a>}</span>
<span id="cb50-231"><a href="figure-1.html#cb50-231" tabindex="-1"></a>pathway_result1 <span class="ot">&lt;-</span> pathway_result <span class="sc">%&gt;%</span></span>
<span id="cb50-232"><a href="figure-1.html#cb50-232" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pvalue=</span><span class="fu">ifelse</span>(pvalue <span class="sc">&lt;</span> <span class="fl">8.9e-08</span>,<span class="fl">8.9e-08</span>,pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb50-233"><a href="figure-1.html#cb50-233" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(pvalue)) <span class="sc">%&gt;%</span></span>
<span id="cb50-234"><a href="figure-1.html#cb50-234" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name,<span class="at">levels=</span><span class="fu">unique</span>(name)))</span>
<span id="cb50-235"><a href="figure-1.html#cb50-235" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pathway_result1,<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span><span class="fu">factor</span>(<span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb50-236"><a href="figure-1.html#cb50-236" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>nOverlap,<span class="at">color=</span><span class="sc">-</span><span class="fu">log10</span>(pvalue)))<span class="sc">+</span></span>
<span id="cb50-237"><a href="figure-1.html#cb50-237" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">&quot;top&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-238"><a href="figure-1.html#cb50-238" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;yellow&quot;</span>,<span class="at">high=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-239"><a href="figure-1.html#cb50-239" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb50-240"><a href="figure-1.html#cb50-240" tabindex="-1"></a>  <span class="fu">facet_grid</span>(group<span class="sc">~</span>.,<span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,<span class="at">space=</span><span class="st">&quot;free&quot;</span>,<span class="at">switch=</span><span class="st">&quot;y&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-241"><a href="figure-1.html#cb50-241" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb50-242"><a href="figure-1.html#cb50-242" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb50-243"><a href="figure-1.html#cb50-243" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="cn">NULL</span>)</span>
<span id="cb50-244"><a href="figure-1.html#cb50-244" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/1C.pathway_all.pdf&quot;</span>,p1,<span class="at">width=</span><span class="fl">5.5</span>,<span class="at">height =</span> <span class="fl">7.5</span>)</span>
<span id="cb50-245"><a href="figure-1.html#cb50-245" tabindex="-1"></a></span>
<span id="cb50-246"><a href="figure-1.html#cb50-246" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-247"><a href="figure-1.html#cb50-247" tabindex="-1"></a><span class="co">#  Step 4: The correlation between each cluster with clinical parameters</span></span>
<span id="cb50-248"><a href="figure-1.html#cb50-248" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb50-249"><a href="figure-1.html#cb50-249" tabindex="-1"></a>AH.var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Hb&quot;</span>, <span class="st">&quot;PLT&quot;</span>, <span class="st">&quot;GLU.mM&quot;</span>, <span class="st">&quot;PAB.mg.L&quot;</span>, </span>
<span id="cb50-250"><a href="figure-1.html#cb50-250" tabindex="-1"></a>            <span class="st">&quot;ALT.U.L&quot;</span>, <span class="st">&quot;AST.U.L&quot;</span>, <span class="st">&quot;ALP.IU.L&quot;</span>, <span class="st">&quot;GGT.IU.L&quot;</span>, <span class="st">&quot;TBIL.uM&quot;</span>, <span class="st">&quot;DBIL.uM&quot;</span>, </span>
<span id="cb50-251"><a href="figure-1.html#cb50-251" tabindex="-1"></a>            <span class="st">&quot;TP.g.L&quot;</span>, <span class="st">&quot;ALB.g.L&quot;</span>, <span class="st">&quot;A.G&quot;</span>, <span class="st">&quot;TBA.uM&quot;</span>, <span class="st">&quot;BUN.mM&quot;</span>, <span class="st">&quot;CREA.uM&quot;</span>, <span class="st">&quot;UA.μM&quot;</span>, </span>
<span id="cb50-252"><a href="figure-1.html#cb50-252" tabindex="-1"></a>            <span class="st">&quot;TG.B.mM&quot;</span>, <span class="st">&quot;CHOL.mM&quot;</span>, <span class="st">&quot;HDL.mM&quot;</span>, <span class="st">&quot;LDL.mM&quot;</span>)</span>
<span id="cb50-253"><a href="figure-1.html#cb50-253" tabindex="-1"></a></span>
<span id="cb50-254"><a href="figure-1.html#cb50-254" tabindex="-1"></a>clin_index <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/05 2019ALL代谢组收样临床资料v0606.xlsx&quot;</span>,<span class="at">sheet =</span> <span class="st">&quot;initial&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-255"><a href="figure-1.html#cb50-255" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(bianhao,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb50-256"><a href="figure-1.html#cb50-256" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bianhao_new,<span class="fu">all_of</span>(AH.var)) <span class="sc">%&gt;%</span></span>
<span id="cb50-257"><a href="figure-1.html#cb50-257" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-258"><a href="figure-1.html#cb50-258" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Pid=</span><span class="fu">paste0</span>(<span class="st">&quot;RJ-&quot;</span>,bianhao_new)) <span class="sc">%&gt;%</span></span>
<span id="cb50-259"><a href="figure-1.html#cb50-259" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>bianhao_new) <span class="sc">%&gt;%</span></span>
<span id="cb50-260"><a href="figure-1.html#cb50-260" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CHOL.mM=</span><span class="fu">as.numeric</span>(CHOL.mM)) <span class="sc">%&gt;%</span></span>
<span id="cb50-261"><a href="figure-1.html#cb50-261" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">HDL.mM=</span><span class="fu">as.numeric</span>(HDL.mM))</span>
<span id="cb50-262"><a href="figure-1.html#cb50-262" tabindex="-1"></a></span>
<span id="cb50-263"><a href="figure-1.html#cb50-263" tabindex="-1"></a>sample_patient_A <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-264"><a href="figure-1.html#cb50-264" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-265"><a href="figure-1.html#cb50-265" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-266"><a href="figure-1.html#cb50-266" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(clin_index,<span class="at">by=</span><span class="st">&quot;Pid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-267"><a href="figure-1.html#cb50-267" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,METs_D0_ID,Lineage,Subtype,Age,WBC,</span>
<span id="cb50-268"><a href="figure-1.html#cb50-268" tabindex="-1"></a>                BMI,HBP,OS_stat,OS,EFS_stat,EFS,RFS_stat,RFS,</span>
<span id="cb50-269"><a href="figure-1.html#cb50-269" tabindex="-1"></a>                <span class="fu">all_of</span>(AH.var)) <span class="sc">%&gt;%</span></span>
<span id="cb50-270"><a href="figure-1.html#cb50-270" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">OS=</span>OS<span class="sc">/</span><span class="dv">30</span>,<span class="at">OS_status=</span>OS_stat,</span>
<span id="cb50-271"><a href="figure-1.html#cb50-271" tabindex="-1"></a>                <span class="at">RFS=</span>RFS<span class="sc">/</span><span class="dv">30</span>,<span class="at">RFS_status=</span>RFS_stat,</span>
<span id="cb50-272"><a href="figure-1.html#cb50-272" tabindex="-1"></a>                <span class="at">EFS=</span>EFS<span class="sc">/</span><span class="dv">30</span>,<span class="at">EFS_status=</span>EFS_stat)</span>
<span id="cb50-273"><a href="figure-1.html#cb50-273" tabindex="-1"></a></span>
<span id="cb50-274"><a href="figure-1.html#cb50-274" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb50-275"><a href="figure-1.html#cb50-275" tabindex="-1"></a>  a <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure1/1C.all_0.05.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-276"><a href="figure-1.html#cb50-276" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-277"><a href="figure-1.html#cb50-277" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(nn<span class="sc">==</span>n)</span>
<span id="cb50-278"><a href="figure-1.html#cb50-278" tabindex="-1"></a>  </span>
<span id="cb50-279"><a href="figure-1.html#cb50-279" tabindex="-1"></a>  dd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-280"><a href="figure-1.html#cb50-280" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Metabolite,<span class="fu">all_of</span>(sample_patient_A<span class="sc">$</span>METs_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb50-281"><a href="figure-1.html#cb50-281" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Metabolite <span class="sc">%in%</span> a<span class="sc">$</span>V1) <span class="sc">%&gt;%</span></span>
<span id="cb50-282"><a href="figure-1.html#cb50-282" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-283"><a href="figure-1.html#cb50-283" tabindex="-1"></a>  <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-284"><a href="figure-1.html#cb50-284" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb50-285"><a href="figure-1.html#cb50-285" tabindex="-1"></a>  </span>
<span id="cb50-286"><a href="figure-1.html#cb50-286" tabindex="-1"></a>  module.name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dd)</span>
<span id="cb50-287"><a href="figure-1.html#cb50-287" tabindex="-1"></a>  </span>
<span id="cb50-288"><a href="figure-1.html#cb50-288" tabindex="-1"></a>  plot.name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;BMI&quot;</span>,<span class="st">&quot;WBC&quot;</span>,AH.var)</span>
<span id="cb50-289"><a href="figure-1.html#cb50-289" tabindex="-1"></a>plot.name[<span class="sc">!</span> plot.name <span class="sc">%in%</span> <span class="fu">colnames</span>(sample_patient_A)]</span>
<span id="cb50-290"><a href="figure-1.html#cb50-290" tabindex="-1"></a>plot.info.cat <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb50-291"><a href="figure-1.html#cb50-291" tabindex="-1"></a><span class="cf">for</span> (kkk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plot.name)) {</span>
<span id="cb50-292"><a href="figure-1.html#cb50-292" tabindex="-1"></a>  <span class="fu">print</span>(kkk)</span>
<span id="cb50-293"><a href="figure-1.html#cb50-293" tabindex="-1"></a>  plot.data <span class="ot">&lt;-</span> sample_patient_A</span>
<span id="cb50-294"><a href="figure-1.html#cb50-294" tabindex="-1"></a>  plot.data<span class="sc">$</span>Plot <span class="ot">&lt;-</span> plot.data[, <span class="fu">which</span>(<span class="fu">colnames</span>(plot.data) <span class="sc">==</span> plot.name[kkk])]</span>
<span id="cb50-295"><a href="figure-1.html#cb50-295" tabindex="-1"></a>  plot.data <span class="ot">&lt;-</span> plot.data[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(plot.data<span class="sc">$</span>Plot)), ]</span>
<span id="cb50-296"><a href="figure-1.html#cb50-296" tabindex="-1"></a>  plot.info.cat.sub <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb50-297"><a href="figure-1.html#cb50-297" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(module.name)) {</span>
<span id="cb50-298"><a href="figure-1.html#cb50-298" tabindex="-1"></a>    plot.data<span class="sc">$</span>ME_score <span class="ot">&lt;-</span> dd[module.name[i], plot.data<span class="sc">$</span>METs_D0_ID] <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb50-299"><a href="figure-1.html#cb50-299" tabindex="-1"></a>    sub <span class="ot">&lt;-</span> <span class="fu">c</span>(module.name[i], plot.name[kkk], <span class="fu">cor</span>(plot.data<span class="sc">$</span>ME_score, plot.data<span class="sc">$</span>Plot, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>), </span>
<span id="cb50-300"><a href="figure-1.html#cb50-300" tabindex="-1"></a>             <span class="fu">cor.test</span>(plot.data<span class="sc">$</span>ME_score, plot.data<span class="sc">$</span>Plot, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value, <span class="st">&quot;Spearman&#39;s correlation&quot;</span>)</span>
<span id="cb50-301"><a href="figure-1.html#cb50-301" tabindex="-1"></a>    plot.info.cat.sub <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot.info.cat.sub, sub)</span>
<span id="cb50-302"><a href="figure-1.html#cb50-302" tabindex="-1"></a>  }</span>
<span id="cb50-303"><a href="figure-1.html#cb50-303" tabindex="-1"></a>  plot.info.cat.sub <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(plot.info.cat.sub)</span>
<span id="cb50-304"><a href="figure-1.html#cb50-304" tabindex="-1"></a>  <span class="fu">colnames</span>(plot.info.cat.sub) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Module&quot;</span>, <span class="st">&quot;Factor&quot;</span>, <span class="st">&quot;Type&quot;</span>,<span class="st">&quot;P&quot;</span>, <span class="st">&quot;Test&quot;</span>)</span>
<span id="cb50-305"><a href="figure-1.html#cb50-305" tabindex="-1"></a>  plot.info.cat.sub <span class="ot">&lt;-</span> plot.info.cat.sub <span class="sc">%&gt;%</span> </span>
<span id="cb50-306"><a href="figure-1.html#cb50-306" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Type=</span><span class="fu">as.numeric</span>(Type),</span>
<span id="cb50-307"><a href="figure-1.html#cb50-307" tabindex="-1"></a>           <span class="at">P=</span><span class="fu">as.numeric</span>(P),</span>
<span id="cb50-308"><a href="figure-1.html#cb50-308" tabindex="-1"></a>           <span class="at">Padj=</span><span class="fu">p.adjust</span>(P,<span class="at">method=</span><span class="st">&quot;fdr&quot;</span>)) </span>
<span id="cb50-309"><a href="figure-1.html#cb50-309" tabindex="-1"></a>  plot.info.cat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(plot.info.cat, plot.info.cat.sub)</span>
<span id="cb50-310"><a href="figure-1.html#cb50-310" tabindex="-1"></a>}</span>
<span id="cb50-311"><a href="figure-1.html#cb50-311" tabindex="-1"></a></span>
<span id="cb50-312"><a href="figure-1.html#cb50-312" tabindex="-1"></a>plot.info.cat <span class="ot">&lt;-</span> plot.info.cat <span class="sc">%&gt;%</span> </span>
<span id="cb50-313"><a href="figure-1.html#cb50-313" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Tag=</span><span class="fu">case_when</span>(Type<span class="sc">&lt;</span><span class="dv">0</span><span class="sc">&amp;</span>P<span class="sc">&lt;</span><span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;Negative&quot;</span>,</span>
<span id="cb50-314"><a href="figure-1.html#cb50-314" tabindex="-1"></a>                       Type<span class="sc">&gt;</span><span class="dv">0</span><span class="sc">&amp;</span>P<span class="sc">&lt;</span><span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;Positive&quot;</span>,</span>
<span id="cb50-315"><a href="figure-1.html#cb50-315" tabindex="-1"></a>                       <span class="at">.default=</span><span class="st">&quot;notSig&quot;</span> ))</span>
<span id="cb50-316"><a href="figure-1.html#cb50-316" tabindex="-1"></a></span>
<span id="cb50-317"><a href="figure-1.html#cb50-317" tabindex="-1"></a>AH.var1<span class="ot">=</span><span class="fu">strsplit</span>(AH.var,<span class="st">&quot;[.]&quot;</span>)</span>
<span id="cb50-318"><a href="figure-1.html#cb50-318" tabindex="-1"></a>AH.result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb50-319"><a href="figure-1.html#cb50-319" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(AH.var1)){</span>
<span id="cb50-320"><a href="figure-1.html#cb50-320" tabindex="-1"></a>  AH.result <span class="ot">&lt;-</span> <span class="fu">c</span>(AH.result,AH.var1[[i]][<span class="dv">1</span>])</span>
<span id="cb50-321"><a href="figure-1.html#cb50-321" tabindex="-1"></a>}</span>
<span id="cb50-322"><a href="figure-1.html#cb50-322" tabindex="-1"></a></span>
<span id="cb50-323"><a href="figure-1.html#cb50-323" tabindex="-1"></a>plot.info <span class="ot">&lt;-</span>  plot.info.cat</span>
<span id="cb50-324"><a href="figure-1.html#cb50-324" tabindex="-1"></a>plot.info <span class="ot">&lt;-</span> plot.info <span class="sc">%&gt;%</span> </span>
<span id="cb50-325"><a href="figure-1.html#cb50-325" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(Factor,<span class="at">sep=</span><span class="st">&quot;[.]&quot;</span>,<span class="st">&quot;Factor&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-326"><a href="figure-1.html#cb50-326" tabindex="-1"></a>  <span class="co">#dplyr::mutate(Factor=ifelse(Factor==&quot;A&quot;,&quot;AG&quot;,Factor))</span></span>
<span id="cb50-327"><a href="figure-1.html#cb50-327" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">LogP=</span><span class="sc">-</span><span class="fu">log10</span>(P),</span>
<span id="cb50-328"><a href="figure-1.html#cb50-328" tabindex="-1"></a>                <span class="at">Module=</span><span class="fu">factor</span>(<span class="fu">as.character</span>(Module)),</span>
<span id="cb50-329"><a href="figure-1.html#cb50-329" tabindex="-1"></a>                <span class="at">Factor=</span><span class="fu">factor</span>(<span class="fu">as.character</span>(Factor), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;OS&quot;</span>,<span class="st">&quot;EFS&quot;</span>,<span class="st">&quot;RFS&quot;</span>,</span>
<span id="cb50-330"><a href="figure-1.html#cb50-330" tabindex="-1"></a>                                                               <span class="st">&quot;Age&quot;</span>,<span class="st">&quot;BMI&quot;</span>,<span class="st">&quot;WBC&quot;</span>,AH.result,</span>
<span id="cb50-331"><a href="figure-1.html#cb50-331" tabindex="-1"></a>                                                               <span class="st">&quot;Gender&quot;</span>,<span class="st">&quot;HBP&quot;</span>,<span class="st">&quot;Lineage&quot;</span>,<span class="st">&quot;Subtype&quot;</span>,<span class="st">&quot;d28CR&quot;</span>)))</span>
<span id="cb50-332"><a href="figure-1.html#cb50-332" tabindex="-1"></a></span>
<span id="cb50-333"><a href="figure-1.html#cb50-333" tabindex="-1"></a><span class="fu">write.table</span>(plot.info <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>,n)),<span class="fu">paste0</span>(<span class="st">&quot;result/Figure1/1C.maSigPro/cluster&quot;</span>,n,<span class="st">&quot;.txt&quot;</span>),<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb50-334"><a href="figure-1.html#cb50-334" tabindex="-1"></a></span>
<span id="cb50-335"><a href="figure-1.html#cb50-335" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot.info, <span class="fu">aes</span>(Factor, Module)) <span class="sc">+</span></span>
<span id="cb50-336"><a href="figure-1.html#cb50-336" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> LogP, <span class="at">colour =</span> Tag, <span class="at">fill =</span> Tag), <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb50-337"><a href="figure-1.html#cb50-337" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb50-338"><a href="figure-1.html#cb50-338" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> ggthemes<span class="sc">::</span><span class="fu">theme_base</span>() <span class="sc">+</span> <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb50-339"><a href="figure-1.html#cb50-339" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>))</span>
<span id="cb50-340"><a href="figure-1.html#cb50-340" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>))</span>
<span id="cb50-341"><a href="figure-1.html#cb50-341" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="at">Favorable =</span> <span class="st">&quot;#00599F&quot;</span>, <span class="at">Unfavorable =</span> <span class="st">&quot;#D01910&quot;</span>, </span>
<span id="cb50-342"><a href="figure-1.html#cb50-342" tabindex="-1"></a>                                        <span class="at">Negative =</span> <span class="st">&quot;#009632&quot;</span>, <span class="at">Positive =</span> <span class="st">&quot;#8f00b7&quot;</span>, <span class="at">Sig =</span> <span class="st">&quot;#ed7a00&quot;</span>, <span class="at">Basal =</span> <span class="st">&quot;#ea6c59&quot;</span>, <span class="at">Classical =</span> <span class="st">&quot;#1288a5&quot;</span>, <span class="at">notSig =</span> <span class="st">&quot;#CCCCCC&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb50-343"><a href="figure-1.html#cb50-343" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_blank</span>())</span>
<span id="cb50-344"><a href="figure-1.html#cb50-344" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">&quot;result/Figure1/1C.maSigPro/cluster&quot;</span>,n,<span class="st">&quot;_clinical.pdf&quot;</span>),p,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb50-345"><a href="figure-1.html#cb50-345" tabindex="-1"></a>}</span>
<span id="cb50-346"><a href="figure-1.html#cb50-346" tabindex="-1"></a></span>
<span id="cb50-347"><a href="figure-1.html#cb50-347" tabindex="-1"></a>a_result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb50-348"><a href="figure-1.html#cb50-348" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb50-349"><a href="figure-1.html#cb50-349" tabindex="-1"></a>  a <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(<span class="st">&quot;result/Figure1/1C.maSigPro/cluster&quot;</span>,i,<span class="st">&quot;.txt&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-350"><a href="figure-1.html#cb50-350" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb50-351"><a href="figure-1.html#cb50-351" tabindex="-1"></a>  </span>
<span id="cb50-352"><a href="figure-1.html#cb50-352" tabindex="-1"></a>  a_count <span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span></span>
<span id="cb50-353"><a href="figure-1.html#cb50-353" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(P <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-354"><a href="figure-1.html#cb50-354" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(Factor) <span class="sc">%&gt;%</span></span>
<span id="cb50-355"><a href="figure-1.html#cb50-355" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb50-356"><a href="figure-1.html#cb50-356" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="fu">length</span>(<span class="fu">unique</span>(a<span class="sc">$</span>Module))<span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb50-357"><a href="figure-1.html#cb50-357" tabindex="-1"></a>  </span>
<span id="cb50-358"><a href="figure-1.html#cb50-358" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">8</span>) {</span>
<span id="cb50-359"><a href="figure-1.html#cb50-359" tabindex="-1"></a>    a_filter <span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span></span>
<span id="cb50-360"><a href="figure-1.html#cb50-360" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-361"><a href="figure-1.html#cb50-361" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Tag <span class="sc">!=</span> <span class="st">&quot;notSig&quot;</span> <span class="sc">|</span> Factor <span class="sc">==</span> <span class="st">&quot;CHOL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-362"><a href="figure-1.html#cb50-362" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Factor <span class="sc">%in%</span> <span class="fu">c</span>(a_count<span class="sc">$</span>Factor,<span class="st">&quot;CHOL&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-363"><a href="figure-1.html#cb50-363" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">arrange</span>(P) <span class="sc">%&gt;%</span></span>
<span id="cb50-364"><a href="figure-1.html#cb50-364" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(P,Factor,group,Tag) <span class="sc">%&gt;%</span></span>
<span id="cb50-365"><a href="figure-1.html#cb50-365" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(Factor,<span class="at">.keep_all =</span> T)</span>
<span id="cb50-366"><a href="figure-1.html#cb50-366" tabindex="-1"></a>  }<span class="cf">else</span> {</span>
<span id="cb50-367"><a href="figure-1.html#cb50-367" tabindex="-1"></a>    a_filter <span class="ot">&lt;-</span> a <span class="sc">%&gt;%</span></span>
<span id="cb50-368"><a href="figure-1.html#cb50-368" tabindex="-1"></a>      <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-369"><a href="figure-1.html#cb50-369" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Tag <span class="sc">!=</span> <span class="st">&quot;notSig&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-370"><a href="figure-1.html#cb50-370" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Factor <span class="sc">%in%</span> <span class="fu">c</span>(a_count<span class="sc">$</span>Factor)) <span class="sc">%&gt;%</span></span>
<span id="cb50-371"><a href="figure-1.html#cb50-371" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">arrange</span>(P) <span class="sc">%&gt;%</span></span>
<span id="cb50-372"><a href="figure-1.html#cb50-372" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(P,Factor,group,Tag) <span class="sc">%&gt;%</span></span>
<span id="cb50-373"><a href="figure-1.html#cb50-373" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">distinct</span>(Factor,<span class="at">.keep_all =</span> T)</span>
<span id="cb50-374"><a href="figure-1.html#cb50-374" tabindex="-1"></a>  }</span>
<span id="cb50-375"><a href="figure-1.html#cb50-375" tabindex="-1"></a>  a_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(a_result,a_filter)</span>
<span id="cb50-376"><a href="figure-1.html#cb50-376" tabindex="-1"></a>}</span>
<span id="cb50-377"><a href="figure-1.html#cb50-377" tabindex="-1"></a></span>
<span id="cb50-378"><a href="figure-1.html#cb50-378" tabindex="-1"></a>a_result <span class="ot">&lt;-</span> a_result <span class="sc">%&gt;%</span></span>
<span id="cb50-379"><a href="figure-1.html#cb50-379" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">P=</span><span class="fu">ifelse</span>(P <span class="sc">&lt;</span> <span class="fl">1.401873e-14</span>,<span class="fl">1.401873e-14</span>,P)) <span class="sc">%&gt;%</span></span>
<span id="cb50-380"><a href="figure-1.html#cb50-380" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(P)) <span class="sc">%&gt;%</span></span>
<span id="cb50-381"><a href="figure-1.html#cb50-381" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Factor=</span><span class="fu">factor</span>(Factor,<span class="at">levels=</span><span class="fu">unique</span>(Factor)))</span>
<span id="cb50-382"><a href="figure-1.html#cb50-382" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(a_result,<span class="fu">aes</span>(<span class="at">x=</span>Factor,<span class="at">y=</span><span class="fu">factor</span>(<span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb50-383"><a href="figure-1.html#cb50-383" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="sc">-</span><span class="fu">log10</span>(P),<span class="at">color=</span>Tag))<span class="sc">+</span></span>
<span id="cb50-384"><a href="figure-1.html#cb50-384" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="at">Negative =</span> <span class="st">&quot;#009632&quot;</span>, <span class="at">Positive =</span> <span class="st">&quot;#8f00b7&quot;</span>))<span class="sc">+</span></span>
<span id="cb50-385"><a href="figure-1.html#cb50-385" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb50-386"><a href="figure-1.html#cb50-386" tabindex="-1"></a>  <span class="fu">facet_grid</span>(group<span class="sc">~</span>.,<span class="at">scales =</span> <span class="st">&quot;free&quot;</span>,<span class="at">space=</span><span class="st">&quot;free&quot;</span>,<span class="at">switch=</span><span class="st">&quot;x&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-387"><a href="figure-1.html#cb50-387" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb50-388"><a href="figure-1.html#cb50-388" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb50-389"><a href="figure-1.html#cb50-389" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="cn">NULL</span>)</span>
<span id="cb50-390"><a href="figure-1.html#cb50-390" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/1C.clinical_all-v1022.pdf&quot;</span>,p1,<span class="at">width=</span><span class="fl">2.5</span>,<span class="at">height =</span> <span class="fl">8.5</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/1C.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="s1-a-clinical-characteristics" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> (S1 A) Clinical characteristics<a href="figure-1.html#s1-a-clinical-characteristics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Clinical characteristics of all involved ALL patients.</strong> Age &gt;=65: aged, 40~64 middle age, 15~39: AYA (adolescent and young adult); BMI (body mass index) &lt;18.5: underweight, 18.5~23.9: normal, 24~27.9: overweight, &gt;= 28: fat. HBP is blood pressure over 140/90 mmHg; BM blasts and PB blasts are represented by blasts cells percentage in BM and PB, respectively.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="figure-1.html#cb51-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-2"><a href="figure-1.html#cb51-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-3"><a href="figure-1.html#cb51-3" tabindex="-1"></a></span>
<span id="cb51-4"><a href="figure-1.html#cb51-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb51-5"><a href="figure-1.html#cb51-5" tabindex="-1"></a><span class="co">#  Step 1: Load clinical data and set parameters</span></span>
<span id="cb51-6"><a href="figure-1.html#cb51-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb51-7"><a href="figure-1.html#cb51-7" tabindex="-1"></a>dat_sample <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="figure-1.html#cb51-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb51-9"><a href="figure-1.html#cb51-9" tabindex="-1"></a></span>
<span id="cb51-10"><a href="figure-1.html#cb51-10" tabindex="-1"></a><span class="do">## Clinical characteristics</span></span>
<span id="cb51-11"><a href="figure-1.html#cb51-11" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat_sample <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="figure-1.html#cb51-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">BMI_Type =</span> <span class="fu">ifelse</span>(BMI <span class="sc">&lt;</span> <span class="fl">18.5</span>,<span class="st">&quot;Underweight&quot;</span>,</span>
<span id="cb51-13"><a href="figure-1.html#cb51-13" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(BMI <span class="sc">&gt;=</span> <span class="fl">18.5</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">24</span>,<span class="st">&quot;Normal&quot;</span>,</span>
<span id="cb51-14"><a href="figure-1.html#cb51-14" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(BMI <span class="sc">&gt;=</span> <span class="dv">24</span> <span class="sc">&amp;</span> BMI <span class="sc">&lt;</span> <span class="dv">28</span>,<span class="st">&quot;Overweight&quot;</span>,</span>
<span id="cb51-15"><a href="figure-1.html#cb51-15" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(BMI <span class="sc">&gt;=</span> <span class="dv">28</span>,<span class="st">&quot;Fat&quot;</span>,<span class="cn">NA</span>))))) <span class="sc">%&gt;%</span></span>
<span id="cb51-16"><a href="figure-1.html#cb51-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Age_Type =</span> <span class="fu">ifelse</span>(Age <span class="sc">&gt;=</span> <span class="dv">65</span>,<span class="st">&quot;Aged&quot;</span>,</span>
<span id="cb51-17"><a href="figure-1.html#cb51-17" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(Age <span class="sc">&gt;=</span> <span class="dv">40</span> <span class="sc">&amp;</span> Age <span class="sc">&lt;</span> <span class="dv">65</span>,<span class="st">&quot;Middle&quot;</span>,</span>
<span id="cb51-18"><a href="figure-1.html#cb51-18" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(Age <span class="sc">&lt;</span> <span class="dv">40</span> <span class="sc">&amp;</span> Age <span class="sc">&gt;=</span> <span class="dv">15</span>,<span class="st">&quot;AYA&quot;</span>,<span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="figure-1.html#cb51-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">BM_Blast=</span><span class="fu">as.numeric</span>(BM_Blast)) <span class="sc">%&gt;%</span></span>
<span id="cb51-20"><a href="figure-1.html#cb51-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">PB_Blast=</span><span class="fu">as.numeric</span>(PB_Blast)) <span class="sc">%&gt;%</span></span>
<span id="cb51-21"><a href="figure-1.html#cb51-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">BM_Blast_Type=</span><span class="fu">ifelse</span>(BM_Blast <span class="sc">&gt;=</span> <span class="dv">90</span>,<span class="st">&quot;&gt;90%&quot;</span>,</span>
<span id="cb51-22"><a href="figure-1.html#cb51-22" tabindex="-1"></a>                              <span class="fu">ifelse</span>(BM_Blast <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;</span> BM_Blast <span class="sc">&lt;</span> <span class="dv">90</span>,<span class="st">&quot;20%~90%&quot;</span>,</span>
<span id="cb51-23"><a href="figure-1.html#cb51-23" tabindex="-1"></a>                              <span class="fu">ifelse</span>(BM_Blast <span class="sc">&lt;</span> <span class="dv">20</span>,<span class="st">&quot;&lt;20%&quot;</span>,<span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb51-24"><a href="figure-1.html#cb51-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">PB_Blast_Type=</span><span class="fu">ifelse</span>(PB_Blast <span class="sc">&gt;=</span> <span class="dv">90</span>,<span class="st">&quot;high&quot;</span>,</span>
<span id="cb51-25"><a href="figure-1.html#cb51-25" tabindex="-1"></a>                                     <span class="fu">ifelse</span>(PB_Blast <span class="sc">&lt;</span> <span class="dv">90</span>,<span class="st">&quot;low&quot;</span>,<span class="cn">NA</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb51-26"><a href="figure-1.html#cb51-26" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;Sex&quot;</span> <span class="ot">=</span> <span class="st">&quot;Gender&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-27"><a href="figure-1.html#cb51-27" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,Lineage,BMI_Type,Age_Type,Sex,HBP,BM_Blast_Type,PB_Blast_Type)  </span>
<span id="cb51-28"><a href="figure-1.html#cb51-28" tabindex="-1"></a></span>
<span id="cb51-29"><a href="figure-1.html#cb51-29" tabindex="-1"></a>dat_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat,<span class="at">id=</span><span class="fu">c</span>(<span class="st">&quot;Pid&quot;</span>,<span class="st">&quot;Lineage&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-30"><a href="figure-1.html#cb51-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Lineage,variable,value) <span class="sc">%&gt;%</span></span>
<span id="cb51-31"><a href="figure-1.html#cb51-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb51-32"><a href="figure-1.html#cb51-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">vv=</span><span class="fu">paste0</span>(value,<span class="st">&quot; (&quot;</span>,n,<span class="st">&quot;)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-33"><a href="figure-1.html#cb51-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">ifelse</span>(Lineage<span class="sc">==</span><span class="st">&quot;T&quot;</span>,<span class="sc">-</span>n,n)) <span class="sc">%&gt;%</span></span>
<span id="cb51-34"><a href="figure-1.html#cb51-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">value=</span><span class="fu">factor</span>(value,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Fat&quot;</span>,<span class="st">&quot;Overweight&quot;</span>,<span class="st">&quot;Normal&quot;</span>,<span class="st">&quot;Underweight&quot;</span>,<span class="st">&quot;Aged&quot;</span>,<span class="st">&quot;Middle&quot;</span>,<span class="st">&quot;AYA&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;Y&quot;</span>,<span class="st">&quot;20%~90%&quot;</span>,<span class="st">&quot;&lt;20%&quot;</span>,<span class="st">&quot;&gt;90%&quot;</span>,<span class="st">&quot;low&quot;</span>,<span class="st">&quot;high&quot;</span>)))</span>
<span id="cb51-35"><a href="figure-1.html#cb51-35" tabindex="-1"></a></span>
<span id="cb51-36"><a href="figure-1.html#cb51-36" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb51-37"><a href="figure-1.html#cb51-37" tabindex="-1"></a><span class="co">#  Step 2: Visualization</span></span>
<span id="cb51-38"><a href="figure-1.html#cb51-38" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb51-39"><a href="figure-1.html#cb51-39" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt,<span class="fu">aes</span>(variable,n,<span class="at">fill=</span>value))<span class="sc">+</span></span>
<span id="cb51-40"><a href="figure-1.html#cb51-40" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="at">width=</span>.<span class="dv">7</span>)<span class="sc">+</span></span>
<span id="cb51-41"><a href="figure-1.html#cb51-41" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>vv),<span class="at">size=</span><span class="dv">2</span>,<span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb51-42"><a href="figure-1.html#cb51-42" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb51-43"><a href="figure-1.html#cb51-43" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.border =</span> <span class="fu">element_blank</span>(),<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-44"><a href="figure-1.html#cb51-44" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-45"><a href="figure-1.html#cb51-45" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="sc">+</span></span>
<span id="cb51-46"><a href="figure-1.html#cb51-46" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Underweight&quot;</span><span class="ot">=</span><span class="st">&quot;#FDBF6F&quot;</span>,<span class="st">&quot;Normal&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>, <span class="st">&quot;Overweight&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;Fat&quot;</span><span class="ot">=</span><span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;Aged&quot;</span><span class="ot">=</span><span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;Middle&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>,<span class="st">&quot;AYA&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;M&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;N&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>,<span class="st">&quot;Y&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;20%~90%&quot;</span><span class="ot">=</span><span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;&gt;90%&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;&lt;20%&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>,<span class="st">&quot;low&quot;</span><span class="ot">=</span><span class="st">&quot;#00C1E3&quot;</span>,<span class="st">&quot;high&quot;</span><span class="ot">=</span><span class="st">&quot;#FD6AB0&quot;</span>,<span class="st">&quot;normal&quot;</span><span class="ot">=</span><span class="st">&quot;#E5E059&quot;</span>))<span class="sc">+</span></span>
<span id="cb51-47"><a href="figure-1.html#cb51-47" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>)<span class="sc">+</span></span>
<span id="cb51-48"><a href="figure-1.html#cb51-48" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb51-49"><a href="figure-1.html#cb51-49" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S1A_ClinicalCharacteristics.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">20</span>,<span class="at">height =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S1A.png" width="598" style="display: block; margin: auto;" /></p>
</div>
<div id="s1-b-venn-plot" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> (S1 B) Venn plot<a href="figure-1.html#s1-b-venn-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>The Venn plot of all primary cases involved in each omics study. </strong></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="figure-1.html#cb52-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-2"><a href="figure-1.html#cb52-2" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb52-3"><a href="figure-1.html#cb52-3" tabindex="-1"></a></span>
<span id="cb52-4"><a href="figure-1.html#cb52-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb52-5"><a href="figure-1.html#cb52-5" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb52-6"><a href="figure-1.html#cb52-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb52-7"><a href="figure-1.html#cb52-7" tabindex="-1"></a>dat <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="figure-1.html#cb52-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb52-9"><a href="figure-1.html#cb52-9" tabindex="-1"></a></span>
<span id="cb52-10"><a href="figure-1.html#cb52-10" tabindex="-1"></a><span class="do">## serum</span></span>
<span id="cb52-11"><a href="figure-1.html#cb52-11" tabindex="-1"></a>dat_serum <span class="ot">&lt;-</span> dat</span>
<span id="cb52-12"><a href="figure-1.html#cb52-12" tabindex="-1"></a></span>
<span id="cb52-13"><a href="figure-1.html#cb52-13" tabindex="-1"></a><span class="do">## cell</span></span>
<span id="cb52-14"><a href="figure-1.html#cb52-14" tabindex="-1"></a>dat_cell <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="figure-1.html#cb52-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METc_BM_D0_ID)<span class="sc">|!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">METc_BM_MRD-_ID</span><span class="st">`</span>)<span class="sc">|!</span><span class="fu">is.na</span>(METc_PB_D0_ID))</span>
<span id="cb52-16"><a href="figure-1.html#cb52-16" tabindex="-1"></a></span>
<span id="cb52-17"><a href="figure-1.html#cb52-17" tabindex="-1"></a><span class="do">## RNA_seq</span></span>
<span id="cb52-18"><a href="figure-1.html#cb52-18" tabindex="-1"></a>dat_RNA <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb52-19"><a href="figure-1.html#cb52-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_ID))</span>
<span id="cb52-20"><a href="figure-1.html#cb52-20" tabindex="-1"></a></span>
<span id="cb52-21"><a href="figure-1.html#cb52-21" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb52-22"><a href="figure-1.html#cb52-22" tabindex="-1"></a><span class="co">#  Step 2: Venn Diagram</span></span>
<span id="cb52-23"><a href="figure-1.html#cb52-23" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb52-24"><a href="figure-1.html#cb52-24" tabindex="-1"></a>venn.plot <span class="ot">&lt;-</span> <span class="fu">venn.diagram</span>(</span>
<span id="cb52-25"><a href="figure-1.html#cb52-25" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb52-26"><a href="figure-1.html#cb52-26" tabindex="-1"></a>    <span class="at">Serum =</span> dat_serum<span class="sc">$</span>Pid,</span>
<span id="cb52-27"><a href="figure-1.html#cb52-27" tabindex="-1"></a>    <span class="at">Cell =</span> dat_cell<span class="sc">$</span>Pid,</span>
<span id="cb52-28"><a href="figure-1.html#cb52-28" tabindex="-1"></a>    <span class="at">RNA =</span> dat_RNA<span class="sc">$</span>Pid</span>
<span id="cb52-29"><a href="figure-1.html#cb52-29" tabindex="-1"></a>  ),</span>
<span id="cb52-30"><a href="figure-1.html#cb52-30" tabindex="-1"></a>  <span class="at">filename =</span> <span class="cn">NULL</span>,</span>
<span id="cb52-31"><a href="figure-1.html#cb52-31" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb52-32"><a href="figure-1.html#cb52-32" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#E6AB02&quot;</span>, <span class="st">&quot;#1F78B4&quot;</span>, <span class="st">&quot;#E7298A&quot;</span>),</span>
<span id="cb52-33"><a href="figure-1.html#cb52-33" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb52-34"><a href="figure-1.html#cb52-34" tabindex="-1"></a>  <span class="at">label.col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>,</span>
<span id="cb52-35"><a href="figure-1.html#cb52-35" tabindex="-1"></a>                       <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb52-36"><a href="figure-1.html#cb52-36" tabindex="-1"></a>                       <span class="at">cex =</span> <span class="fl">2.5</span>,</span>
<span id="cb52-37"><a href="figure-1.html#cb52-37" tabindex="-1"></a>  <span class="at">fontfamily =</span> <span class="st">&quot;serif&quot;</span>,</span>
<span id="cb52-38"><a href="figure-1.html#cb52-38" tabindex="-1"></a>  <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb52-39"><a href="figure-1.html#cb52-39" tabindex="-1"></a>  <span class="at">cat.default.pos =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb52-40"><a href="figure-1.html#cb52-40" tabindex="-1"></a>  <span class="at">cat.col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb52-41"><a href="figure-1.html#cb52-41" tabindex="-1"></a>  <span class="at">cat.cex =</span> <span class="fl">2.5</span>,</span>
<span id="cb52-42"><a href="figure-1.html#cb52-42" tabindex="-1"></a>  <span class="at">cat.fontfamily =</span> <span class="st">&quot;serif&quot;</span>,</span>
<span id="cb52-43"><a href="figure-1.html#cb52-43" tabindex="-1"></a>  <span class="at">cat.dist =</span> <span class="fu">c</span>(<span class="fl">0.06</span>, <span class="fl">0.06</span>, <span class="fl">0.03</span>),</span>
<span id="cb52-44"><a href="figure-1.html#cb52-44" tabindex="-1"></a>  <span class="at">cat.pos =</span> <span class="dv">0</span></span>
<span id="cb52-45"><a href="figure-1.html#cb52-45" tabindex="-1"></a>)</span>
<span id="cb52-46"><a href="figure-1.html#cb52-46" tabindex="-1"></a></span>
<span id="cb52-47"><a href="figure-1.html#cb52-47" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/S1B_Venn.pdf&quot;</span>,<span class="at">width=</span><span class="dv">10</span>,<span class="at">height =</span> <span class="dv">10</span>)</span>
<span id="cb52-48"><a href="figure-1.html#cb52-48" tabindex="-1"></a><span class="fu">grid.draw</span>(venn.plot)</span>
<span id="cb52-49"><a href="figure-1.html#cb52-49" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S1B.png" width="368" style="display: block; margin: auto;" /></p>
</div>
<div id="s1-c-waterfall-plot" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> (S1 C) Waterfall plot<a href="figure-1.html#s1-c-waterfall-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Left, the waterfall plot of genetic alterations in each ALL patients. The upper panel represents mutation events, the middle panel indicates the expression of Ik6 transcripts and the lower panel corresponds to fusion/rearrangement events. Right, the upper boxplots represent the alteration frequencies of gene sequence variations in each case, and the types of mutations of indicated genes. The lower boxplot shows the number of gene fusion/rearrangement events in this series. The genetic alterations were mainly detected by RNA-seq while Ik6 transcripts were identified by RT-PCR (For details, see Methods).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="figure-1.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-2"><a href="figure-1.html#cb53-2" tabindex="-1"></a><span class="fu">library</span>(ComplexHeatmap)</span>
<span id="cb53-3"><a href="figure-1.html#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="figure-1.html#cb53-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-5"><a href="figure-1.html#cb53-5" tabindex="-1"></a><span class="co">#  Step 1: Load data and filter genetic alterations</span></span>
<span id="cb53-6"><a href="figure-1.html#cb53-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-7"><a href="figure-1.html#cb53-7" tabindex="-1"></a>dd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/sample_clinical_201_info.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="figure-1.html#cb53-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="figure-1.html#cb53-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="figure-1.html#cb53-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Pid,Lineage,RNA_id_raw) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="figure-1.html#cb53-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;RNA_id&quot;</span><span class="ot">=</span><span class="st">&quot;RNA_id_raw&quot;</span>,<span class="st">&quot;Subtype&quot;</span><span class="ot">=</span><span class="st">&quot;Lineage&quot;</span>)</span>
<span id="cb53-12"><a href="figure-1.html#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="figure-1.html#cb53-13" tabindex="-1"></a><span class="do">## Fusion</span></span>
<span id="cb53-14"><a href="figure-1.html#cb53-14" tabindex="-1"></a>fusion_T <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/fusion_T_v0803.xlsx&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="figure-1.html#cb53-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="figure-1.html#cb53-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,final_check) <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="figure-1.html#cb53-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(final_check)) <span class="sc">%&gt;%</span></span>
<span id="cb53-18"><a href="figure-1.html#cb53-18" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(final_check,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) </span>
<span id="cb53-19"><a href="figure-1.html#cb53-19" tabindex="-1"></a></span>
<span id="cb53-20"><a href="figure-1.html#cb53-20" tabindex="-1"></a>fusion_B <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/fusion_B_v0803.xlsx&quot;</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-21"><a href="figure-1.html#cb53-21" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="figure-1.html#cb53-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,fusion_group) <span class="sc">%&gt;%</span></span>
<span id="cb53-23"><a href="figure-1.html#cb53-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(fusion_group)) <span class="sc">%&gt;%</span></span>
<span id="cb53-24"><a href="figure-1.html#cb53-24" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate_rows</span>(fusion_group,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-25"><a href="figure-1.html#cb53-25" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;final_check&quot;</span><span class="ot">=</span><span class="st">&quot;fusion_group&quot;</span>)</span>
<span id="cb53-26"><a href="figure-1.html#cb53-26" tabindex="-1"></a></span>
<span id="cb53-27"><a href="figure-1.html#cb53-27" tabindex="-1"></a>fusion <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fusion_T,fusion_B) <span class="sc">%&gt;%</span></span>
<span id="cb53-28"><a href="figure-1.html#cb53-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(RNA_id <span class="sc">%in%</span> dd<span class="sc">$</span>RNA_id) <span class="sc">%&gt;%</span></span>
<span id="cb53-29"><a href="figure-1.html#cb53-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(RNA_id,dd<span class="sc">$</span>RNA_id))</span>
<span id="cb53-30"><a href="figure-1.html#cb53-30" tabindex="-1"></a></span>
<span id="cb53-31"><a href="figure-1.html#cb53-31" tabindex="-1"></a><span class="do">## Mutation</span></span>
<span id="cb53-32"><a href="figure-1.html#cb53-32" tabindex="-1"></a>mutation_T <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_T_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-33"><a href="figure-1.html#cb53-33" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-34"><a href="figure-1.html#cb53-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17,V19) <span class="sc">%&gt;%</span></span>
<span id="cb53-35"><a href="figure-1.html#cb53-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;V2&quot;</span>,<span class="st">&quot;Gene.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V17&quot;</span>,<span class="st">&quot;ExonicFunc.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V19&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-36"><a href="figure-1.html#cb53-36" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-37"><a href="figure-1.html#cb53-37" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="ot">=</span></span>
<span id="cb53-38"><a href="figure-1.html#cb53-38" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;frameshift deletion&quot;</span>,<span class="st">&quot;frameshift insertion&quot;</span>,<span class="st">&quot;frameshift substitution&quot;</span>),<span class="st">&quot;Frameshift&quot;</span>,</span>
<span id="cb53-39"><a href="figure-1.html#cb53-39" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;nonframeshift deletion&quot;</span>,<span class="st">&quot;nonframeshift insertion&quot;</span>,<span class="st">&quot;nonframeshift substitution&quot;</span>),<span class="st">&quot;Nonframeshift&quot;</span>,</span>
<span id="cb53-40"><a href="figure-1.html#cb53-40" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;.&quot;</span>,<span class="st">&quot;Splice&quot;</span>,</span>
<span id="cb53-41"><a href="figure-1.html#cb53-41" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;nonsynonymous SNV&quot;</span>,<span class="st">&quot;Missense&quot;</span>,                <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;startloss&quot;</span>,<span class="st">&quot;Startloss&quot;</span>,</span>
<span id="cb53-42"><a href="figure-1.html#cb53-42" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;stopgain&quot;</span>,<span class="st">&quot;Stopgain&quot;</span>,</span>
<span id="cb53-43"><a href="figure-1.html#cb53-43" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;synonymous SNV&quot;</span>,<span class="st">&quot;Silent&quot;</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>)))))))) <span class="sc">%&gt;%</span></span>
<span id="cb53-44"><a href="figure-1.html#cb53-44" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-45"><a href="figure-1.html#cb53-45" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-46"><a href="figure-1.html#cb53-46" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Gene.refGene)</span>
<span id="cb53-47"><a href="figure-1.html#cb53-47" tabindex="-1"></a></span>
<span id="cb53-48"><a href="figure-1.html#cb53-48" tabindex="-1"></a>mutation_B <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_B_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-49"><a href="figure-1.html#cb53-49" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-50"><a href="figure-1.html#cb53-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17,V19) <span class="sc">%&gt;%</span></span>
<span id="cb53-51"><a href="figure-1.html#cb53-51" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;V2&quot;</span>,<span class="st">&quot;Gene.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V17&quot;</span>,<span class="st">&quot;ExonicFunc.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V19&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-52"><a href="figure-1.html#cb53-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-53"><a href="figure-1.html#cb53-53" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="ot">=</span></span>
<span id="cb53-54"><a href="figure-1.html#cb53-54" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;frameshift deletion&quot;</span>,<span class="st">&quot;frameshift insertion&quot;</span>,<span class="st">&quot;frameshift substitution&quot;</span>),<span class="st">&quot;Frameshift&quot;</span>,</span>
<span id="cb53-55"><a href="figure-1.html#cb53-55" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;nonframeshift deletion&quot;</span>,<span class="st">&quot;nonframeshift insertion&quot;</span>,<span class="st">&quot;nonframeshift substitution&quot;</span>),<span class="st">&quot;Nonframeshift&quot;</span>,</span>
<span id="cb53-56"><a href="figure-1.html#cb53-56" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;.&quot;</span>,<span class="st">&quot;Splice&quot;</span>,</span>
<span id="cb53-57"><a href="figure-1.html#cb53-57" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;nonsynonymous SNV&quot;</span>,<span class="st">&quot;Missense&quot;</span>,</span>
<span id="cb53-58"><a href="figure-1.html#cb53-58" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;startloss&quot;</span>,<span class="st">&quot;Startloss&quot;</span>,</span>
<span id="cb53-59"><a href="figure-1.html#cb53-59" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;stopgain&quot;</span>,<span class="st">&quot;Stopgain&quot;</span>,</span>
<span id="cb53-60"><a href="figure-1.html#cb53-60" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;synonymous SNV&quot;</span>,<span class="st">&quot;Silent&quot;</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>)))))))) <span class="sc">%&gt;%</span></span>
<span id="cb53-61"><a href="figure-1.html#cb53-61" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-62"><a href="figure-1.html#cb53-62" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-63"><a href="figure-1.html#cb53-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Gene.refGene)</span>
<span id="cb53-64"><a href="figure-1.html#cb53-64" tabindex="-1"></a></span>
<span id="cb53-65"><a href="figure-1.html#cb53-65" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mutation_T,mutation_B) <span class="sc">%&gt;%</span></span>
<span id="cb53-66"><a href="figure-1.html#cb53-66" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ID <span class="sc">%in%</span> dd<span class="sc">$</span>RNA_id) <span class="sc">%&gt;%</span></span>
<span id="cb53-67"><a href="figure-1.html#cb53-67" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(ID,dd<span class="sc">$</span>RNA_id)) <span class="sc">%&gt;%</span></span>
<span id="cb53-68"><a href="figure-1.html#cb53-68" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb53-69"><a href="figure-1.html#cb53-69" tabindex="-1"></a></span>
<span id="cb53-70"><a href="figure-1.html#cb53-70" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-71"><a href="figure-1.html#cb53-71" tabindex="-1"></a><span class="co">#  Step 2: Set sample order and set parameters</span></span>
<span id="cb53-72"><a href="figure-1.html#cb53-72" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-73"><a href="figure-1.html#cb53-73" tabindex="-1"></a><span class="do">## Set sample order</span></span>
<span id="cb53-74"><a href="figure-1.html#cb53-74" tabindex="-1"></a>sample_order <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span></span>
<span id="cb53-75"><a href="figure-1.html#cb53-75" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">full_join</span>(fusion,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;RNA_id&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-76"><a href="figure-1.html#cb53-76" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(dd,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;RNA_id&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-77"><a href="figure-1.html#cb53-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Gene.refGene,<span class="fu">c</span>(<span class="st">&quot;NOTCH1&quot;</span>,<span class="st">&quot;KMT2C&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;RUNX1&quot;</span>,<span class="st">&quot;SETD2&quot;</span>,<span class="st">&quot;CTCF&quot;</span>,<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;ETV6&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">&quot;KMT2D&quot;</span>,<span class="st">&quot;PHF6&quot;</span>,<span class="st">&quot;KMT2A&quot;</span>,<span class="st">&quot;PAX5&quot;</span>,<span class="st">&quot;TP53&quot;</span>,<span class="st">&quot;JAK3&quot;</span>,<span class="st">&quot;NCOR2&quot;</span>,<span class="st">&quot;SUZ12&quot;</span>,<span class="st">&quot;ARID1B&quot;</span>,<span class="st">&quot;ATRX&quot;</span>,<span class="st">&quot;IKZF1&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;PTEN&quot;</span>,<span class="st">&quot;EP300&quot;</span>,<span class="st">&quot;SETD1B&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;ARID1A&quot;</span>,<span class="st">&quot;NF1&quot;</span>,<span class="st">&quot;JAK1&quot;</span>,<span class="st">&quot;MGA&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>,<span class="st">&quot;SACS&quot;</span>,<span class="st">&quot;SH2B3&quot;</span>,<span class="st">&quot;STAT5B&quot;</span>,<span class="st">&quot;TET2&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-78"><a href="figure-1.html#cb53-78" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(final_check,<span class="fu">c</span>(<span class="st">&quot;BCR-ABL1&quot;</span>,<span class="st">&quot;ZNF384 fusion&quot;</span>,<span class="st">&quot;DUX4 rearrangement&quot;</span>,<span class="st">&quot;TCF3-PBX1&quot;</span>,<span class="st">&quot;KMT2A rearrangement&quot;</span>,<span class="st">&quot;PAX5-ETV6&quot;</span>,<span class="st">&quot;MEF2D rearrangement&quot;</span>,<span class="st">&quot;BCL2/MYC&quot;</span>,<span class="st">&quot;MLLT10 rearrangement&quot;</span>,<span class="st">&quot;SET-NUP214&quot;</span>,<span class="st">&quot;STIL-TAL1&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-79"><a href="figure-1.html#cb53-79" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Subtype,<span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;T&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-80"><a href="figure-1.html#cb53-80" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(ID,<span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb53-81"><a href="figure-1.html#cb53-81" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Lineage=</span><span class="fu">ifelse</span>(Subtype<span class="sc">==</span><span class="st">&quot;B&quot;</span>,<span class="st">&quot;BCP-ALL&quot;</span>,</span>
<span id="cb53-82"><a href="figure-1.html#cb53-82" tabindex="-1"></a>                        <span class="fu">ifelse</span>(Subtype<span class="sc">==</span><span class="st">&quot;T&quot;</span>,<span class="st">&quot;T-ALL&quot;</span>,Subtype)))</span>
<span id="cb53-83"><a href="figure-1.html#cb53-83" tabindex="-1"></a></span>
<span id="cb53-84"><a href="figure-1.html#cb53-84" tabindex="-1"></a><span class="do">## Ik6</span></span>
<span id="cb53-85"><a href="figure-1.html#cb53-85" tabindex="-1"></a>Ik6 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Sample_RNA_190_fusion_mutation_v1130.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-86"><a href="figure-1.html#cb53-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(RNA_id <span class="sc">%in%</span> dd<span class="sc">$</span>RNA_id) <span class="sc">%&gt;%</span></span>
<span id="cb53-87"><a href="figure-1.html#cb53-87" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,<span class="st">`</span><span class="at">备注...20</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-88"><a href="figure-1.html#cb53-88" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(RNA_id,sample_order<span class="sc">$</span>RNA_id)) <span class="sc">%&gt;%</span></span>
<span id="cb53-89"><a href="figure-1.html#cb53-89" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Ik6=</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">备注...20</span><span class="st">`</span>),<span class="st">&quot;no&quot;</span>,</span>
<span id="cb53-90"><a href="figure-1.html#cb53-90" tabindex="-1"></a>                    <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">备注...20</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;发现TLX1基因表达&quot;</span>,<span class="st">&quot;发现TLX3基因表达&quot;</span>,<span class="st">&quot;发现IKZF1基因Ik8转录本&quot;</span>),<span class="st">&quot;no&quot;</span>,<span class="st">&quot;yes&quot;</span>)))</span>
<span id="cb53-91"><a href="figure-1.html#cb53-91" tabindex="-1"></a></span>
<span id="cb53-92"><a href="figure-1.html#cb53-92" tabindex="-1"></a><span class="do">## Fusion</span></span>
<span id="cb53-93"><a href="figure-1.html#cb53-93" tabindex="-1"></a>clinical_fusion_dcast <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(fusion,RNA_id <span class="sc">~</span> final_check) <span class="sc">%&gt;%</span></span>
<span id="cb53-94"><a href="figure-1.html#cb53-94" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(dd,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;RNA_id&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-95"><a href="figure-1.html#cb53-95" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Pid,<span class="sc">-</span>Subtype) <span class="sc">%&gt;%</span></span>
<span id="cb53-96"><a href="figure-1.html#cb53-96" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;RNA_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-97"><a href="figure-1.html#cb53-97" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">STIL-TAL1</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-98"><a href="figure-1.html#cb53-98" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">SET-NUP214</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-99"><a href="figure-1.html#cb53-99" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">MLLT10 rearrangement</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-100"><a href="figure-1.html#cb53-100" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">BCL2/MYC</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-101"><a href="figure-1.html#cb53-101" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">MEF2D rearrangement</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-102"><a href="figure-1.html#cb53-102" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">PAX5-ETV6</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-103"><a href="figure-1.html#cb53-103" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">KMT2A rearrangement</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-104"><a href="figure-1.html#cb53-104" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">TCF3-PBX1</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-105"><a href="figure-1.html#cb53-105" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">DUX4 rearrangement</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-106"><a href="figure-1.html#cb53-106" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">ZNF384 fusion</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-107"><a href="figure-1.html#cb53-107" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="st">`</span><span class="at">BCR-ABL1</span><span class="st">`</span>)</span>
<span id="cb53-108"><a href="figure-1.html#cb53-108" tabindex="-1"></a></span>
<span id="cb53-109"><a href="figure-1.html#cb53-109" tabindex="-1"></a>clinical_fusion_dcast[<span class="fu">is.na</span>(clinical_fusion_dcast)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-110"><a href="figure-1.html#cb53-110" tabindex="-1"></a>clinical_fusion_dcast[clinical_fusion_dcast <span class="sc">!=</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-111"><a href="figure-1.html#cb53-111" tabindex="-1"></a></span>
<span id="cb53-112"><a href="figure-1.html#cb53-112" tabindex="-1"></a>d_fusion <span class="ot">&lt;-</span> <span class="fu">t</span>(clinical_fusion_dcast) <span class="sc">%&gt;%</span></span>
<span id="cb53-113"><a href="figure-1.html#cb53-113" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-114"><a href="figure-1.html#cb53-114" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;fusion&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-115"><a href="figure-1.html#cb53-115" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(fusion,<span class="fu">c</span>(<span class="st">&quot;BCR-ABL1&quot;</span>,<span class="st">&quot;ZNF384 fusion&quot;</span>,<span class="st">&quot;DUX4 rearrangement&quot;</span>,<span class="st">&quot;TCF3-PBX1&quot;</span>,<span class="st">&quot;KMT2A rearrangement&quot;</span>,<span class="st">&quot;PAX5-ETV6&quot;</span>,<span class="st">&quot;MEF2D rearrangement&quot;</span>,<span class="st">&quot;BCL2/MYC&quot;</span>,<span class="st">&quot;MLLT10 rearrangement&quot;</span>,<span class="st">&quot;SET-NUP214&quot;</span>,<span class="st">&quot;STIL-TAL1&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-116"><a href="figure-1.html#cb53-116" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(fusion <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;BCR-ABL1&quot;</span>,<span class="st">&quot;ZNF384 fusion&quot;</span>,<span class="st">&quot;DUX4 rearrangement&quot;</span>,<span class="st">&quot;TCF3-PBX1&quot;</span>,<span class="st">&quot;KMT2A Group&quot;</span>,<span class="st">&quot;PAX5-ETV6&quot;</span>,<span class="st">&quot;MEF2D rearrangement&quot;</span>,<span class="st">&quot;BCL2/MYC&quot;</span>,<span class="st">&quot;MLLT10 rearrangement&quot;</span>,<span class="st">&quot;SET-NUP214&quot;</span>,<span class="st">&quot;STIL-TAL1&quot;</span>,<span class="st">&quot;KMT2A rearrangement&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-117"><a href="figure-1.html#cb53-117" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;fusion&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-118"><a href="figure-1.html#cb53-118" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">unique</span>(sample_order<span class="sc">$</span>ID)) <span class="sc">%&gt;%</span></span>
<span id="cb53-119"><a href="figure-1.html#cb53-119" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character,as.numeric)</span>
<span id="cb53-120"><a href="figure-1.html#cb53-120" tabindex="-1"></a>d_fusion_temp <span class="ot">&lt;-</span> <span class="fu">t</span>(d_fusion)</span>
<span id="cb53-121"><a href="figure-1.html#cb53-121" tabindex="-1"></a>d_fusion_temp[d_fusion_temp<span class="sc">!=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-122"><a href="figure-1.html#cb53-122" tabindex="-1"></a>num<span class="ot">=</span><span class="fu">colSums</span>(d_fusion_temp)</span>
<span id="cb53-123"><a href="figure-1.html#cb53-123" tabindex="-1"></a><span class="fu">rownames</span>(d_fusion) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">rownames</span>(d_fusion),<span class="st">&quot; (n=&quot;</span>,num,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb53-124"><a href="figure-1.html#cb53-124" tabindex="-1"></a></span>
<span id="cb53-125"><a href="figure-1.html#cb53-125" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-126"><a href="figure-1.html#cb53-126" tabindex="-1"></a><span class="co">#  Step 3: Waterfall Plot</span></span>
<span id="cb53-127"><a href="figure-1.html#cb53-127" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb53-128"><a href="figure-1.html#cb53-128" tabindex="-1"></a><span class="do">## Right annotation fusion</span></span>
<span id="cb53-129"><a href="figure-1.html#cb53-129" tabindex="-1"></a>d <span class="ot">&lt;-</span> d_fusion <span class="sc">%&gt;%</span></span>
<span id="cb53-130"><a href="figure-1.html#cb53-130" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;fusion&quot;</span>)</span>
<span id="cb53-131"><a href="figure-1.html#cb53-131" tabindex="-1"></a>d_fusion_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(d) <span class="sc">%&gt;%</span></span>
<span id="cb53-132"><a href="figure-1.html#cb53-132" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(fusion,value) <span class="sc">%&gt;%</span></span>
<span id="cb53-133"><a href="figure-1.html#cb53-133" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-134"><a href="figure-1.html#cb53-134" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(value <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-135"><a href="figure-1.html#cb53-135" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;number&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-136"><a href="figure-1.html#cb53-136" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;value&quot;</span><span class="ot">=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb53-137"><a href="figure-1.html#cb53-137" tabindex="-1"></a>d_fusion_dcast <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(d_fusion_melt,fusion <span class="sc">~</span> number) <span class="sc">%&gt;%</span></span>
<span id="cb53-138"><a href="figure-1.html#cb53-138" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(fusion,<span class="fu">rownames</span>(d_fusion))) <span class="sc">%&gt;%</span></span>
<span id="cb53-139"><a href="figure-1.html#cb53-139" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;fusion&quot;</span>)</span>
<span id="cb53-140"><a href="figure-1.html#cb53-140" tabindex="-1"></a>d_fusion_dcast[<span class="fu">is.na</span>(d_fusion_dcast)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-141"><a href="figure-1.html#cb53-141" tabindex="-1"></a>right_annotation_fusion <span class="ot">&lt;-</span> <span class="fu">rowAnnotation</span>(<span class="at">freq=</span><span class="fu">anno_barplot</span>(<span class="dv">100</span><span class="sc">*</span>d_fusion_dcast<span class="sc">/</span><span class="dv">182</span>,</span>
<span id="cb53-142"><a href="figure-1.html#cb53-142" tabindex="-1"></a>                                                           <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#005B1D&quot;</span>),<span class="at">col=</span><span class="cn">NA</span>),<span class="at">width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb53-143"><a href="figure-1.html#cb53-143" tabindex="-1"></a></span>
<span id="cb53-144"><a href="figure-1.html#cb53-144" tabindex="-1"></a>fusion_annotation <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(</span>
<span id="cb53-145"><a href="figure-1.html#cb53-145" tabindex="-1"></a>  d_fusion,<span class="at">right_annotation =</span> right_annotation_fusion,</span>
<span id="cb53-146"><a href="figure-1.html#cb53-146" tabindex="-1"></a>  <span class="at">rect_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>),</span>
<span id="cb53-147"><a href="figure-1.html#cb53-147" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#444444&quot;</span>),</span>
<span id="cb53-148"><a href="figure-1.html#cb53-148" tabindex="-1"></a>  <span class="at">height=</span><span class="fu">unit</span>(<span class="dv">6</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">border =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-149"><a href="figure-1.html#cb53-149" tabindex="-1"></a>  <span class="at">cluster_columns =</span> F,<span class="at">cluster_rows =</span> F,<span class="at">column_title =</span> <span class="cn">NULL</span>,</span>
<span id="cb53-150"><a href="figure-1.html#cb53-150" tabindex="-1"></a>  <span class="at">show_column_names =</span> F,</span>
<span id="cb53-151"><a href="figure-1.html#cb53-151" tabindex="-1"></a>  <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">10</span>),<span class="at">column_names_gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">6</span>))</span>
<span id="cb53-152"><a href="figure-1.html#cb53-152" tabindex="-1"></a></span>
<span id="cb53-153"><a href="figure-1.html#cb53-153" tabindex="-1"></a><span class="do">## IK6</span></span>
<span id="cb53-154"><a href="figure-1.html#cb53-154" tabindex="-1"></a>d_ik6 <span class="ot">&lt;-</span> Ik6 <span class="sc">%&gt;%</span></span>
<span id="cb53-155"><a href="figure-1.html#cb53-155" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,Ik6) <span class="sc">%&gt;%</span></span>
<span id="cb53-156"><a href="figure-1.html#cb53-156" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;RNA_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-157"><a href="figure-1.html#cb53-157" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-158"><a href="figure-1.html#cb53-158" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-159"><a href="figure-1.html#cb53-159" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">names</span>(d_fusion))</span>
<span id="cb53-160"><a href="figure-1.html#cb53-160" tabindex="-1"></a></span>
<span id="cb53-161"><a href="figure-1.html#cb53-161" tabindex="-1"></a>ik6_annotation <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(</span>
<span id="cb53-162"><a href="figure-1.html#cb53-162" tabindex="-1"></a>  d_ik6,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;cm&quot;</span>),<span class="at">border=</span><span class="cn">TRUE</span>,</span>
<span id="cb53-163"><a href="figure-1.html#cb53-163" tabindex="-1"></a>  <span class="at">rect_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>),</span>
<span id="cb53-164"><a href="figure-1.html#cb53-164" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#EA644C&quot;</span>))</span>
<span id="cb53-165"><a href="figure-1.html#cb53-165" tabindex="-1"></a></span>
<span id="cb53-166"><a href="figure-1.html#cb53-166" tabindex="-1"></a><span class="do">### Mutation</span></span>
<span id="cb53-167"><a href="figure-1.html#cb53-167" tabindex="-1"></a>hit_num <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span></span>
<span id="cb53-168"><a href="figure-1.html#cb53-168" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(ID,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-169"><a href="figure-1.html#cb53-169" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-170"><a href="figure-1.html#cb53-170" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb53-171"><a href="figure-1.html#cb53-171" tabindex="-1"></a></span>
<span id="cb53-172"><a href="figure-1.html#cb53-172" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span> </span>
<span id="cb53-173"><a href="figure-1.html#cb53-173" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(hit_num,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>,<span class="st">&quot;Gene.refGene&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-174"><a href="figure-1.html#cb53-174" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(n),<span class="st">&quot;Multiple&quot;</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-175"><a href="figure-1.html#cb53-175" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb53-176"><a href="figure-1.html#cb53-176" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-177"><a href="figure-1.html#cb53-177" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;RNA_id&quot;</span><span class="ot">=</span><span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-178"><a href="figure-1.html#cb53-178" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Gene.refGene,<span class="fu">c</span>(<span class="st">&quot;NOTCH1&quot;</span>,<span class="st">&quot;KMT2C&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;RUNX1&quot;</span>,<span class="st">&quot;SETD2&quot;</span>,<span class="st">&quot;CTCF&quot;</span>,<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;ETV6&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">&quot;KMT2D&quot;</span>,<span class="st">&quot;PHF6&quot;</span>,<span class="st">&quot;KMT2A&quot;</span>,<span class="st">&quot;PAX5&quot;</span>,<span class="st">&quot;TP53&quot;</span>,<span class="st">&quot;JAK3&quot;</span>,<span class="st">&quot;NCOR2&quot;</span>,<span class="st">&quot;SUZ12&quot;</span>,<span class="st">&quot;ARID1B&quot;</span>,<span class="st">&quot;ATRX&quot;</span>,<span class="st">&quot;IKZF1&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,<span class="st">&quot;PTEN&quot;</span>,<span class="st">&quot;EP300&quot;</span>,<span class="st">&quot;SETD1B&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;ARID1A&quot;</span>,<span class="st">&quot;NF1&quot;</span>,<span class="st">&quot;JAK1&quot;</span>,<span class="st">&quot;MGA&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>,<span class="st">&quot;SACS&quot;</span>,<span class="st">&quot;SH2B3&quot;</span>,<span class="st">&quot;STAT5B&quot;</span>,<span class="st">&quot;TET2&quot;</span>)))</span>
<span id="cb53-179"><a href="figure-1.html#cb53-179" tabindex="-1"></a></span>
<span id="cb53-180"><a href="figure-1.html#cb53-180" tabindex="-1"></a>mutation_gene_filter <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span></span>
<span id="cb53-181"><a href="figure-1.html#cb53-181" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(RNA_id,Gene.refGene) <span class="sc">%&gt;%</span></span>
<span id="cb53-182"><a href="figure-1.html#cb53-182" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-183"><a href="figure-1.html#cb53-183" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-184"><a href="figure-1.html#cb53-184" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-185"><a href="figure-1.html#cb53-185" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">4</span>)</span>
<span id="cb53-186"><a href="figure-1.html#cb53-186" tabindex="-1"></a>mutation_sort <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(mutation <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> mutation_gene_filter<span class="sc">$</span>Gene.refGene) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Gene.refGene)))))</span>
<span id="cb53-187"><a href="figure-1.html#cb53-187" tabindex="-1"></a></span>
<span id="cb53-188"><a href="figure-1.html#cb53-188" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span></span>
<span id="cb53-189"><a href="figure-1.html#cb53-189" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> mutation_gene_filter<span class="sc">$</span>Gene.refGene) <span class="sc">%&gt;%</span></span>
<span id="cb53-190"><a href="figure-1.html#cb53-190" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-191"><a href="figure-1.html#cb53-191" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(RNA_id,Gene.refGene,<span class="at">.keep_all =</span> T)</span>
<span id="cb53-192"><a href="figure-1.html#cb53-192" tabindex="-1"></a></span>
<span id="cb53-193"><a href="figure-1.html#cb53-193" tabindex="-1"></a>mutation_dcast <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(mutation,RNA_id <span class="sc">~</span> <span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-194"><a href="figure-1.html#cb53-194" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">right_join</span>(sample_order,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;RNA_id&quot;</span><span class="ot">=</span><span class="st">&quot;ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-195"><a href="figure-1.html#cb53-195" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;RNA_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-196"><a href="figure-1.html#cb53-196" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(mutation_sort))</span>
<span id="cb53-197"><a href="figure-1.html#cb53-197" tabindex="-1"></a></span>
<span id="cb53-198"><a href="figure-1.html#cb53-198" tabindex="-1"></a>mutation_dcast[<span class="fu">is.na</span>(mutation_dcast)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-199"><a href="figure-1.html#cb53-199" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Missense&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-200"><a href="figure-1.html#cb53-200" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Frameshift&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb53-201"><a href="figure-1.html#cb53-201" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Nonframeshift&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb53-202"><a href="figure-1.html#cb53-202" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Silent&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb53-203"><a href="figure-1.html#cb53-203" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Splice&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb53-204"><a href="figure-1.html#cb53-204" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Stopgain&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb53-205"><a href="figure-1.html#cb53-205" tabindex="-1"></a>mutation_dcast[mutation_dcast<span class="sc">==</span><span class="st">&quot;Multiple&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb53-206"><a href="figure-1.html#cb53-206" tabindex="-1"></a></span>
<span id="cb53-207"><a href="figure-1.html#cb53-207" tabindex="-1"></a>mutation_dcast1 <span class="ot">&lt;-</span> mutation_dcast <span class="sc">%&gt;%</span></span>
<span id="cb53-208"><a href="figure-1.html#cb53-208" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character,as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb53-209"><a href="figure-1.html#cb53-209" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-210"><a href="figure-1.html#cb53-210" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;NOTCH1&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;SETD2&quot;</span>,<span class="st">&quot;ETV6&quot;</span>,<span class="st">&quot;RUNX1&quot;</span>,</span>
<span id="cb53-211"><a href="figure-1.html#cb53-211" tabindex="-1"></a>                  <span class="st">&quot;PHF6&quot;</span>,<span class="st">&quot;KMT2D&quot;</span>,<span class="st">&quot;PAX5&quot;</span>,<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">&quot;TP53&quot;</span>,<span class="st">&quot;JAK3&quot;</span>,</span>
<span id="cb53-212"><a href="figure-1.html#cb53-212" tabindex="-1"></a>                  <span class="st">&quot;SUZ12&quot;</span>,<span class="st">&quot;DNMT3A&quot;</span>,<span class="st">&quot;IKZF1&quot;</span>,<span class="st">&quot;KRAS&quot;</span>,  </span>
<span id="cb53-213"><a href="figure-1.html#cb53-213" tabindex="-1"></a>                  <span class="st">&quot;EP300&quot;</span>,<span class="st">&quot;SETD1B&quot;</span>,<span class="st">&quot;NCOR2&quot;</span>,<span class="st">&quot;FLT3&quot;</span>,<span class="st">&quot;ARID1B&quot;</span>,<span class="st">&quot;ASXL1&quot;</span>,<span class="st">&quot;ARID1A&quot;</span>,</span>
<span id="cb53-214"><a href="figure-1.html#cb53-214" tabindex="-1"></a>                  <span class="st">&quot;NF1&quot;</span>,<span class="st">&quot;JAK1&quot;</span>,<span class="st">&quot;SH2B3&quot;</span>,<span class="st">&quot;TET2&quot;</span>,<span class="st">&quot;MGA&quot;</span>,<span class="st">&quot;PTPN11&quot;</span>,<span class="st">&quot;PTEN&quot;</span>,<span class="st">&quot;SACS&quot;</span>,  </span>
<span id="cb53-215"><a href="figure-1.html#cb53-215" tabindex="-1"></a>                  <span class="st">&quot;STAT5B&quot;</span>),<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-216"><a href="figure-1.html#cb53-216" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb53-217"><a href="figure-1.html#cb53-217" tabindex="-1"></a></span>
<span id="cb53-218"><a href="figure-1.html#cb53-218" tabindex="-1"></a><span class="fu">rownames</span>(mutation_dcast1) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mutation_dcast)</span>
<span id="cb53-219"><a href="figure-1.html#cb53-219" tabindex="-1"></a>mutation_dcast <span class="ot">&lt;-</span> mutation_dcast1</span>
<span id="cb53-220"><a href="figure-1.html#cb53-220" tabindex="-1"></a></span>
<span id="cb53-221"><a href="figure-1.html#cb53-221" tabindex="-1"></a>mutation_dcast_temp <span class="ot">&lt;-</span> mutation_dcast</span>
<span id="cb53-222"><a href="figure-1.html#cb53-222" tabindex="-1"></a>mutation_dcast_temp[mutation_dcast_temp<span class="sc">!=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb53-223"><a href="figure-1.html#cb53-223" tabindex="-1"></a>num<span class="ot">=</span><span class="fu">colSums</span>(mutation_dcast_temp)</span>
<span id="cb53-224"><a href="figure-1.html#cb53-224" tabindex="-1"></a><span class="fu">names</span>(mutation_dcast) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">names</span>(mutation_dcast),<span class="st">&quot; (n=&quot;</span>,num,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb53-225"><a href="figure-1.html#cb53-225" tabindex="-1"></a></span>
<span id="cb53-226"><a href="figure-1.html#cb53-226" tabindex="-1"></a>d_mutation <span class="ot">&lt;-</span> <span class="fu">t</span>(mutation_dcast) <span class="sc">%&gt;%</span></span>
<span id="cb53-227"><a href="figure-1.html#cb53-227" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-228"><a href="figure-1.html#cb53-228" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sample_order<span class="sc">$</span>ID)</span>
<span id="cb53-229"><a href="figure-1.html#cb53-229" tabindex="-1"></a></span>
<span id="cb53-230"><a href="figure-1.html#cb53-230" tabindex="-1"></a><span class="do">## Right annotation</span></span>
<span id="cb53-231"><a href="figure-1.html#cb53-231" tabindex="-1"></a>d <span class="ot">&lt;-</span> d_mutation <span class="sc">%&gt;%</span></span>
<span id="cb53-232"><a href="figure-1.html#cb53-232" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;mutation&quot;</span>)</span>
<span id="cb53-233"><a href="figure-1.html#cb53-233" tabindex="-1"></a>d_mutation_melt <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(d) <span class="sc">%&gt;%</span></span>
<span id="cb53-234"><a href="figure-1.html#cb53-234" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(mutation,value) <span class="sc">%&gt;%</span></span>
<span id="cb53-235"><a href="figure-1.html#cb53-235" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-236"><a href="figure-1.html#cb53-236" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(value <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-237"><a href="figure-1.html#cb53-237" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;number&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-238"><a href="figure-1.html#cb53-238" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;value&quot;</span><span class="ot">=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb53-239"><a href="figure-1.html#cb53-239" tabindex="-1"></a>d_mutation_dcast <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(d_mutation_melt,mutation <span class="sc">~</span> number) <span class="sc">%&gt;%</span></span>
<span id="cb53-240"><a href="figure-1.html#cb53-240" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(mutation,<span class="fu">rownames</span>(d_mutation))) <span class="sc">%&gt;%</span></span>
<span id="cb53-241"><a href="figure-1.html#cb53-241" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;mutation&quot;</span>)</span>
<span id="cb53-242"><a href="figure-1.html#cb53-242" tabindex="-1"></a>d_mutation_dcast[<span class="fu">is.na</span>(d_mutation_dcast)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-243"><a href="figure-1.html#cb53-243" tabindex="-1"></a></span>
<span id="cb53-244"><a href="figure-1.html#cb53-244" tabindex="-1"></a>right_annotation <span class="ot">&lt;-</span> <span class="fu">rowAnnotation</span>(</span>
<span id="cb53-245"><a href="figure-1.html#cb53-245" tabindex="-1"></a>  <span class="at">freq=</span><span class="fu">anno_barplot</span>(<span class="dv">100</span><span class="sc">*</span>d_mutation_dcast<span class="sc">/</span><span class="dv">182</span>,</span>
<span id="cb53-246"><a href="figure-1.html#cb53-246" tabindex="-1"></a>  <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#3987CC&quot;</span>,<span class="st">&quot;#DB3D3D&quot;</span>,<span class="st">&quot;#663FFB&quot;</span>,<span class="st">&quot;#FF7F0E&quot;</span>,<span class="st">&quot;#CC66FF&quot;</span>,<span class="st">&quot;#8B564C&quot;</span>,<span class="st">&quot;#339933&quot;</span>),<span class="at">col=</span><span class="cn">NA</span>),</span>
<span id="cb53-247"><a href="figure-1.html#cb53-247" tabindex="-1"></a>  <span class="at">width =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)))</span>
<span id="cb53-248"><a href="figure-1.html#cb53-248" tabindex="-1"></a></span>
<span id="cb53-249"><a href="figure-1.html#cb53-249" tabindex="-1"></a><span class="do">## Top annotation</span></span>
<span id="cb53-250"><a href="figure-1.html#cb53-250" tabindex="-1"></a>d_mutation_melt_col <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(d) <span class="sc">%&gt;%</span></span>
<span id="cb53-251"><a href="figure-1.html#cb53-251" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(variable,value) <span class="sc">%&gt;%</span></span>
<span id="cb53-252"><a href="figure-1.html#cb53-252" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-253"><a href="figure-1.html#cb53-253" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;number&quot;</span><span class="ot">=</span><span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-254"><a href="figure-1.html#cb53-254" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;value&quot;</span><span class="ot">=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb53-255"><a href="figure-1.html#cb53-255" tabindex="-1"></a>d_mutation_dcast_col <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">dcast</span>(d_mutation_melt_col,variable <span class="sc">~</span> number) <span class="sc">%&gt;%</span></span>
<span id="cb53-256"><a href="figure-1.html#cb53-256" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(variable,<span class="fu">colnames</span>(d_mutation))) <span class="sc">%&gt;%</span></span>
<span id="cb53-257"><a href="figure-1.html#cb53-257" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;variable&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-258"><a href="figure-1.html#cb53-258" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">0</span><span class="st">`</span>)</span>
<span id="cb53-259"><a href="figure-1.html#cb53-259" tabindex="-1"></a>d_mutation_dcast_col[<span class="fu">is.na</span>(d_mutation_dcast_col)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb53-260"><a href="figure-1.html#cb53-260" tabindex="-1"></a></span>
<span id="cb53-261"><a href="figure-1.html#cb53-261" tabindex="-1"></a>top_annotation <span class="ot">&lt;-</span> <span class="fu">columnAnnotation</span>(</span>
<span id="cb53-262"><a href="figure-1.html#cb53-262" tabindex="-1"></a>  <span class="at">freq=</span><span class="fu">anno_barplot</span>(d_mutation_dcast_col,<span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">&quot;#3987CC&quot;</span>,<span class="st">&quot;#DB3D3D&quot;</span>,<span class="st">&quot;#663FFB&quot;</span>,<span class="st">&quot;#FF7F0E&quot;</span>,<span class="st">&quot;#CC66FF&quot;</span>,<span class="st">&quot;#8B564C&quot;</span>,<span class="st">&quot;#339933&quot;</span>),<span class="at">col=</span><span class="cn">NA</span>),<span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb53-263"><a href="figure-1.html#cb53-263" tabindex="-1"></a>  <span class="at">Lineage=</span>sample_order<span class="sc">$</span>Lineage,<span class="at">col=</span><span class="fu">list</span>(<span class="at">Lineage=</span><span class="fu">c</span>(<span class="st">&quot;BCP-ALL&quot;</span><span class="ot">=</span><span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;T-ALL&quot;</span><span class="ot">=</span><span class="st">&quot;#4B0082&quot;</span>)))</span>
<span id="cb53-264"><a href="figure-1.html#cb53-264" tabindex="-1"></a></span>
<span id="cb53-265"><a href="figure-1.html#cb53-265" tabindex="-1"></a>mutation_annotation <span class="ot">&lt;-</span> <span class="fu">Heatmap</span>(</span>
<span id="cb53-266"><a href="figure-1.html#cb53-266" tabindex="-1"></a>  d_mutation,<span class="at">height=</span><span class="fu">unit</span>(<span class="dv">18</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb53-267"><a href="figure-1.html#cb53-267" tabindex="-1"></a>  <span class="at">rect_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>),</span>
<span id="cb53-268"><a href="figure-1.html#cb53-268" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;#EEEEEE&quot;</span>,<span class="st">&quot;#3987CC&quot;</span>,<span class="st">&quot;#DB3D3D&quot;</span>,<span class="st">&quot;#663FFB&quot;</span>,<span class="st">&quot;#FF7F0E&quot;</span>,<span class="st">&quot;#CC66FF&quot;</span>,<span class="st">&quot;#8B564C&quot;</span>,<span class="st">&quot;#339933&quot;</span>),</span>
<span id="cb53-269"><a href="figure-1.html#cb53-269" tabindex="-1"></a>  <span class="at">cluster_columns =</span> F,<span class="at">cluster_rows =</span> F,</span>
<span id="cb53-270"><a href="figure-1.html#cb53-270" tabindex="-1"></a>  <span class="at">border =</span> <span class="cn">TRUE</span>,<span class="at">column_title =</span> <span class="cn">NULL</span>,<span class="at">show_column_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-271"><a href="figure-1.html#cb53-271" tabindex="-1"></a>  <span class="at">top_annotation=</span>top_annotation,<span class="at">right_annotation =</span> right_annotation,</span>
<span id="cb53-272"><a href="figure-1.html#cb53-272" tabindex="-1"></a>  <span class="at">row_names_gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">8</span>))</span>
<span id="cb53-273"><a href="figure-1.html#cb53-273" tabindex="-1"></a></span>
<span id="cb53-274"><a href="figure-1.html#cb53-274" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/S1C_waterfall.pdf&quot;</span>,<span class="at">width=</span><span class="dv">12</span>,<span class="at">height =</span> <span class="dv">12</span>)</span>
<span id="cb53-275"><a href="figure-1.html#cb53-275" tabindex="-1"></a>mutation_annotation <span class="sc">%v%</span></span>
<span id="cb53-276"><a href="figure-1.html#cb53-276" tabindex="-1"></a>  ik6_annotation <span class="sc">%v%</span></span>
<span id="cb53-277"><a href="figure-1.html#cb53-277" tabindex="-1"></a>  fusion_annotation</span>
<span id="cb53-278"><a href="figure-1.html#cb53-278" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S1C.png" width="1049" style="display: block; margin: auto;" /></p>
</div>
<div id="s1-d-scatter-plot" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> (S1 D) Scatter plot<a href="figure-1.html#s1-d-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A scatter plot suggests the existence of <strong>a potential relationship between aging and key mutations</strong>. The red line indicated the median age.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="figure-1.html#cb54-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-2"><a href="figure-1.html#cb54-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-3"><a href="figure-1.html#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="figure-1.html#cb54-4" tabindex="-1"></a>sample <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="figure-1.html#cb54-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="figure-1.html#cb54-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RNA_ID_raw)) <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="figure-1.html#cb54-7" tabindex="-1"></a>  <span class="fu">select</span>(RNA_ID_raw,Age)</span>
<span id="cb54-8"><a href="figure-1.html#cb54-8" tabindex="-1"></a></span>
<span id="cb54-9"><a href="figure-1.html#cb54-9" tabindex="-1"></a><span class="do">## mutation</span></span>
<span id="cb54-10"><a href="figure-1.html#cb54-10" tabindex="-1"></a>mutation_T <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_T_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="figure-1.html#cb54-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="figure-1.html#cb54-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17,V19) <span class="sc">%&gt;%</span></span>
<span id="cb54-13"><a href="figure-1.html#cb54-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;V2&quot;</span>,<span class="st">&quot;Gene.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V17&quot;</span>,<span class="st">&quot;ExonicFunc.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V19&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-14"><a href="figure-1.html#cb54-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="figure-1.html#cb54-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;frameshift deletion&quot;</span>,<span class="st">&quot;frameshift insertion&quot;</span>,<span class="st">&quot;frameshift substitution&quot;</span>),<span class="st">&quot;Frameshift&quot;</span>,</span>
<span id="cb54-16"><a href="figure-1.html#cb54-16" tabindex="-1"></a>                                            <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;nonframeshift deletion&quot;</span>,<span class="st">&quot;nonframeshift insertion&quot;</span>,<span class="st">&quot;nonframeshift substitution&quot;</span>),<span class="st">&quot;Nonframeshift&quot;</span>,</span>
<span id="cb54-17"><a href="figure-1.html#cb54-17" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;.&quot;</span>,<span class="st">&quot;Splice&quot;</span>,</span>
<span id="cb54-18"><a href="figure-1.html#cb54-18" tabindex="-1"></a>                                                          <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;nonsynonymous SNV&quot;</span>,<span class="st">&quot;Missense&quot;</span>,</span>
<span id="cb54-19"><a href="figure-1.html#cb54-19" tabindex="-1"></a>                                                                 <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;startloss&quot;</span>,<span class="st">&quot;Startloss&quot;</span>,</span>
<span id="cb54-20"><a href="figure-1.html#cb54-20" tabindex="-1"></a>                                                                        <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;stopgain&quot;</span>,<span class="st">&quot;Stopgain&quot;</span>,</span>
<span id="cb54-21"><a href="figure-1.html#cb54-21" tabindex="-1"></a>                                                                               <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;synonymous SNV&quot;</span>,<span class="st">&quot;Silent&quot;</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>)))))))) <span class="sc">%&gt;%</span></span>
<span id="cb54-22"><a href="figure-1.html#cb54-22" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-23"><a href="figure-1.html#cb54-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-24"><a href="figure-1.html#cb54-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Gene.refGene)</span>
<span id="cb54-25"><a href="figure-1.html#cb54-25" tabindex="-1"></a></span>
<span id="cb54-26"><a href="figure-1.html#cb54-26" tabindex="-1"></a>mutation_B <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/mutation_B_v1114_all.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-27"><a href="figure-1.html#cb54-27" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-28"><a href="figure-1.html#cb54-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(V2,V17,V19) <span class="sc">%&gt;%</span></span>
<span id="cb54-29"><a href="figure-1.html#cb54-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;V2&quot;</span>,<span class="st">&quot;Gene.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V17&quot;</span>,<span class="st">&quot;ExonicFunc.refGene&quot;</span><span class="ot">=</span><span class="st">&quot;V19&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-30"><a href="figure-1.html#cb54-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-31"><a href="figure-1.html#cb54-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;frameshift deletion&quot;</span>,<span class="st">&quot;frameshift insertion&quot;</span>,<span class="st">&quot;frameshift substitution&quot;</span>),<span class="st">&quot;Frameshift&quot;</span>,</span>
<span id="cb54-32"><a href="figure-1.html#cb54-32" tabindex="-1"></a>                                            <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;nonframeshift deletion&quot;</span>,<span class="st">&quot;nonframeshift insertion&quot;</span>,<span class="st">&quot;nonframeshift substitution&quot;</span>),<span class="st">&quot;Nonframeshift&quot;</span>,</span>
<span id="cb54-33"><a href="figure-1.html#cb54-33" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;.&quot;</span>,<span class="st">&quot;Splice&quot;</span>,</span>
<span id="cb54-34"><a href="figure-1.html#cb54-34" tabindex="-1"></a>                                                          <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="st">&quot;nonsynonymous SNV&quot;</span>,<span class="st">&quot;Missense&quot;</span>,</span>
<span id="cb54-35"><a href="figure-1.html#cb54-35" tabindex="-1"></a>                                                                 <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;startloss&quot;</span>,<span class="st">&quot;Startloss&quot;</span>,</span>
<span id="cb54-36"><a href="figure-1.html#cb54-36" tabindex="-1"></a>                                                                        <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;stopgain&quot;</span>,<span class="st">&quot;Stopgain&quot;</span>,</span>
<span id="cb54-37"><a href="figure-1.html#cb54-37" tabindex="-1"></a>                                                                               <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span><span class="sc">==</span><span class="st">&quot;synonymous SNV&quot;</span>,<span class="st">&quot;Silent&quot;</span>,<span class="st">`</span><span class="at">ExonicFunc.refGene</span><span class="st">`</span>)))))))) <span class="sc">%&gt;%</span></span>
<span id="cb54-38"><a href="figure-1.html#cb54-38" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-39"><a href="figure-1.html#cb54-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IDH1&quot;</span>,<span class="st">&quot;IDH2&quot;</span>),<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-40"><a href="figure-1.html#cb54-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Gene.refGene)</span>
<span id="cb54-41"><a href="figure-1.html#cb54-41" tabindex="-1"></a></span>
<span id="cb54-42"><a href="figure-1.html#cb54-42" tabindex="-1"></a>mutation <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mutation_T,mutation_B) <span class="sc">%&gt;%</span></span>
<span id="cb54-43"><a href="figure-1.html#cb54-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(ID <span class="sc">%in%</span> sample<span class="sc">$</span>RNA_ID_raw) <span class="sc">%&gt;%</span></span>
<span id="cb54-44"><a href="figure-1.html#cb54-44" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-45"><a href="figure-1.html#cb54-45" tabindex="-1"></a>  <span class="fu">select</span>(ID,Gene.refGene) <span class="sc">%&gt;%</span></span>
<span id="cb54-46"><a href="figure-1.html#cb54-46" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-47"><a href="figure-1.html#cb54-47" tabindex="-1"></a>  <span class="fu">left_join</span>(sample,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;ID&quot;</span><span class="ot">=</span><span class="st">&quot;RNA_ID_raw&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-48"><a href="figure-1.html#cb54-48" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Gene.refGene</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;NOTCH1&quot;</span>,<span class="st">&quot;NRAS&quot;</span>,<span class="st">&quot;SETD2&quot;</span>,<span class="st">&quot;ETV6&quot;</span>,<span class="st">&quot;RUNX1&quot;</span>,<span class="st">&quot;PHF6&quot;</span>,<span class="st">&quot;KMT2D&quot;</span>,<span class="st">&quot;PAX5&quot;</span>,<span class="st">&quot;IDH1/2&quot;</span>,<span class="st">&quot;TP53&quot;</span>)) </span>
<span id="cb54-49"><a href="figure-1.html#cb54-49" tabindex="-1"></a>mutation_median <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span> </span>
<span id="cb54-50"><a href="figure-1.html#cb54-50" tabindex="-1"></a>  <span class="fu">group_by</span>(Gene.refGene) <span class="sc">%&gt;%</span></span>
<span id="cb54-51"><a href="figure-1.html#cb54-51" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">m=</span><span class="fu">median</span>(Age),<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb54-52"><a href="figure-1.html#cb54-52" tabindex="-1"></a>  <span class="fu">arrange</span>(m) <span class="sc">%&gt;%</span></span>
<span id="cb54-53"><a href="figure-1.html#cb54-53" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tt=</span><span class="fu">paste0</span>(Gene.refGene,<span class="st">&quot;(m=&quot;</span>,m,<span class="st">&quot;;n=&quot;</span>,n,<span class="st">&quot;)&quot;</span>))</span>
<span id="cb54-54"><a href="figure-1.html#cb54-54" tabindex="-1"></a></span>
<span id="cb54-55"><a href="figure-1.html#cb54-55" tabindex="-1"></a>mutation_sort <span class="ot">&lt;-</span> mutation <span class="sc">%&gt;%</span> </span>
<span id="cb54-56"><a href="figure-1.html#cb54-56" tabindex="-1"></a>  <span class="fu">left_join</span>(mutation_median,<span class="at">by=</span><span class="st">&quot;Gene.refGene&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-57"><a href="figure-1.html#cb54-57" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">match</span>(Gene.refGene,mutation_median<span class="sc">$</span>Gene.refGene)) <span class="sc">%&gt;%</span></span>
<span id="cb54-58"><a href="figure-1.html#cb54-58" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tt=</span><span class="fu">factor</span>(tt,<span class="at">levels=</span><span class="fu">unique</span>(tt))) <span class="sc">%&gt;%</span></span>
<span id="cb54-59"><a href="figure-1.html#cb54-59" tabindex="-1"></a>  <span class="fu">arrange</span>(Age) <span class="sc">%&gt;%</span></span>
<span id="cb54-60"><a href="figure-1.html#cb54-60" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID=</span><span class="fu">factor</span>(ID,<span class="at">levels=</span><span class="fu">unique</span>(ID)))</span>
<span id="cb54-61"><a href="figure-1.html#cb54-61" tabindex="-1"></a></span>
<span id="cb54-62"><a href="figure-1.html#cb54-62" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mutation_sort,<span class="fu">aes</span>(ID,Age))<span class="sc">+</span></span>
<span id="cb54-63"><a href="figure-1.html#cb54-63" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb54-64"><a href="figure-1.html#cb54-64" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(tt),<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>)<span class="sc">+</span></span>
<span id="cb54-65"><a href="figure-1.html#cb54-65" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb54-66"><a href="figure-1.html#cb54-66" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),<span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb54-67"><a href="figure-1.html#cb54-67" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>)</span>
<span id="cb54-68"><a href="figure-1.html#cb54-68" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S1D_rna_age_mutation.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">8</span>,<span class="at">height =</span> <span class="dv">3</span>)  </span></code></pre></div>
<p><img src="Figure-1025/Figure1/S1D.png" width="771" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-a-pca" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> (S2 A) PCA<a href="figure-1.html#s2-a-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A substantial <strong>metabolic disturbance</strong> is observed in <strong>the serum of BCP-ALL/T-ALL (n=180) compared to HC (n=164)</strong>, and there is no distinguishable boundary between lineage B and T ALL.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="figure-1.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb55-2"><a href="figure-1.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-3"><a href="figure-1.html#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="figure-1.html#cb55-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb55-5"><a href="figure-1.html#cb55-5" tabindex="-1"></a><span class="co">#  Step 1: Load patient&#39;s cell and serum metabolomics data</span></span>
<span id="cb55-6"><a href="figure-1.html#cb55-6" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb55-7"><a href="figure-1.html#cb55-7" tabindex="-1"></a>clinical <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/clinical_all_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="figure-1.html#cb55-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-9"><a href="figure-1.html#cb55-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;HC&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb55-10"><a href="figure-1.html#cb55-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(Lineage,<span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;T&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="figure-1.html#cb55-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(group)</span>
<span id="cb55-12"><a href="figure-1.html#cb55-12" tabindex="-1"></a></span>
<span id="cb55-13"><a href="figure-1.html#cb55-13" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-14"><a href="figure-1.html#cb55-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-15"><a href="figure-1.html#cb55-15" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb55-16"><a href="figure-1.html#cb55-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(clinical<span class="sc">$</span>METs_ID)</span>
<span id="cb55-17"><a href="figure-1.html#cb55-17" tabindex="-1"></a></span>
<span id="cb55-18"><a href="figure-1.html#cb55-18" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb55-19"><a href="figure-1.html#cb55-19" tabindex="-1"></a><span class="co">#  Step 2: PCA</span></span>
<span id="cb55-20"><a href="figure-1.html#cb55-20" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb55-21"><a href="figure-1.html#cb55-21" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">log2</span>(dat<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb55-22"><a href="figure-1.html#cb55-22" tabindex="-1"></a>group <span class="ot">&lt;-</span> clinical<span class="sc">$</span>Lineage</span>
<span id="cb55-23"><a href="figure-1.html#cb55-23" tabindex="-1"></a></span>
<span id="cb55-24"><a href="figure-1.html#cb55-24" tabindex="-1"></a>pca <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prcomp</span>(<span class="fu">t</span>(dat), <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-25"><a href="figure-1.html#cb55-25" tabindex="-1"></a>variance <span class="ot">=</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-26"><a href="figure-1.html#cb55-26" tabindex="-1"></a>pca.data <span class="ot">=</span> <span class="fu">data.frame</span>(pca<span class="sc">$</span>x,<span class="at">group=</span>group,<span class="at">label=</span><span class="fu">rownames</span>(pca<span class="sc">$</span>x))</span>
<span id="cb55-27"><a href="figure-1.html#cb55-27" tabindex="-1"></a></span>
<span id="cb55-28"><a href="figure-1.html#cb55-28" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(pca.data,ggplot2<span class="sc">::</span><span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>group))<span class="sc">+</span></span>
<span id="cb55-29"><a href="figure-1.html#cb55-29" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb55-30"><a href="figure-1.html#cb55-30" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">stat_ellipse</span>( <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb55-31"><a href="figure-1.html#cb55-31" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb55-32"><a href="figure-1.html#cb55-32" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;#007DDB&quot;</span>,<span class="st">&quot;#4B0082&quot;</span>))<span class="sc">+</span></span>
<span id="cb55-33"><a href="figure-1.html#cb55-33" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),<span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb55-34"><a href="figure-1.html#cb55-34" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(<span class="st">&quot;PC1 (&quot;</span>,<span class="fu">signif</span>(variance[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;%)&quot;</span>),</span>
<span id="cb55-35"><a href="figure-1.html#cb55-35" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">&quot;PC2 (&quot;</span>,<span class="fu">signif</span>(variance[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">100</span>,<span class="dv">3</span>),<span class="st">&quot;%)&quot;</span>))</span>
<span id="cb55-36"><a href="figure-1.html#cb55-36" tabindex="-1"></a></span>
<span id="cb55-37"><a href="figure-1.html#cb55-37" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2A_PCA.pdf&quot;</span>,p2,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2A.png" width="417" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-b-volcano-plot" class="section level2 hasAnchor" number="16.8">
<h2><span class="header-section-number">16.8</span> (S2 B) Volcano Plot<a href="figure-1.html#s2-b-volcano-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <strong>volcano plot</strong> shows <strong>the distribution of differential metabolites</strong>. Noteworthy among the elevated metabolites were primary bile acids and their derivatives, whereas various carnitines were diminished. The dash line on the x-axis represents a fold change of 1.5 between BCP-ALL/T-ALL and HC, while the dash line on the y-axis represents adjusted P-value of 0.05.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="figure-1.html#cb56-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-2"><a href="figure-1.html#cb56-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-3"><a href="figure-1.html#cb56-3" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb56-4"><a href="figure-1.html#cb56-4" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb56-5"><a href="figure-1.html#cb56-5" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb56-6"><a href="figure-1.html#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="figure-1.html#cb56-7" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb56-8"><a href="figure-1.html#cb56-8" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb56-9"><a href="figure-1.html#cb56-9" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb56-10"><a href="figure-1.html#cb56-10" tabindex="-1"></a><span class="co"># Data input for all clinical data</span></span>
<span id="cb56-11"><a href="figure-1.html#cb56-11" tabindex="-1"></a>kid <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_metabolites_id_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="figure-1.html#cb56-12" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb56-13"><a href="figure-1.html#cb56-13" tabindex="-1"></a></span>
<span id="cb56-14"><a href="figure-1.html#cb56-14" tabindex="-1"></a>clinical <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/clinical_all_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-15"><a href="figure-1.html#cb56-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-16"><a href="figure-1.html#cb56-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;HC&quot;</span>))</span>
<span id="cb56-17"><a href="figure-1.html#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="figure-1.html#cb56-18" tabindex="-1"></a><span class="co"># Differential metabolites</span></span>
<span id="cb56-19"><a href="figure-1.html#cb56-19" tabindex="-1"></a>datRAW <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-20"><a href="figure-1.html#cb56-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-21"><a href="figure-1.html#cb56-21" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-22"><a href="figure-1.html#cb56-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(clinical<span class="sc">$</span>METs_ID)</span>
<span id="cb56-23"><a href="figure-1.html#cb56-23" tabindex="-1"></a></span>
<span id="cb56-24"><a href="figure-1.html#cb56-24" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb56-25"><a href="figure-1.html#cb56-25" tabindex="-1"></a><span class="co">#  Step 2: Conduct variance analysis</span></span>
<span id="cb56-26"><a href="figure-1.html#cb56-26" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb56-27"><a href="figure-1.html#cb56-27" tabindex="-1"></a>group <span class="ot">&lt;-</span> clinical<span class="sc">$</span>group</span>
<span id="cb56-28"><a href="figure-1.html#cb56-28" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;A&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb56-29"><a href="figure-1.html#cb56-29" tabindex="-1"></a>group[group<span class="sc">==</span><span class="st">&quot;HC&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb56-30"><a href="figure-1.html#cb56-30" tabindex="-1"></a></span>
<span id="cb56-31"><a href="figure-1.html#cb56-31" tabindex="-1"></a>diff_result <span class="ot">&lt;-</span> <span class="fu">DM</span>(datRAW,group)</span>
<span id="cb56-32"><a href="figure-1.html#cb56-32" tabindex="-1"></a></span>
<span id="cb56-33"><a href="figure-1.html#cb56-33" tabindex="-1"></a><span class="fu">write.table</span>(diff_result,<span class="st">&quot;result/Figure1/AvsHC.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>T,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb56-34"><a href="figure-1.html#cb56-34" tabindex="-1"></a></span>
<span id="cb56-35"><a href="figure-1.html#cb56-35" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb56-36"><a href="figure-1.html#cb56-36" tabindex="-1"></a><span class="co">#  Step 3: Volcano plot</span></span>
<span id="cb56-37"><a href="figure-1.html#cb56-37" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb56-38"><a href="figure-1.html#cb56-38" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure1/AvsHC.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-39"><a href="figure-1.html#cb56-39" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-40"><a href="figure-1.html#cb56-40" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Name&quot;</span><span class="ot">=</span><span class="st">&quot;query&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb56-41"><a href="figure-1.html#cb56-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb56-42"><a href="figure-1.html#cb56-42" tabindex="-1"></a>    <span class="at">Condition=</span><span class="fu">ifelse</span>(Fold_change <span class="sc">&gt;=</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">2</span> <span class="sc">&amp;</span> Padj_wilcox<span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;sig up&quot;</span>,</span>
<span id="cb56-43"><a href="figure-1.html#cb56-43" tabindex="-1"></a>              <span class="fu">ifelse</span>(Fold_change <span class="sc">&lt;=</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span> <span class="sc">&amp;</span> Padj_wilcox <span class="sc">&lt;</span> <span class="fl">0.05</span>,<span class="st">&quot;sig down&quot;</span>,<span class="st">&quot;no sig&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb56-44"><a href="figure-1.html#cb56-44" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">super.class=</span><span class="fu">factor</span>(super.class))</span>
<span id="cb56-45"><a href="figure-1.html#cb56-45" tabindex="-1"></a></span>
<span id="cb56-46"><a href="figure-1.html#cb56-46" tabindex="-1"></a>mydata_filter <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span></span>
<span id="cb56-47"><a href="figure-1.html#cb56-47" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;sig up&quot;</span>,<span class="st">&quot;sig down&quot;</span>))</span>
<span id="cb56-48"><a href="figure-1.html#cb56-48" tabindex="-1"></a><span class="fu">write.table</span>(mydata_filter,<span class="st">&quot;result/Figure1/AvsHC_diff.txt&quot;</span>,<span class="at">quote=</span>F,<span class="at">row.names=</span>F,<span class="at">sep=</span><span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>)</span>
<span id="cb56-49"><a href="figure-1.html#cb56-49" tabindex="-1"></a></span>
<span id="cb56-50"><a href="figure-1.html#cb56-50" tabindex="-1"></a>bile_car <span class="ot">&lt;-</span> <span class="fu">subset</span>(mydata,mydata<span class="sc">$</span>Padj_wilcox <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> (mydata<span class="sc">$</span>Fold_change <span class="sc">&gt;</span> <span class="fl">1.5</span><span class="sc">|</span>mydata<span class="sc">$</span>Fold_change <span class="sc">&lt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-51"><a href="figure-1.html#cb56-51" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">carnitines =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;carniti&quot;</span>,Name),<span class="st">&quot;carnitines&quot;</span>,<span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-52"><a href="figure-1.html#cb56-52" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(main.class <span class="sc">==</span> <span class="st">&quot;Bile acids&quot;</span><span class="sc">|</span> PATHWAY<span class="sc">==</span><span class="st">&quot;Primary bile acid biosynthesis&quot;</span><span class="sc">|</span>carnitines<span class="sc">==</span><span class="st">&quot;carnitines&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-53"><a href="figure-1.html#cb56-53" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text.label=</span><span class="fu">ifelse</span>(main.class<span class="sc">==</span><span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,Name)) </span>
<span id="cb56-54"><a href="figure-1.html#cb56-54" tabindex="-1"></a></span>
<span id="cb56-55"><a href="figure-1.html#cb56-55" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Amino acids and peptides&quot;</span> <span class="ot">=</span><span class="st">&quot;#1B9E77&quot;</span>,</span>
<span id="cb56-56"><a href="figure-1.html#cb56-56" tabindex="-1"></a>          <span class="at">Carbohydrates=</span><span class="st">&quot;#D95F02&quot;</span>,<span class="st">&quot;Cofactors and Vitamins&quot;</span><span class="ot">=</span><span class="st">&quot;#7570B3&quot;</span>,</span>
<span id="cb56-57"><a href="figure-1.html#cb56-57" tabindex="-1"></a>          <span class="at">Energy=</span><span class="st">&quot;#E7298A&quot;</span>,<span class="at">Lipids=</span><span class="st">&quot;#66A61E&quot;</span>,<span class="at">Nucleotides=</span><span class="st">&quot;#E6AB02&quot;</span>,</span>
<span id="cb56-58"><a href="figure-1.html#cb56-58" tabindex="-1"></a>          <span class="at">Other=</span><span class="st">&quot;#A6761D&quot;</span>,<span class="at">Xenobiotics=</span><span class="st">&quot;#666666&quot;</span>)</span>
<span id="cb56-59"><a href="figure-1.html#cb56-59" tabindex="-1"></a></span>
<span id="cb56-60"><a href="figure-1.html#cb56-60" tabindex="-1"></a>(p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata,<span class="fu">aes</span>(<span class="fu">log2</span>(Fold_change),<span class="sc">-</span><span class="fu">log10</span>(Padj_wilcox),<span class="at">color=</span>super.class))<span class="sc">+</span></span>
<span id="cb56-61"><a href="figure-1.html#cb56-61" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb56-62"><a href="figure-1.html#cb56-62" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="st">&quot;super.class&quot;</span>, <span class="at">values=</span>cols)<span class="sc">+</span></span>
<span id="cb56-63"><a href="figure-1.html#cb56-63" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fu">log2</span>(<span class="fl">1.5</span>),<span class="fu">log2</span>(<span class="fl">1.5</span>)), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb56-64"><a href="figure-1.html#cb56-64" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>),<span class="at">linetype=</span><span class="st">&#39;dashed&#39;</span>,<span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb56-65"><a href="figure-1.html#cb56-65" tabindex="-1"></a>    <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb56-66"><a href="figure-1.html#cb56-66" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data =</span>bile_car,<span class="fu">aes</span>(<span class="at">label=</span>text.label),</span>
<span id="cb56-67"><a href="figure-1.html#cb56-67" tabindex="-1"></a>                    <span class="at">size=</span><span class="dv">2</span>,<span class="at">max.overlaps =</span> <span class="cn">Inf</span>)<span class="sc">+</span></span>
<span id="cb56-68"><a href="figure-1.html#cb56-68" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-69"><a href="figure-1.html#cb56-69" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb56-70"><a href="figure-1.html#cb56-70" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;log2(FoldChange)&quot;</span>,<span class="at">y=</span><span class="st">&quot;-log10(Padj)&quot;</span>,</span>
<span id="cb56-71"><a href="figure-1.html#cb56-71" tabindex="-1"></a>         <span class="at">title=</span><span class="st">&quot;Differential metabolites&quot;</span>))</span>
<span id="cb56-72"><a href="figure-1.html#cb56-72" tabindex="-1"></a><span class="fu">ggsave</span>(p2,<span class="at">filename =</span> <span class="st">&quot;result/Figure1/S2B_Volcano.pdf&quot;</span>,<span class="at">width=</span><span class="dv">13</span>,<span class="at">height=</span><span class="dv">9</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2B.png" width="562" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-c-msea" class="section level2 hasAnchor" number="16.9">
<h2><span class="header-section-number">16.9</span> (S2 C) MSEA<a href="figure-1.html#s2-c-msea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Metabolite set enrichment analysis (MSEA)</strong> for BCP-ALL/T-ALL vs. HC reveals a significant upregulation of primary bile acid metabolism in ALL serum.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="figure-1.html#cb57-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb57-2"><a href="figure-1.html#cb57-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb57-3"><a href="figure-1.html#cb57-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-4"><a href="figure-1.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="figure-1.html#cb57-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb57-6"><a href="figure-1.html#cb57-6" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb57-7"><a href="figure-1.html#cb57-7" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb57-8"><a href="figure-1.html#cb57-8" tabindex="-1"></a>clinical <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/clinical_all_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-9"><a href="figure-1.html#cb57-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-10"><a href="figure-1.html#cb57-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;HC&quot;</span>))</span>
<span id="cb57-11"><a href="figure-1.html#cb57-11" tabindex="-1"></a> </span>
<span id="cb57-12"><a href="figure-1.html#cb57-12" tabindex="-1"></a>kid <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_metabolites_id_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-13"><a href="figure-1.html#cb57-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-14"><a href="figure-1.html#cb57-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">KEGG=</span><span class="fu">ifelse</span>(KEGG<span class="sc">==</span><span class="st">&quot;None&quot;</span>,query,KEGG))</span>
<span id="cb57-15"><a href="figure-1.html#cb57-15" tabindex="-1"></a></span>
<span id="cb57-16"><a href="figure-1.html#cb57-16" tabindex="-1"></a>dat_allvsHC <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-17"><a href="figure-1.html#cb57-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-18"><a href="figure-1.html#cb57-18" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-19"><a href="figure-1.html#cb57-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(clinical<span class="sc">$</span>METs_ID)</span>
<span id="cb57-20"><a href="figure-1.html#cb57-20" tabindex="-1"></a></span>
<span id="cb57-21"><a href="figure-1.html#cb57-21" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb57-22"><a href="figure-1.html#cb57-22" tabindex="-1"></a><span class="co">#  Step 2: Conduct variance analysis</span></span>
<span id="cb57-23"><a href="figure-1.html#cb57-23" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb57-24"><a href="figure-1.html#cb57-24" tabindex="-1"></a>group <span class="ot">&lt;-</span> clinical<span class="sc">$</span>group</span>
<span id="cb57-25"><a href="figure-1.html#cb57-25" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;A&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;tumor&quot;</span></span>
<span id="cb57-26"><a href="figure-1.html#cb57-26" tabindex="-1"></a>group[<span class="fu">which</span>(group<span class="sc">==</span><span class="st">&quot;HC&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;normal&quot;</span></span>
<span id="cb57-27"><a href="figure-1.html#cb57-27" tabindex="-1"></a></span>
<span id="cb57-28"><a href="figure-1.html#cb57-28" tabindex="-1"></a>mlimma_result <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(<span class="fu">log2</span>(dat_allvsHC<span class="sc">+</span><span class="dv">1</span>),group) <span class="sc">%&gt;%</span></span>
<span id="cb57-29"><a href="figure-1.html#cb57-29" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;name&quot;</span><span class="ot">=</span><span class="st">&quot;query&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb57-30"><a href="figure-1.html#cb57-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(logFC)) <span class="sc">%&gt;%</span></span>
<span id="cb57-31"><a href="figure-1.html#cb57-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(KEGG,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-32"><a href="figure-1.html#cb57-32" tabindex="-1"></a>Ranks_all <span class="ot">&lt;-</span> mlimma_result<span class="sc">$</span>logFC</span>
<span id="cb57-33"><a href="figure-1.html#cb57-33" tabindex="-1"></a><span class="fu">names</span>(Ranks_all) <span class="ot">&lt;-</span> mlimma_result<span class="sc">$</span>KEGG</span>
<span id="cb57-34"><a href="figure-1.html#cb57-34" tabindex="-1"></a></span>
<span id="cb57-35"><a href="figure-1.html#cb57-35" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb57-36"><a href="figure-1.html#cb57-36" tabindex="-1"></a><span class="co">#  Step 3: MSEA</span></span>
<span id="cb57-37"><a href="figure-1.html#cb57-37" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb57-38"><a href="figure-1.html#cb57-38" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb57-39"><a href="figure-1.html#cb57-39" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pMSEA</span>(<span class="st">&quot;Primary bile acid biosynthesis&quot;</span>,Ranks_all,<span class="at">gseaParam=</span><span class="fl">0.75</span>,<span class="at">nPermSimple=</span><span class="dv">1000</span>,<span class="at">out=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb57-40"><a href="figure-1.html#cb57-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2C_Primary_bile_acid.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2C.png" width="417" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-d-ageing-related-metabolites" class="section level2 hasAnchor" number="16.10">
<h2><span class="header-section-number">16.10</span> (S2 D) Ageing-related metabolites<a href="figure-1.html#s2-d-ageing-related-metabolites" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ageing-related metabolites in ALL and 6 of them (with text denoted) were independent of therapy. The upper left summarizes the number of ALL specific ageing metabolites that excluded ageing-related metabolites in healthy at each time points.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="figure-1.html#cb58-1" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-2"><a href="figure-1.html#cb58-2" tabindex="-1"></a><span class="co">#  Step 1:  Ageing-related metabolites in ALL and 6 of them (with text denoted) were independent of therapy</span></span>
<span id="cb58-3"><a href="figure-1.html#cb58-3" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-4"><a href="figure-1.html#cb58-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-5"><a href="figure-1.html#cb58-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-6"><a href="figure-1.html#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="figure-1.html#cb58-7" tabindex="-1"></a>HC <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_HC.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-8"><a href="figure-1.html#cb58-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb58-9"><a href="figure-1.html#cb58-9" tabindex="-1"></a></span>
<span id="cb58-10"><a href="figure-1.html#cb58-10" tabindex="-1"></a>HC_filter <span class="ot">&lt;-</span> HC <span class="sc">%&gt;%</span></span>
<span id="cb58-11"><a href="figure-1.html#cb58-11" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb58-12"><a href="figure-1.html#cb58-12" tabindex="-1"></a></span>
<span id="cb58-13"><a href="figure-1.html#cb58-13" tabindex="-1"></a>dat_d0 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D0.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-14"><a href="figure-1.html#cb58-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-15"><a href="figure-1.html#cb58-15" tabindex="-1"></a></span>
<span id="cb58-16"><a href="figure-1.html#cb58-16" tabindex="-1"></a>dat_d14 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D14.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-17"><a href="figure-1.html#cb58-17" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-18"><a href="figure-1.html#cb58-18" tabindex="-1"></a></span>
<span id="cb58-19"><a href="figure-1.html#cb58-19" tabindex="-1"></a>dat_d28 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D28.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-20"><a href="figure-1.html#cb58-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb58-21"><a href="figure-1.html#cb58-21" tabindex="-1"></a></span>
<span id="cb58-22"><a href="figure-1.html#cb58-22" tabindex="-1"></a>dat_d0_filter <span class="ot">&lt;-</span> dat_d0 <span class="sc">%&gt;%</span></span>
<span id="cb58-23"><a href="figure-1.html#cb58-23" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb58-24"><a href="figure-1.html#cb58-24" tabindex="-1"></a>dat_d14_filter <span class="ot">&lt;-</span> dat_d14 <span class="sc">%&gt;%</span></span>
<span id="cb58-25"><a href="figure-1.html#cb58-25" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb58-26"><a href="figure-1.html#cb58-26" tabindex="-1"></a>dat_d28_filter <span class="ot">&lt;-</span> dat_d28 <span class="sc">%&gt;%</span></span>
<span id="cb58-27"><a href="figure-1.html#cb58-27" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb58-28"><a href="figure-1.html#cb58-28" tabindex="-1"></a>name_overlap <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">intersect</span>(<span class="fu">intersect</span>(dat_d0_filter<span class="sc">$</span>label,dat_d14_filter<span class="sc">$</span>label),dat_d28_filter<span class="sc">$</span>label),HC_filter<span class="sc">$</span>label)</span>
<span id="cb58-29"><a href="figure-1.html#cb58-29" tabindex="-1"></a></span>
<span id="cb58-30"><a href="figure-1.html#cb58-30" tabindex="-1"></a>result_d0 <span class="ot">&lt;-</span> dat_d0 <span class="sc">%&gt;%</span></span>
<span id="cb58-31"><a href="figure-1.html#cb58-31" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label1=</span><span class="fu">ifelse</span>(label <span class="sc">%in%</span> name_overlap,label,<span class="cn">NA</span>))</span>
<span id="cb58-32"><a href="figure-1.html#cb58-32" tabindex="-1"></a></span>
<span id="cb58-33"><a href="figure-1.html#cb58-33" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_d0,<span class="fu">aes</span>(r,<span class="sc">-</span><span class="fu">log10</span>(p),<span class="at">color=</span>type))<span class="sc">+</span></span>
<span id="cb58-34"><a href="figure-1.html#cb58-34" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb58-35"><a href="figure-1.html#cb58-35" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span><span class="ot">=</span><span class="st">&quot;#F6631C&quot;</span>,<span class="st">&quot;Negative&quot;</span><span class="ot">=</span><span class="st">&quot;#2C91E0&quot;</span>,</span>
<span id="cb58-36"><a href="figure-1.html#cb58-36" tabindex="-1"></a>                              <span class="st">&quot;NotSig&quot;</span><span class="ot">=</span><span class="st">&quot;gray&quot;</span>))<span class="sc">+</span></span>
<span id="cb58-37"><a href="figure-1.html#cb58-37" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb58-38"><a href="figure-1.html#cb58-38" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb58-39"><a href="figure-1.html#cb58-39" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label=</span>label1),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb58-40"><a href="figure-1.html#cb58-40" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2D_result_age_serum_metabolite_D0.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb58-41"><a href="figure-1.html#cb58-41" tabindex="-1"></a></span>
<span id="cb58-42"><a href="figure-1.html#cb58-42" tabindex="-1"></a>result_HC <span class="ot">&lt;-</span> HC <span class="sc">%&gt;%</span></span>
<span id="cb58-43"><a href="figure-1.html#cb58-43" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label1=</span><span class="fu">ifelse</span>(label <span class="sc">%in%</span> name_overlap,label,<span class="cn">NA</span>))</span>
<span id="cb58-44"><a href="figure-1.html#cb58-44" tabindex="-1"></a></span>
<span id="cb58-45"><a href="figure-1.html#cb58-45" tabindex="-1"></a>p_HC <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(result_HC,<span class="fu">aes</span>(r,<span class="sc">-</span><span class="fu">log10</span>(p),<span class="at">color=</span>type))<span class="sc">+</span></span>
<span id="cb58-46"><a href="figure-1.html#cb58-46" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb58-47"><a href="figure-1.html#cb58-47" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Positive&quot;</span><span class="ot">=</span><span class="st">&quot;#F6631C&quot;</span>,<span class="st">&quot;Negative&quot;</span><span class="ot">=</span><span class="st">&quot;#2C91E0&quot;</span>,</span>
<span id="cb58-48"><a href="figure-1.html#cb58-48" tabindex="-1"></a>                              <span class="st">&quot;NotSig&quot;</span><span class="ot">=</span><span class="st">&quot;gray&quot;</span>))<span class="sc">+</span></span>
<span id="cb58-49"><a href="figure-1.html#cb58-49" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb58-50"><a href="figure-1.html#cb58-50" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb58-51"><a href="figure-1.html#cb58-51" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label=</span>label1),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb58-52"><a href="figure-1.html#cb58-52" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2D_result_age_serum_metabolite_HC.pdf&quot;</span>,p_HC,<span class="at">width=</span><span class="dv">6</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb58-53"><a href="figure-1.html#cb58-53" tabindex="-1"></a></span>
<span id="cb58-54"><a href="figure-1.html#cb58-54" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-55"><a href="figure-1.html#cb58-55" tabindex="-1"></a><span class="co">#  Step 2: The number of ALL specific ageing metabolites that excluded ageing-related metabolites in healthy at each time points</span></span>
<span id="cb58-56"><a href="figure-1.html#cb58-56" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb58-57"><a href="figure-1.html#cb58-57" tabindex="-1"></a><span class="fu">library</span>(VennDiagram)</span>
<span id="cb58-58"><a href="figure-1.html#cb58-58" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb58-59"><a href="figure-1.html#cb58-59" tabindex="-1"></a></span>
<span id="cb58-60"><a href="figure-1.html#cb58-60" tabindex="-1"></a>HC <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_HC.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-61"><a href="figure-1.html#cb58-61" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-62"><a href="figure-1.html#cb58-62" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb58-63"><a href="figure-1.html#cb58-63" tabindex="-1"></a></span>
<span id="cb58-64"><a href="figure-1.html#cb58-64" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D0.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-65"><a href="figure-1.html#cb58-65" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-66"><a href="figure-1.html#cb58-66" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-67"><a href="figure-1.html#cb58-67" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>label <span class="sc">%in%</span> HC<span class="sc">$</span>label)</span>
<span id="cb58-68"><a href="figure-1.html#cb58-68" tabindex="-1"></a></span>
<span id="cb58-69"><a href="figure-1.html#cb58-69" tabindex="-1"></a>D14 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D14.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-70"><a href="figure-1.html#cb58-70" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-71"><a href="figure-1.html#cb58-71" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-72"><a href="figure-1.html#cb58-72" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>label <span class="sc">%in%</span> HC<span class="sc">$</span>label)</span>
<span id="cb58-73"><a href="figure-1.html#cb58-73" tabindex="-1"></a></span>
<span id="cb58-74"><a href="figure-1.html#cb58-74" tabindex="-1"></a>D28 <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/age_serum_metabolite_D28.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-75"><a href="figure-1.html#cb58-75" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-76"><a href="figure-1.html#cb58-76" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-77"><a href="figure-1.html#cb58-77" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>label <span class="sc">%in%</span> HC<span class="sc">$</span>label)</span>
<span id="cb58-78"><a href="figure-1.html#cb58-78" tabindex="-1"></a></span>
<span id="cb58-79"><a href="figure-1.html#cb58-79" tabindex="-1"></a>venn.plot <span class="ot">&lt;-</span> <span class="fu">venn.diagram</span>(</span>
<span id="cb58-80"><a href="figure-1.html#cb58-80" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb58-81"><a href="figure-1.html#cb58-81" tabindex="-1"></a>    <span class="at">D0 =</span> D0<span class="sc">$</span>label,</span>
<span id="cb58-82"><a href="figure-1.html#cb58-82" tabindex="-1"></a>    <span class="at">D14 =</span> D14<span class="sc">$</span>label,</span>
<span id="cb58-83"><a href="figure-1.html#cb58-83" tabindex="-1"></a>    <span class="at">D28 =</span> D28<span class="sc">$</span>label</span>
<span id="cb58-84"><a href="figure-1.html#cb58-84" tabindex="-1"></a>  ),</span>
<span id="cb58-85"><a href="figure-1.html#cb58-85" tabindex="-1"></a>  <span class="co">#filename = &quot;result/Venn_correlation.png&quot;,imagetype = &quot;png&quot;,</span></span>
<span id="cb58-86"><a href="figure-1.html#cb58-86" tabindex="-1"></a>  <span class="at">filename =</span> <span class="cn">NULL</span>,</span>
<span id="cb58-87"><a href="figure-1.html#cb58-87" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb58-88"><a href="figure-1.html#cb58-88" tabindex="-1"></a>  <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="co">#边框线型改为&quot;dotted&quot;虚线</span></span>
<span id="cb58-89"><a href="figure-1.html#cb58-89" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span>, <span class="co"># 边框线的宽度</span></span>
<span id="cb58-90"><a href="figure-1.html#cb58-90" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;#D01910&quot;</span>,<span class="st">&quot;#FE7F2D&quot;</span>,<span class="st">&quot;#006633&quot;</span>),</span>
<span id="cb58-91"><a href="figure-1.html#cb58-91" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.90</span>,</span>
<span id="cb58-92"><a href="figure-1.html#cb58-92" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">2.0</span>,</span>
<span id="cb58-93"><a href="figure-1.html#cb58-93" tabindex="-1"></a>  <span class="at">fontfamily =</span> <span class="st">&quot;serif&quot;</span>,</span>
<span id="cb58-94"><a href="figure-1.html#cb58-94" tabindex="-1"></a>  <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb58-95"><a href="figure-1.html#cb58-95" tabindex="-1"></a>  <span class="at">cat.col =</span> <span class="fu">c</span>( <span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;darkorchid4&quot;</span>),</span>
<span id="cb58-96"><a href="figure-1.html#cb58-96" tabindex="-1"></a>  <span class="at">cat.cex =</span> <span class="fl">1.8</span>,</span>
<span id="cb58-97"><a href="figure-1.html#cb58-97" tabindex="-1"></a>  <span class="at">cat.fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb58-98"><a href="figure-1.html#cb58-98" tabindex="-1"></a>  <span class="at">cat.fontfamily =</span> <span class="st">&quot;serif&quot;</span></span>
<span id="cb58-99"><a href="figure-1.html#cb58-99" tabindex="-1"></a>)</span>
<span id="cb58-100"><a href="figure-1.html#cb58-100" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/S2D_correlation_venn_noHC.pdf&quot;</span>,<span class="at">width=</span><span class="dv">5</span>,<span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb58-101"><a href="figure-1.html#cb58-101" tabindex="-1"></a><span class="fu">grid.draw</span>(venn.plot)</span>
<span id="cb58-102"><a href="figure-1.html#cb58-102" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2D.png" width="369" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-e-box-plot" class="section level2 hasAnchor" number="16.11">
<h2><span class="header-section-number">16.11</span> (S2 E) Box plot<a href="figure-1.html#s2-e-box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The relative levels of 6 ageing-related metabolites. Related to Fig. 2b. Wilcoxon test was performed; **** P &lt; 0.001.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="figure-1.html#cb59-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-2"><a href="figure-1.html#cb59-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-3"><a href="figure-1.html#cb59-3" tabindex="-1"></a></span>
<span id="cb59-4"><a href="figure-1.html#cb59-4" tabindex="-1"></a>sample <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">1</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="figure-1.html#cb59-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="figure-1.html#cb59-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(METs_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="figure-1.html#cb59-7" tabindex="-1"></a>  <span class="fu">select</span>(METs_D0_ID,Age) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="figure-1.html#cb59-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Type =</span> <span class="fu">ifelse</span>(Age <span class="sc">&gt;</span> <span class="dv">40</span>,<span class="st">&quot;tumor&quot;</span>,</span>
<span id="cb59-9"><a href="figure-1.html#cb59-9" tabindex="-1"></a>                           <span class="fu">ifelse</span>(Age <span class="sc">&lt;=</span> <span class="dv">40</span>,<span class="st">&quot;normal&quot;</span>,<span class="cn">NA</span>)))</span>
<span id="cb59-10"><a href="figure-1.html#cb59-10" tabindex="-1"></a></span>
<span id="cb59-11"><a href="figure-1.html#cb59-11" tabindex="-1"></a>dat <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="figure-1.html#cb59-12" tabindex="-1"></a>  <span class="fu">filter</span>(Metabolite <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Hydroxy-cholenoic acid&quot;</span>,<span class="st">&quot;L-Threonine&quot;</span>,</span>
<span id="cb59-13"><a href="figure-1.html#cb59-13" tabindex="-1"></a>                           <span class="st">&quot;p-Hydroxyphenylacetic acid&quot;</span>,<span class="st">&quot;Glucose&quot;</span>,<span class="st">&quot;Cholic acid&quot;</span>,</span>
<span id="cb59-14"><a href="figure-1.html#cb59-14" tabindex="-1"></a>                           <span class="st">&quot;Ursodeoxycholic acid&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="figure-1.html#cb59-15" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-16"><a href="figure-1.html#cb59-16" tabindex="-1"></a>  <span class="fu">select</span>(sample<span class="sc">$</span>METs_D0_ID) <span class="sc">%&gt;%</span></span>
<span id="cb59-17"><a href="figure-1.html#cb59-17" tabindex="-1"></a>  <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-18"><a href="figure-1.html#cb59-18" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb59-19"><a href="figure-1.html#cb59-19" tabindex="-1"></a>dat_melt_D0 <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat,<span class="at">id=</span><span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-20"><a href="figure-1.html#cb59-20" tabindex="-1"></a>  <span class="fu">left_join</span>(sample,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;METs_D0_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-21"><a href="figure-1.html#cb59-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="st">&quot;D0&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-22"><a href="figure-1.html#cb59-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Type=</span><span class="fu">ifelse</span>(Age_Type<span class="sc">==</span><span class="st">&quot;tumor&quot;</span>,<span class="st">&quot;Old&quot;</span>,</span>
<span id="cb59-23"><a href="figure-1.html#cb59-23" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Age_Type<span class="sc">==</span><span class="st">&quot;normal&quot;</span>,<span class="st">&quot;Young&quot;</span>,<span class="st">&quot;a&quot;</span>)))</span>
<span id="cb59-24"><a href="figure-1.html#cb59-24" tabindex="-1"></a></span>
<span id="cb59-25"><a href="figure-1.html#cb59-25" tabindex="-1"></a><span class="do">## HC</span></span>
<span id="cb59-26"><a href="figure-1.html#cb59-26" tabindex="-1"></a><span class="do">## sample</span></span>
<span id="cb59-27"><a href="figure-1.html#cb59-27" tabindex="-1"></a>HCm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H280&quot;</span>,<span class="st">&quot;H281&quot;</span>)</span>
<span id="cb59-28"><a href="figure-1.html#cb59-28" tabindex="-1"></a></span>
<span id="cb59-29"><a href="figure-1.html#cb59-29" tabindex="-1"></a>sample <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/clinical_all_v231116.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-30"><a href="figure-1.html#cb59-30" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-31"><a href="figure-1.html#cb59-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>bianhao <span class="sc">%in%</span> <span class="fu">c</span>(HCm)) <span class="sc">%&gt;%</span></span>
<span id="cb59-32"><a href="figure-1.html#cb59-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sample_id<span class="sc">!=</span><span class="st">&quot;ND&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-33"><a href="figure-1.html#cb59-33" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bianhao,Lineage,Age) <span class="sc">%&gt;%</span></span>
<span id="cb59-34"><a href="figure-1.html#cb59-34" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(bianhao,<span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-35"><a href="figure-1.html#cb59-35" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Lineage <span class="sc">==</span> <span class="st">&quot;HC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-36"><a href="figure-1.html#cb59-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bianhao=</span><span class="fu">paste0</span>(bianhao,<span class="st">&quot;_METs&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-37"><a href="figure-1.html#cb59-37" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Type =</span> <span class="fu">ifelse</span>(Age <span class="sc">&gt;</span> <span class="dv">40</span>,<span class="st">&quot;tumor&quot;</span>,</span>
<span id="cb59-38"><a href="figure-1.html#cb59-38" tabindex="-1"></a>                           <span class="fu">ifelse</span>(Age <span class="sc">&lt;=</span> <span class="dv">40</span>,<span class="st">&quot;normal&quot;</span>,<span class="cn">NA</span>)))</span>
<span id="cb59-39"><a href="figure-1.html#cb59-39" tabindex="-1"></a></span>
<span id="cb59-40"><a href="figure-1.html#cb59-40" tabindex="-1"></a>dat <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-41"><a href="figure-1.html#cb59-41" tabindex="-1"></a>  <span class="fu">filter</span>(Metabolite <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Hydroxy-cholenoic acid&quot;</span>,</span>
<span id="cb59-42"><a href="figure-1.html#cb59-42" tabindex="-1"></a>                           <span class="st">&quot;p-Hydroxyphenylacetic acid&quot;</span>,<span class="st">&quot;Glucose&quot;</span>,<span class="st">&quot;Cholic acid&quot;</span>,</span>
<span id="cb59-43"><a href="figure-1.html#cb59-43" tabindex="-1"></a>                           <span class="st">&quot;Ursodeoxycholic acid&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-44"><a href="figure-1.html#cb59-44" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-45"><a href="figure-1.html#cb59-45" tabindex="-1"></a>  <span class="fu">select</span>(sample<span class="sc">$</span>bianhao) <span class="sc">%&gt;%</span></span>
<span id="cb59-46"><a href="figure-1.html#cb59-46" tabindex="-1"></a>  <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-47"><a href="figure-1.html#cb59-47" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;metabolite&quot;</span>)</span>
<span id="cb59-48"><a href="figure-1.html#cb59-48" tabindex="-1"></a>dat_melt_HC <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(dat,<span class="at">id=</span><span class="st">&quot;metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-49"><a href="figure-1.html#cb59-49" tabindex="-1"></a>  <span class="fu">left_join</span>(sample,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span><span class="ot">=</span><span class="st">&quot;bianhao&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-50"><a href="figure-1.html#cb59-50" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group=</span><span class="st">&quot;HC&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-51"><a href="figure-1.html#cb59-51" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Lineage) <span class="sc">%&gt;%</span></span>
<span id="cb59-52"><a href="figure-1.html#cb59-52" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Type=</span><span class="fu">ifelse</span>(Age_Type<span class="sc">==</span><span class="st">&quot;tumor&quot;</span>,<span class="st">&quot;Old&quot;</span>,</span>
<span id="cb59-53"><a href="figure-1.html#cb59-53" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Age_Type<span class="sc">==</span><span class="st">&quot;normal&quot;</span>,<span class="st">&quot;Young&quot;</span>,<span class="st">&quot;a&quot;</span>)))</span>
<span id="cb59-54"><a href="figure-1.html#cb59-54" tabindex="-1"></a></span>
<span id="cb59-55"><a href="figure-1.html#cb59-55" tabindex="-1"></a>dat_result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat_melt_D0,dat_melt_HC)</span>
<span id="cb59-56"><a href="figure-1.html#cb59-56" tabindex="-1"></a></span>
<span id="cb59-57"><a href="figure-1.html#cb59-57" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_result,<span class="fu">aes</span>(group,value,<span class="at">fill=</span>Age_Type,<span class="at">color=</span>Age_Type))<span class="sc">+</span></span>
<span id="cb59-58"><a href="figure-1.html#cb59-58" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb59-59"><a href="figure-1.html#cb59-59" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()<span class="sc">+</span></span>
<span id="cb59-60"><a href="figure-1.html#cb59-60" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(metabolite),<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-61"><a href="figure-1.html#cb59-61" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb59-62"><a href="figure-1.html#cb59-62" tabindex="-1"></a></span>
<span id="cb59-63"><a href="figure-1.html#cb59-63" tabindex="-1"></a><span class="co">#&quot;#0095FF&quot;,&quot;#F94141&quot;</span></span>
<span id="cb59-64"><a href="figure-1.html#cb59-64" tabindex="-1"></a>dat_melt_D0<span class="sc">$</span>Age_Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_melt_D0<span class="sc">$</span>Age_Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Young&quot;</span>,<span class="st">&quot;Old&quot;</span>))</span>
<span id="cb59-65"><a href="figure-1.html#cb59-65" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt_D0,<span class="fu">aes</span>(Age_Type,value))<span class="sc">+</span></span>
<span id="cb59-66"><a href="figure-1.html#cb59-66" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb59-67"><a href="figure-1.html#cb59-67" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span>Age_Type),<span class="at">size=</span>.<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb59-68"><a href="figure-1.html#cb59-68" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">label=</span><span class="st">&quot;p.signif&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-69"><a href="figure-1.html#cb59-69" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Old&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;Young&quot;</span><span class="ot">=</span><span class="st">&quot;#0095FF&quot;</span>))<span class="sc">+</span></span>
<span id="cb59-70"><a href="figure-1.html#cb59-70" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(metabolite),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-71"><a href="figure-1.html#cb59-71" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-72"><a href="figure-1.html#cb59-72" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="cn">NULL</span>)</span>
<span id="cb59-73"><a href="figure-1.html#cb59-73" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2E_boxplot_5_D0.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">90</span>,<span class="at">height =</span> <span class="dv">70</span>,<span class="at">units=</span><span class="st">&quot;mm&quot;</span>)</span>
<span id="cb59-74"><a href="figure-1.html#cb59-74" tabindex="-1"></a></span>
<span id="cb59-75"><a href="figure-1.html#cb59-75" tabindex="-1"></a>dat_melt_HC<span class="sc">$</span>Age_Type <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat_melt_HC<span class="sc">$</span>Age_Type,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;Young&quot;</span>,<span class="st">&quot;Old&quot;</span>))</span>
<span id="cb59-76"><a href="figure-1.html#cb59-76" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_melt_HC,<span class="fu">aes</span>(Age_Type,value))<span class="sc">+</span></span>
<span id="cb59-77"><a href="figure-1.html#cb59-77" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb59-78"><a href="figure-1.html#cb59-78" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">color=</span>Age_Type),<span class="at">size=</span>.<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb59-79"><a href="figure-1.html#cb59-79" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_compare_means</span>(<span class="at">label=</span><span class="st">&quot;p.signif&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-80"><a href="figure-1.html#cb59-80" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;Old&quot;</span><span class="ot">=</span><span class="st">&quot;#F94141&quot;</span>,<span class="st">&quot;Young&quot;</span><span class="ot">=</span><span class="st">&quot;#0095FF&quot;</span>))<span class="sc">+</span></span>
<span id="cb59-81"><a href="figure-1.html#cb59-81" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(metabolite),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-82"><a href="figure-1.html#cb59-82" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-83"><a href="figure-1.html#cb59-83" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="cn">NULL</span>,<span class="at">y=</span><span class="cn">NULL</span>)</span>
<span id="cb59-84"><a href="figure-1.html#cb59-84" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;result/Figure1/S2E_boxplot_5_HC.pdf&quot;</span>,p,<span class="at">width=</span><span class="dv">90</span>,<span class="at">height =</span> <span class="dv">70</span>,<span class="at">units=</span><span class="st">&quot;mm&quot;</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2E.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-f-overall-survival-analysis" class="section level2 hasAnchor" number="16.12">
<h2><span class="header-section-number">16.12</span> (S2 F) Overall Survival analysis<a href="figure-1.html#s2-f-overall-survival-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Overall Survival analysis reveals that serum level of taurocholic acid as a poor prognostic indicator.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="figure-1.html#cb60-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-2"><a href="figure-1.html#cb60-2" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb60-3"><a href="figure-1.html#cb60-3" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb60-4"><a href="figure-1.html#cb60-4" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb60-5"><a href="figure-1.html#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="figure-1.html#cb60-6" tabindex="-1"></a>sample_patient_all <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/08 队列病人生存资料.xlsx&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-7"><a href="figure-1.html#cb60-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="figure-1.html#cb60-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(bianhao,OS,OS_stat) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="figure-1.html#cb60-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pid=</span><span class="fu">gsub</span>(<span class="st">&quot;A|C|E&quot;</span>,<span class="st">&quot;RJ-&quot;</span>,bianhao)) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="figure-1.html#cb60-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">METs_D0_ID=</span><span class="fu">paste0</span>(Pid,<span class="st">&quot;_METs_D0&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="figure-1.html#cb60-11" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(OS)) <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="figure-1.html#cb60-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">OS=</span>(OS)<span class="sc">/</span><span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="figure-1.html#cb60-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OS_status=</span>OS_stat)</span>
<span id="cb60-14"><a href="figure-1.html#cb60-14" tabindex="-1"></a></span>
<span id="cb60-15"><a href="figure-1.html#cb60-15" tabindex="-1"></a>dd <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;raw_data/Supplementary Tables.xlsx&quot;</span>,<span class="at">sheet=</span><span class="dv">4</span>,<span class="at">skip=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-16"><a href="figure-1.html#cb60-16" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb60-17"><a href="figure-1.html#cb60-17" tabindex="-1"></a></span>
<span id="cb60-18"><a href="figure-1.html#cb60-18" tabindex="-1"></a>overlap_name <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(dd),sample_patient_all<span class="sc">$</span>METs_D0_ID)</span>
<span id="cb60-19"><a href="figure-1.html#cb60-19" tabindex="-1"></a></span>
<span id="cb60-20"><a href="figure-1.html#cb60-20" tabindex="-1"></a>dd_temp <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span></span>
<span id="cb60-21"><a href="figure-1.html#cb60-21" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Metabolite,<span class="fu">all_of</span>(overlap_name))</span>
<span id="cb60-22"><a href="figure-1.html#cb60-22" tabindex="-1"></a></span>
<span id="cb60-23"><a href="figure-1.html#cb60-23" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dd_temp <span class="sc">%&gt;%</span></span>
<span id="cb60-24"><a href="figure-1.html#cb60-24" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(Metabolite <span class="sc">%in%</span> <span class="st">&quot;Taurocholic acid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-25"><a href="figure-1.html#cb60-25" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;Metabolite&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-26"><a href="figure-1.html#cb60-26" tabindex="-1"></a>    <span class="fu">log1p</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-27"><a href="figure-1.html#cb60-27" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-28"><a href="figure-1.html#cb60-28" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-29"><a href="figure-1.html#cb60-29" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;sample&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-30"><a href="figure-1.html#cb60-30" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(sample_patient_all,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;sample&quot;</span><span class="ot">=</span><span class="st">&quot;METs_D0_ID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-31"><a href="figure-1.html#cb60-31" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">match</span>(sample,sample_patient_all<span class="sc">$</span>METs_D0_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb60-32"><a href="figure-1.html#cb60-32" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">&quot;TC&quot;</span><span class="ot">=</span><span class="st">&quot;Taurocholic acid&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-33"><a href="figure-1.html#cb60-33" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">TC_type=</span><span class="fu">ifelse</span>(TC <span class="sc">&gt;=</span> <span class="fu">median</span>(TC),<span class="st">&quot;High&quot;</span>,<span class="st">&quot;Low&quot;</span>)) </span>
<span id="cb60-34"><a href="figure-1.html#cb60-34" tabindex="-1"></a></span>
<span id="cb60-35"><a href="figure-1.html#cb60-35" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(OS, OS_status) <span class="sc">~</span> TC_type, <span class="at">data =</span> dd)</span>
<span id="cb60-36"><a href="figure-1.html#cb60-36" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(fit1, </span>
<span id="cb60-37"><a href="figure-1.html#cb60-37" tabindex="-1"></a>                   <span class="at">data =</span> dd,</span>
<span id="cb60-38"><a href="figure-1.html#cb60-38" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">&#39;Time (Months)&#39;</span>,</span>
<span id="cb60-39"><a href="figure-1.html#cb60-39" tabindex="-1"></a>                   <span class="at">pval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-40"><a href="figure-1.html#cb60-40" tabindex="-1"></a>                   <span class="at">risk.table =</span> <span class="cn">TRUE</span>, </span>
<span id="cb60-41"><a href="figure-1.html#cb60-41" tabindex="-1"></a>                   <span class="at">risk.table.height =</span> <span class="fl">0.28</span>,</span>
<span id="cb60-42"><a href="figure-1.html#cb60-42" tabindex="-1"></a>                   <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.int.alpha =</span> <span class="fl">0.05</span>,</span>
<span id="cb60-43"><a href="figure-1.html#cb60-43" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#d80700&quot;</span>,<span class="st">&quot;#00599F&quot;</span>),</span>
<span id="cb60-44"><a href="figure-1.html#cb60-44" tabindex="-1"></a>                   <span class="at">axes.offset =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-45"><a href="figure-1.html#cb60-45" tabindex="-1"></a>                   <span class="at">break.time.by =</span> <span class="dv">12</span>,  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),</span>
<span id="cb60-46"><a href="figure-1.html#cb60-46" tabindex="-1"></a>                   <span class="at">title=</span> <span class="st">&quot;Taurocholic acid&quot;</span>)</span>
<span id="cb60-47"><a href="figure-1.html#cb60-47" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;result/Figure1/S2F_new-Taurocholic acid.pdf&quot;</span>,<span class="at">onefile =</span> F)</span>
<span id="cb60-48"><a href="figure-1.html#cb60-48" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb60-49"><a href="figure-1.html#cb60-49" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2F.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-g-box-plot" class="section level2 hasAnchor" number="16.13">
<h2><span class="header-section-number">16.13</span> (S2 G) Box plot<a href="figure-1.html#s2-g-box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The relative levels of pseudouridine and 7-methylguanosine compared to their precursors, uridine and guanosine, respectively. Wilcoxon test was performed; **** P &lt; 0.001.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="figure-1.html#cb61-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb61-2"><a href="figure-1.html#cb61-2" tabindex="-1"></a><span class="fu">library</span>(MNet)</span>
<span id="cb61-3"><a href="figure-1.html#cb61-3" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb61-4"><a href="figure-1.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="figure-1.html#cb61-5" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-6"><a href="figure-1.html#cb61-6" tabindex="-1"></a><span class="co">#  Step 1: Load data and conduct mlimma</span></span>
<span id="cb61-7"><a href="figure-1.html#cb61-7" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb61-8"><a href="figure-1.html#cb61-8" tabindex="-1"></a><span class="do">## BCP-ALL vs HC</span></span>
<span id="cb61-9"><a href="figure-1.html#cb61-9" tabindex="-1"></a>clinical <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/clinical_all_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="figure-1.html#cb61-10" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="figure-1.html#cb61-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;HC&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-12"><a href="figure-1.html#cb61-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(METs_ID,Lineage)</span>
<span id="cb61-13"><a href="figure-1.html#cb61-13" tabindex="-1"></a></span>
<span id="cb61-14"><a href="figure-1.html#cb61-14" tabindex="-1"></a>datRAW <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-15"><a href="figure-1.html#cb61-15" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-16"><a href="figure-1.html#cb61-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(label,<span class="fu">all_of</span>(clinical<span class="sc">$</span>METs_ID)) <span class="sc">%&gt;%</span></span>
<span id="cb61-17"><a href="figure-1.html#cb61-17" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>)</span>
<span id="cb61-18"><a href="figure-1.html#cb61-18" tabindex="-1"></a></span>
<span id="cb61-19"><a href="figure-1.html#cb61-19" tabindex="-1"></a>clinicalBH <span class="ot">&lt;-</span> clinical <span class="sc">%&gt;%</span></span>
<span id="cb61-20"><a href="figure-1.html#cb61-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(clinical<span class="sc">$</span>Lineage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;HC&quot;</span>))</span>
<span id="cb61-21"><a href="figure-1.html#cb61-21" tabindex="-1"></a>datBH <span class="ot">&lt;-</span> datRAW <span class="sc">%&gt;%</span></span>
<span id="cb61-22"><a href="figure-1.html#cb61-22" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(clinicalBH<span class="sc">$</span>METs_ID) <span class="sc">%&gt;%</span></span>
<span id="cb61-23"><a href="figure-1.html#cb61-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;RJ&quot;</span>),<span class="fu">everything</span>())</span>
<span id="cb61-24"><a href="figure-1.html#cb61-24" tabindex="-1"></a>datBH <span class="ot">&lt;-</span> <span class="fu">log2</span>(datBH<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb61-25"><a href="figure-1.html#cb61-25" tabindex="-1"></a><span class="fu">dim</span>(datBH)</span>
<span id="cb61-26"><a href="figure-1.html#cb61-26" tabindex="-1"></a></span>
<span id="cb61-27"><a href="figure-1.html#cb61-27" tabindex="-1"></a>matching_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;H&quot;</span>,<span class="fu">colnames</span>(datBH),<span class="at">value =</span> T)</span>
<span id="cb61-28"><a href="figure-1.html#cb61-28" tabindex="-1"></a><span class="fu">length</span>(matching_columns)</span>
<span id="cb61-29"><a href="figure-1.html#cb61-29" tabindex="-1"></a><span class="fu">length</span>(datBH)</span>
<span id="cb61-30"><a href="figure-1.html#cb61-30" tabindex="-1"></a></span>
<span id="cb61-31"><a href="figure-1.html#cb61-31" tabindex="-1"></a>group_BH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;tumor&quot;</span>,<span class="dv">137</span>),<span class="fu">rep</span>(<span class="st">&quot;normal&quot;</span>,<span class="dv">164</span>))</span>
<span id="cb61-32"><a href="figure-1.html#cb61-32" tabindex="-1"></a><span class="fu">table</span>(group_BH)</span>
<span id="cb61-33"><a href="figure-1.html#cb61-33" tabindex="-1"></a></span>
<span id="cb61-34"><a href="figure-1.html#cb61-34" tabindex="-1"></a>meta_BH <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(datBH,<span class="at">group =</span> group_BH)</span>
<span id="cb61-35"><a href="figure-1.html#cb61-35" tabindex="-1"></a><span class="fu">write.table</span>(meta_BH,<span class="st">&quot;result/Figure1/S2A_BvsH.txt&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">row.names =</span> F,<span class="at">quote =</span> F)</span>
<span id="cb61-36"><a href="figure-1.html#cb61-36" tabindex="-1"></a></span>
<span id="cb61-37"><a href="figure-1.html#cb61-37" tabindex="-1"></a><span class="do">## T-ALL vs HC</span></span>
<span id="cb61-38"><a href="figure-1.html#cb61-38" tabindex="-1"></a>clinicalTH <span class="ot">&lt;-</span> clinical <span class="sc">%&gt;%</span></span>
<span id="cb61-39"><a href="figure-1.html#cb61-39" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(clinical<span class="sc">$</span>Lineage <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;T&quot;</span>,<span class="st">&quot;HC&quot;</span>))</span>
<span id="cb61-40"><a href="figure-1.html#cb61-40" tabindex="-1"></a>datTH <span class="ot">&lt;-</span> datRAW <span class="sc">%&gt;%</span></span>
<span id="cb61-41"><a href="figure-1.html#cb61-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(clinicalTH<span class="sc">$</span>METs_ID) <span class="sc">%&gt;%</span></span>
<span id="cb61-42"><a href="figure-1.html#cb61-42" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;RJ&quot;</span>),<span class="fu">everything</span>())</span>
<span id="cb61-43"><a href="figure-1.html#cb61-43" tabindex="-1"></a>datTH <span class="ot">&lt;-</span> <span class="fu">log2</span>(datTH<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb61-44"><a href="figure-1.html#cb61-44" tabindex="-1"></a><span class="fu">dim</span>(datTH)</span>
<span id="cb61-45"><a href="figure-1.html#cb61-45" tabindex="-1"></a></span>
<span id="cb61-46"><a href="figure-1.html#cb61-46" tabindex="-1"></a>matching_columns <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;H&quot;</span>,<span class="fu">colnames</span>(datTH),<span class="at">value =</span> T)</span>
<span id="cb61-47"><a href="figure-1.html#cb61-47" tabindex="-1"></a><span class="fu">length</span>(matching_columns)</span>
<span id="cb61-48"><a href="figure-1.html#cb61-48" tabindex="-1"></a><span class="fu">length</span>(datTH)</span>
<span id="cb61-49"><a href="figure-1.html#cb61-49" tabindex="-1"></a></span>
<span id="cb61-50"><a href="figure-1.html#cb61-50" tabindex="-1"></a>group_TH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;tumor&quot;</span>,<span class="dv">43</span>),<span class="fu">rep</span>(<span class="st">&quot;normal&quot;</span>,<span class="dv">164</span>))</span>
<span id="cb61-51"><a href="figure-1.html#cb61-51" tabindex="-1"></a><span class="fu">table</span>(group_TH)</span>
<span id="cb61-52"><a href="figure-1.html#cb61-52" tabindex="-1"></a></span>
<span id="cb61-53"><a href="figure-1.html#cb61-53" tabindex="-1"></a>meta_TH <span class="ot">&lt;-</span> <span class="fu">mlimma</span>(datTH,<span class="at">group =</span> group_TH)</span>
<span id="cb61-54"><a href="figure-1.html#cb61-54" tabindex="-1"></a><span class="fu">write.table</span>(meta_TH,<span class="st">&quot;result/Figure1/S2A_TvsH.txt&quot;</span>,<span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="at">row.names =</span> F,<span class="at">quote =</span> F)</span>
<span id="cb61-55"><a href="figure-1.html#cb61-55" tabindex="-1"></a></span>
<span id="cb61-56"><a href="figure-1.html#cb61-56" tabindex="-1"></a><span class="do">## selected boxplots</span></span>
<span id="cb61-57"><a href="figure-1.html#cb61-57" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pseudouridine&quot;</span>,<span class="st">&quot;7-Methylguanosine&quot;</span>,<span class="st">&quot;Guanosine&quot;</span>,<span class="st">&quot;Uridine&quot;</span>)</span>
<span id="cb61-58"><a href="figure-1.html#cb61-58" tabindex="-1"></a>meta_BH_filter <span class="ot">&lt;-</span> meta_BH <span class="sc">%&gt;%</span></span>
<span id="cb61-59"><a href="figure-1.html#cb61-59" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb61-60"><a href="figure-1.html#cb61-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(P.Value,name) <span class="sc">%&gt;%</span></span>
<span id="cb61-61"><a href="figure-1.html#cb61-61" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">rep</span>(<span class="st">&quot;BH&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb61-62"><a href="figure-1.html#cb61-62" tabindex="-1"></a>meta_TH_filter <span class="ot">&lt;-</span> meta_TH <span class="sc">%&gt;%</span></span>
<span id="cb61-63"><a href="figure-1.html#cb61-63" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(name <span class="sc">%in%</span> label) <span class="sc">%&gt;%</span></span>
<span id="cb61-64"><a href="figure-1.html#cb61-64" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(P.Value,name) <span class="sc">%&gt;%</span></span>
<span id="cb61-65"><a href="figure-1.html#cb61-65" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">rep</span>(<span class="st">&quot;TH&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb61-66"><a href="figure-1.html#cb61-66" tabindex="-1"></a>meta_all_filter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(meta_BH_filter,meta_TH_filter) <span class="sc">%&gt;%</span></span>
<span id="cb61-67"><a href="figure-1.html#cb61-67" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name,<span class="at">levels=</span>label)) <span class="sc">%&gt;%</span></span>
<span id="cb61-68"><a href="figure-1.html#cb61-68" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(name)</span>
<span id="cb61-69"><a href="figure-1.html#cb61-69" tabindex="-1"></a><span class="fu">write.table</span>(meta_all_filter,<span class="st">&quot;result/Figure1/S2A_meta_groupcomparison.txt&quot;</span>,<span class="at">quote =</span> F,<span class="at">row.names =</span> F,<span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>) </span>
<span id="cb61-70"><a href="figure-1.html#cb61-70" tabindex="-1"></a></span>
<span id="cb61-71"><a href="figure-1.html#cb61-71" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb61-72"><a href="figure-1.html#cb61-72" tabindex="-1"></a><span class="co">#  Step 2: Boxplot</span></span>
<span id="cb61-73"><a href="figure-1.html#cb61-73" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb61-74"><a href="figure-1.html#cb61-74" tabindex="-1"></a>name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pseudouridine&quot;</span>,<span class="st">&quot;7-Methylguanosine&quot;</span>,<span class="st">&quot;Guanosine&quot;</span>,<span class="st">&quot;Uridine&quot;</span>)</span>
<span id="cb61-75"><a href="figure-1.html#cb61-75" tabindex="-1"></a>datRAW <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_raw_sva_data_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-76"><a href="figure-1.html#cb61-76" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-77"><a href="figure-1.html#cb61-77" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(label,<span class="fu">all_of</span>(clinical<span class="sc">$</span>METs_ID))</span>
<span id="cb61-78"><a href="figure-1.html#cb61-78" tabindex="-1"></a>drawdata <span class="ot">&lt;-</span> datRAW <span class="sc">%&gt;%</span> </span>
<span id="cb61-79"><a href="figure-1.html#cb61-79" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">%in%</span> name)  <span class="sc">%&gt;%</span> </span>
<span id="cb61-80"><a href="figure-1.html#cb61-80" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(label,clinical<span class="sc">$</span>METs_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb61-81"><a href="figure-1.html#cb61-81" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">&quot;label&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-82"><a href="figure-1.html#cb61-82" tabindex="-1"></a>  <span class="fu">myscale</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-83"><a href="figure-1.html#cb61-83" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-84"><a href="figure-1.html#cb61-84" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;METs_ID&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-85"><a href="figure-1.html#cb61-85" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(clinical,<span class="at">by=</span><span class="st">&quot;METs_ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-86"><a href="figure-1.html#cb61-86" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(METs_ID,Guanosine,<span class="st">`</span><span class="at">7-Methylguanosine</span><span class="st">`</span>,Uridine,Pseudouridine,Lineage)</span>
<span id="cb61-87"><a href="figure-1.html#cb61-87" tabindex="-1"></a></span>
<span id="cb61-88"><a href="figure-1.html#cb61-88" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(drawdata)<span class="sc">-</span><span class="dv">1</span>) {</span>
<span id="cb61-89"><a href="figure-1.html#cb61-89" tabindex="-1"></a>  variable<span class="ot">=</span><span class="fu">colnames</span>(drawdata)[i]</span>
<span id="cb61-90"><a href="figure-1.html#cb61-90" tabindex="-1"></a>  df <span class="ot">&lt;-</span> drawdata <span class="sc">%&gt;%</span></span>
<span id="cb61-91"><a href="figure-1.html#cb61-91" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">all_of</span>(variable),Lineage)<span class="sc">%&gt;%</span> </span>
<span id="cb61-92"><a href="figure-1.html#cb61-92" tabindex="-1"></a>    rstatix<span class="sc">::</span><span class="fu">reorder_levels</span>(Lineage, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;HC&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;T&quot;</span>))</span>
<span id="cb61-93"><a href="figure-1.html#cb61-93" tabindex="-1"></a>  df<span class="sc">$</span>index <span class="ot">&lt;-</span> df[, <span class="dv">1</span>]</span>
<span id="cb61-94"><a href="figure-1.html#cb61-94" tabindex="-1"></a>  my_comparisons <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="fu">c</span>(<span class="st">&quot;HC&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;HC&quot;</span>, <span class="st">&quot;T&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;T&quot;</span>) )</span>
<span id="cb61-95"><a href="figure-1.html#cb61-95" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">&quot;pp&quot;</span>, i),</span>
<span id="cb61-96"><a href="figure-1.html#cb61-96" tabindex="-1"></a>         <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">y =</span> index, <span class="at">x =</span> Lineage,<span class="at">fill=</span><span class="fu">factor</span>(Lineage))) <span class="sc">+</span></span>
<span id="cb61-97"><a href="figure-1.html#cb61-97" tabindex="-1"></a>           <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb61-98"><a href="figure-1.html#cb61-98" tabindex="-1"></a>           <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>,<span class="at">size=</span><span class="fl">0.5</span>,<span class="at">alpha=</span><span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb61-99"><a href="figure-1.html#cb61-99" tabindex="-1"></a>           <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#007DDB&quot;</span>,<span class="st">&quot;#E5E059&quot;</span>,<span class="st">&quot;#4B0082&quot;</span>))<span class="sc">+</span></span>
<span id="cb61-100"><a href="figure-1.html#cb61-100" tabindex="-1"></a>           <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb61-101"><a href="figure-1.html#cb61-101" tabindex="-1"></a>           <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span><span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb61-102"><a href="figure-1.html#cb61-102" tabindex="-1"></a>           <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">paste0</span>(variable),<span class="at">y=</span><span class="cn">NULL</span>)</span>
<span id="cb61-103"><a href="figure-1.html#cb61-103" tabindex="-1"></a>  )</span>
<span id="cb61-104"><a href="figure-1.html#cb61-104" tabindex="-1"></a>}</span>
<span id="cb61-105"><a href="figure-1.html#cb61-105" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb61-106"><a href="figure-1.html#cb61-106" tabindex="-1"></a>(p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(pp2, pp3, pp4,pp5,<span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb61-107"><a href="figure-1.html#cb61-107" tabindex="-1"></a><span class="fu">ggsave</span>(p1,<span class="at">filename=</span><span class="st">&quot;result/Figure1/S2G_boxplot.pdf&quot;</span>,</span>
<span id="cb61-108"><a href="figure-1.html#cb61-108" tabindex="-1"></a>       <span class="at">width=</span><span class="dv">12</span>,<span class="at">height=</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2G.png" width="552" style="display: block; margin: auto;" /></p>
</div>
<div id="s2-h-metabolism-set-enrichment-analysis" class="section level2 hasAnchor" number="16.14">
<h2><span class="header-section-number">16.14</span> (S2 H) Metabolism Set Enrichment Analysis<a href="figure-1.html#s2-h-metabolism-set-enrichment-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The pathway enrichment analysis reveals pathways influenced by the response of various body organs, particularly noteworthy were the environmental information processing pathways. ABC: ATP-binding cassette transporters.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="figure-1.html#cb62-1" tabindex="-1"></a><span class="fu">library</span>(tidymass)</span>
<span id="cb62-2"><a href="figure-1.html#cb62-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb62-3"><a href="figure-1.html#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="figure-1.html#cb62-4" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-5"><a href="figure-1.html#cb62-5" tabindex="-1"></a><span class="co">#  Step 1: Load data and set parameters</span></span>
<span id="cb62-6"><a href="figure-1.html#cb62-6" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb62-7"><a href="figure-1.html#cb62-7" tabindex="-1"></a>kid <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;raw_data/serum_metabolites_id_v240328.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="figure-1.html#cb62-8" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb62-9"><a href="figure-1.html#cb62-9" tabindex="-1"></a></span>
<span id="cb62-10"><a href="figure-1.html#cb62-10" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;result/Figure1/AvsHC.txt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="figure-1.html#cb62-11" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-12"><a href="figure-1.html#cb62-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(kid,<span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Name&quot;</span><span class="ot">=</span><span class="st">&quot;query&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="figure-1.html#cb62-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Padj_wilcox <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb62-14"><a href="figure-1.html#cb62-14" tabindex="-1"></a></span>
<span id="cb62-15"><a href="figure-1.html#cb62-15" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;kegg_hsa_pathway&quot;</span>, <span class="at">package =</span> <span class="st">&quot;metpath&quot;</span>)</span>
<span id="cb62-16"><a href="figure-1.html#cb62-16" tabindex="-1"></a></span>
<span id="cb62-17"><a href="figure-1.html#cb62-17" tabindex="-1"></a><span class="do">## Remove the disease pathway</span></span>
<span id="cb62-18"><a href="figure-1.html#cb62-18" tabindex="-1"></a>pathway_class <span class="ot">=</span> metpath<span class="sc">::</span><span class="fu">pathway_class</span>(kegg_hsa_pathway)</span>
<span id="cb62-19"><a href="figure-1.html#cb62-19" tabindex="-1"></a>remain_idx <span class="ot">=</span> pathway_class <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="figure-1.html#cb62-20" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="figure-1.html#cb62-21" tabindex="-1"></a>  stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="st">&quot;Disease&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="figure-1.html#cb62-22" tabindex="-1"></a>  <span class="st">`</span><span class="at">!</span><span class="st">`</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-23"><a href="figure-1.html#cb62-23" tabindex="-1"></a>  <span class="fu">which</span>()</span>
<span id="cb62-24"><a href="figure-1.html#cb62-24" tabindex="-1"></a>pathway_database <span class="ot">=</span> kegg_hsa_pathway[remain_idx]</span>
<span id="cb62-25"><a href="figure-1.html#cb62-25" tabindex="-1"></a></span>
<span id="cb62-26"><a href="figure-1.html#cb62-26" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb62-27"><a href="figure-1.html#cb62-27" tabindex="-1"></a><span class="co">#  Step 2: Enrichment analysis</span></span>
<span id="cb62-28"><a href="figure-1.html#cb62-28" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb62-29"><a href="figure-1.html#cb62-29" tabindex="-1"></a>diff.kid <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span> </span>
<span id="cb62-30"><a href="figure-1.html#cb62-30" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(KEGG<span class="sc">!=</span><span class="st">&quot;None&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-31"><a href="figure-1.html#cb62-31" tabindex="-1"></a>  <span class="fu">pull</span>(KEGG) <span class="sc">%&gt;%</span> </span>
<span id="cb62-32"><a href="figure-1.html#cb62-32" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb62-33"><a href="figure-1.html#cb62-33" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">enrich_kegg</span>(<span class="at">query_id =</span> diff.kid, </span>
<span id="cb62-34"><a href="figure-1.html#cb62-34" tabindex="-1"></a>                      <span class="at">query_type =</span> <span class="st">&quot;compound&quot;</span>, </span>
<span id="cb62-35"><a href="figure-1.html#cb62-35" tabindex="-1"></a>                      <span class="at">id_type =</span> <span class="st">&quot;KEGG&quot;</span>,</span>
<span id="cb62-36"><a href="figure-1.html#cb62-36" tabindex="-1"></a>                      <span class="at">pathway_database =</span> pathway_database, </span>
<span id="cb62-37"><a href="figure-1.html#cb62-37" tabindex="-1"></a>                      <span class="at">p_cutoff =</span> <span class="fl">0.05</span>, </span>
<span id="cb62-38"><a href="figure-1.html#cb62-38" tabindex="-1"></a>                      <span class="at">p_adjust_method =</span> <span class="st">&quot;BH&quot;</span>, </span>
<span id="cb62-39"><a href="figure-1.html#cb62-39" tabindex="-1"></a>                      <span class="at">threads =</span> <span class="dv">5</span>)</span>
<span id="cb62-40"><a href="figure-1.html#cb62-40" tabindex="-1"></a>msea_table <span class="ot">&lt;-</span> result<span class="sc">@</span>result <span class="sc">%&gt;%</span> </span>
<span id="cb62-41"><a href="figure-1.html#cb62-41" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p_value) <span class="sc">%&gt;%</span> </span>
<span id="cb62-42"><a href="figure-1.html#cb62-42" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb62-43"><a href="figure-1.html#cb62-43" tabindex="-1"></a>tablefilter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(msea_table,p_value<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb62-44"><a href="figure-1.html#cb62-44" tabindex="-1"></a><span class="fu">write.csv</span>(msea_table,<span class="st">&quot;result/Figure1/S2H_table.csv&quot;</span>)</span>
<span id="cb62-45"><a href="figure-1.html#cb62-45" tabindex="-1"></a>pic <span class="ot">&lt;-</span> <span class="fu">enrich_scatter_plot</span>(<span class="at">object =</span> result, </span>
<span id="cb62-46"><a href="figure-1.html#cb62-46" tabindex="-1"></a>                           <span class="at">y_axis =</span> <span class="st">&quot;p_value&quot;</span>, <span class="at">y_axis_cutoff =</span> <span class="fl">0.05</span>,</span>
<span id="cb62-47"><a href="figure-1.html#cb62-47" tabindex="-1"></a>                           <span class="at">point_size =</span> <span class="st">&quot;mapped_percentage&quot;</span>,<span class="at">label_size =</span> <span class="dv">3</span>)</span>
<span id="cb62-48"><a href="figure-1.html#cb62-48" tabindex="-1"></a><span class="fu">ggsave</span>(pic,<span class="at">filename =</span> <span class="st">&quot;result/Figure1/S2H_enrichment.pdf&quot;</span>,<span class="at">width=</span><span class="dv">13</span>,<span class="at">height=</span><span class="dv">9</span>)</span></code></pre></div>
<p><img src="Figure-1025/Figure1/S2H.png" width="552" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cell-rsd.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="figure-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/15-Figure1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
